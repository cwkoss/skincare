/*! For license information please see main.0e51d682.js.LICENSE.txt */
(()=>{"use strict";var e={730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new g(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new g(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new g(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new g(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new g(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new g(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function _(e,t,n,r){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);m[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),A=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var F,M=Object.assign;function j(e){if(void 0===F)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var U=!1;function q(e,t){if(!e||U)return"";U=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{U=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function V(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 1:return e=q(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case k:return"Portal";case C:return"Profiler";case E:return"StrictMode";case R:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:z(e.type)||"Memo";case A:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function B(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e,t){var n=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function X(e,t){J(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&K(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function se(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function ge(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=ge(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Se=null,Ee=null;function Ce(e){if(e=_i(e)){if("function"!==typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=wi(t),ke(e.stateNode,e.type,t))}}function Te(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function Ie(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function xe(e,t){return e(t)}function Re(){}var Ne=!1;function Pe(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return xe(e,t,n)}finally{Ne=!1,(null!==Se||null!==Ee)&&(Re(),Ie())}}function Ae(e,t){var n=e.stateNode;if(null===n)return null;var r=wi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Oe=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Oe=!1}function Le(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Fe=!1,Me=null,je=!1,Ue=null,qe={onError:function(e){Fe=!0,Me=e}};function Ve(e,t,n,r,i,s,o,a,l){Fe=!1,Me=null,Le.apply(qe,arguments)}function ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Be(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(ze(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=ze(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return He(i),e;if(o===r)return He(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var $e=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,Je=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,St,Et,Ct,Tt=!1,It=[],xt=null,Rt=null,Nt=null,Pt=new Map,At=new Map,Ot=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":xt=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":At.delete(t.pointerId)}}function Ft(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Mt(e){var t=yi(e.target);if(null!==t){var n=ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Be(n)))return e.blockedOn=t,void Ct(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=_i(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ut(e,t,n){jt(e)&&n.delete(t)}function qt(){Tt=!1,null!==xt&&jt(xt)&&(xt=null),null!==Rt&&jt(Rt)&&(Rt=null),null!==Nt&&jt(Nt)&&(Nt=null),Pt.forEach(Ut),At.forEach(Ut)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,qt)))}function zt(e){function t(t){return Vt(t,e)}if(0<It.length){Vt(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==xt&&Vt(xt,e),null!==Rt&&Vt(Rt,e),null!==Nt&&Vt(Nt,e),Pt.forEach(t),At.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Mt(n),null===n.blockedOn&&Ot.shift()}var Bt=b.ReactCurrentBatchConfig,Ht=!0;function Wt(e,t,n,r){var i=_t,s=Bt.transition;Bt.transition=null;try{_t=1,$t(e,t,n,r)}finally{_t=i,Bt.transition=s}}function Gt(e,t,n,r){var i=_t,s=Bt.transition;Bt.transition=null;try{_t=4,$t(e,t,n,r)}finally{_t=i,Bt.transition=s}}function $t(e,t,n,r){if(Ht){var i=Qt(e,t,n,r);if(null===i)Hr(e,t,r,Kt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return xt=Ft(xt,e,t,n,r,i),!0;case"dragenter":return Rt=Ft(Rt,e,t,n,r,i),!0;case"mouseover":return Nt=Ft(Nt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Pt.set(s,Ft(Pt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,At.set(s,Ft(At.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var s=_i(i);if(null!==s&&wt(s),null===(s=Qt(e,t,n,r))&&Hr(e,t,r,Kt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Kt=null;function Qt(e,t,n,r){if(Kt=null,null!==(e=yi(e=we(r))))if(null===(t=ze(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Be(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Jt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,i="value"in Jt?Jt.value:Jt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=M({},cn,{view:0,detail:0}),dn=sn(hn),fn=M({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),gn=sn(M({},fn,{dataTransfer:0})),mn=sn(M({},hn,{relatedTarget:0})),vn=sn(M({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=M({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_n=sn(yn),bn=sn(M({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Cn(){return En}var Tn=M({},hn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=sn(Tn),xn=sn(M({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=sn(M({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Nn=sn(M({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=M({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),An=sn(Pn),On=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Ln=null;u&&"documentMode"in document&&(Ln=document.documentMode);var Fn=u&&"TextEvent"in window&&!Ln,Mn=u&&(!Dn||Ln&&8<Ln&&11>=Ln),jn=String.fromCharCode(32),Un=!1;function qn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var zn=!1;var Bn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bn[e.type]:"textarea"===t}function Wn(e,t,n,r){Te(r),0<(t=Gr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,$n=null;function Kn(e){jr(e,0)}function Qn(e){if($(bi(e)))return e}function Yn(e,t){if("change"===e)return t}var Jn=!1;if(u){var Xn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Jn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),$n=Gn=null)}function nr(e){if("value"===e.propertyName&&Qn($n)){var t=[];Wn(t,$n,e,we(e)),Pe(Kn,t)}}function rr(e,t,n){"focusin"===e?(tr(),$n=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn($n)}function sr(e,t){if("click"===e)return Qn(t)}function or(e,t){if("input"===e||"change"===e)return Qn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=K((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var gr=u&&"documentMode"in document&&11>=document.documentMode,mr=null,vr=null,yr=null,_r=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==mr||mr!==K(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&lr(yr,r)||(yr=r,0<(r=Gr(vr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Er={};function Cr(e){if(Sr[e])return Sr[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Sr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Tr=Cr("animationend"),Ir=Cr("animationiteration"),xr=Cr("animationstart"),Rr=Cr("transitionend"),Nr=new Map,Pr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ar(e,t){Nr.set(e,t),l(t,[e])}for(var Or=0;Or<Pr.length;Or++){var Dr=Pr[Or];Ar(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Ar(Tr,"onAnimationEnd"),Ar(Ir,"onAnimationIteration"),Ar(xr,"onAnimationStart"),Ar("dblclick","onDoubleClick"),Ar("focusin","onFocus"),Ar("focusout","onBlur"),Ar(Rr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Mr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(Ve.apply(this,arguments),Fe){if(!Fe)throw Error(s(198));var u=Me;Fe=!1,Me=null,je||(je=!0,Ue=u)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Mr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Mr(i,a,c),s=l}}}if(je)throw e=Ue,je=!1,Ue=null,e}function Ur(e,t){var n=t[gi];void 0===n&&(n=t[gi]=new Set);var r=e+"__bubble";n.has(r)||(Br(t,e,2,!1),n.add(r))}function qr(e,t,n){var r=0;t&&(r|=4),Br(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function zr(e){if(!e[Vr]){e[Vr]=!0,o.forEach((function(t){"selectionchange"!==t&&(Fr.has(t)||qr(t,!1,e),qr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,qr("selectionchange",!1,t))}}function Br(e,t,n,r){switch(Yt(t)){case 1:var i=Wt;break;case 4:i=Gt;break;default:i=$t}n=i.bind(null,t,n,e),i=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=yi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Pe((function(){var r=s,i=we(n),o=[];e:{var a=Nr.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Rn;break;case Tr:case Ir:case xr:l=vn;break;case Rr:l=Nn;break;case"scroll":l=dn;break;case"wheel":l=An;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=xn}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var g=(f=p).stateNode;if(5===f.tag&&null!==g&&(f=g,null!==d&&(null!=(g=Ae(p,d))&&u.push(Wr(p,g,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!yi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?yi(c):null)&&(c!==(h=ze(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,g="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=xn,g="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:bi(l),f=null==c?a:bi(c),(a=new u(g,p+"leave",l,n,i)).target=h,a.relatedTarget=f,g=null,yi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,g=u),h=g,l&&c)e:{for(d=c,p=0,f=u=l;f;f=$r(f))p++;for(f=0,g=d;g;g=$r(g))f++;for(;0<p-f;)u=$r(u),p--;for(;0<f-p;)d=$r(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=$r(u),d=$r(d)}u=null}else u=null;null!==l&&Kr(o,a,l,u,!1),null!==c&&null!==h&&Kr(o,h,c,u,!0)}if("select"===(l=(a=r?bi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Yn;else if(Hn(a))if(Jn)m=or;else{m=ir;var v=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=sr);switch(m&&(m=m(e,r))?Wn(o,m,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?bi(r):window,e){case"focusin":(Hn(v)||"true"===v.contentEditable)&&(mr=v,vr=r,yr=null);break;case"focusout":yr=vr=mr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,br(o,n,i);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":br(o,n,i)}var y;if(Dn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else zn?qn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Mn&&"ko"!==n.locale&&(zn||"onCompositionStart"!==_?"onCompositionEnd"===_&&zn&&(y=en()):(Xt="value"in(Jt=i)?Jt.value:Jt.textContent,zn=!0)),0<(v=Gr(r,_)).length&&(_=new bn(_,e,null,n,i),o.push({event:_,listeners:v}),y?_.data=y:null!==(y=Vn(n))&&(_.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Un=!0,jn);case"textInput":return(e=t.data)===jn&&Un?null:e;default:return null}}(e,n):function(e,t){if(zn)return"compositionend"===e||!Dn&&qn(e,t)?(e=en(),Zt=Xt=Jt=null,zn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}jr(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Ae(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=Ae(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function $r(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Ae(n,s))&&o.unshift(Wr(n,l,a)):i||null!=(l=Ae(n,s))&&o.push(Wr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Qr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function Jr(e){return("string"===typeof e?e:""+e).replace(Qr,"\n").replace(Yr,"")}function Xr(e,t,n){if(t=Jr(t),Jr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void zt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);zt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,gi="__reactEvents$"+hi,mi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function yi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function _i(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wi(e){return e[fi]||null}var ki=[],Si=-1;function Ei(e){return{current:e}}function Ci(e){0>Si||(e.current=ki[Si],ki[Si]=null,Si--)}function Ti(e,t){Si++,ki[Si]=e.current,e.current=t}var Ii={},xi=Ei(Ii),Ri=Ei(!1),Ni=Ii;function Pi(e,t){var n=e.type.contextTypes;if(!n)return Ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ai(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oi(){Ci(Ri),Ci(xi)}function Di(e,t,n){if(xi.current!==Ii)throw Error(s(168));Ti(xi,t),Ti(Ri,n)}function Li(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,B(e)||"Unknown",i));return M({},n,r)}function Fi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Ni=xi.current,Ti(xi,e),Ti(Ri,Ri.current),!0}function Mi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Li(e,t,Ni),r.__reactInternalMemoizedMergedChildContext=e,Ci(Ri),Ci(xi),Ti(xi,e)):Ci(Ri),Ti(Ri,n)}var ji=null,Ui=!1,qi=!1;function Vi(e){null===ji?ji=[e]:ji.push(e)}function zi(){if(!qi&&null!==ji){qi=!0;var e=0,t=_t;try{var n=ji;for(_t=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ji=null,Ui=!1}catch(i){throw null!==ji&&(ji=ji.slice(e+1)),$e(Ze,zi),i}finally{_t=t,qi=!1}}return null}var Bi=[],Hi=0,Wi=null,Gi=0,$i=[],Ki=0,Qi=null,Yi=1,Ji="";function Xi(e,t){Bi[Hi++]=Gi,Bi[Hi++]=Wi,Wi=e,Gi=t}function Zi(e,t,n){$i[Ki++]=Yi,$i[Ki++]=Ji,$i[Ki++]=Qi,Qi=e;var r=Yi;e=Ji;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Yi=1<<32-ot(t)+i|n<<i|r,Ji=s+e}else Yi=1<<s|n<<i|r,Ji=e}function es(e){null!==e.return&&(Xi(e,1),Zi(e,1,0))}function ts(e){for(;e===Wi;)Wi=Bi[--Hi],Bi[Hi]=null,Gi=Bi[--Hi],Bi[Hi]=null;for(;e===Qi;)Qi=$i[--Ki],$i[Ki]=null,Ji=$i[--Ki],$i[Ki]=null,Yi=$i[--Ki],$i[Ki]=null}var ns=null,rs=null,is=!1,ss=null;function os(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function as(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Qi?{id:Yi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!as(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&as(e,t)?os(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function hs(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw ds(),Error(s(418));for(;t;)os(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function ds(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var gs=b.ReactCurrentBatchConfig;function ms(e,t){if(e&&e.defaultProps){for(var n in t=M({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var vs=Ei(null),ys=null,_s=null,bs=null;function ws(){bs=_s=ys=null}function ks(e){var t=vs.current;Ci(vs),e._currentValue=t}function Ss(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Es(e,t){ys=e,bs=_s=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ba=!0),e.firstContext=null)}function Cs(e){var t=e._currentValue;if(bs!==e)if(e={context:e,memoizedValue:t,next:null},null===_s){if(null===ys)throw Error(s(308));_s=e,ys.dependencies={lanes:0,firstContext:e}}else _s=_s.next=e;return t}var Ts=null;function Is(e){null===Ts?Ts=[e]:Ts.push(e)}function xs(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Is(t)):(n.next=i.next,i.next=n),t.interleaved=n,Rs(e,r)}function Rs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ns=!1;function Ps(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function As(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ds(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Rl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Rs(e,n)}return null===(i=r.interleaved)?(t.next=t,Is(r)):(t.next=i.next,i.next=t),r.interleaved=t,Rs(e,n)}function Ls(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Fs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ms(e,t,n,r){var i=e.updateQueue;Ns=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,g=a;switch(d=t,f=n,g.tag){case 1:if("function"===typeof(p=g.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=g.payload)?p.call(f,h,d):p)||void 0===d)break e;h=M({},h,d);break e;case 2:Ns=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ml|=o,e.lanes=o,e.memoizedState=h}}function js(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Us=(new r.Component).refs;function qs(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:M({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Vs={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Os(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ds(e,s,i))&&(rc(t,e,i,r),Ls(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tc(),i=nc(e),s=Os(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Ds(e,s,i))&&(rc(t,e,i,r),Ls(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tc(),r=nc(e),i=Os(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Ds(e,i,r))&&(rc(t,e,r,n),Ls(t,e,r))}};function zs(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function Bs(e,t,n){var r=!1,i=Ii,s=t.contextType;return"object"===typeof s&&null!==s?s=Cs(s):(i=Ai(t)?Ni:xi.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Pi(e,i):Ii),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Vs,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Hs(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Vs.enqueueReplaceState(t,t.state,null)}function Ws(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=Us,Ps(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Cs(s):(s=Ai(t)?Ni:xi.current,i.context=Pi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(qs(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&Vs.enqueueReplaceState(i,i.state,null),Ms(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;t===Us&&(t=i.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function $s(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Ks(e){return(0,e._init)(e._payload)}function Qs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Dc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=jc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===A&&Ks(s)===t.type)?((r=i(t,n.props)).ref=Gs(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=Gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=jc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=Gs(e,null,t),n.return=e,n;case k:return(t=Uc(t,e.mode,n)).return=e,t;case A:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Fc(t,e.mode,n,null)).return=e,t;$s(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?c(e,t,n,r):null;case k:return n.key===i?u(e,t,n,r):null;case A:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);$s(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case A:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);$s(t,r)}return null}function g(i,s,a,l){for(var c=null,u=null,h=s,g=s=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var v=f(i,h,a[g],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(i,h),s=o(v,s,g),null===u?c=v:u.sibling=v,u=v,h=m}if(g===a.length)return n(i,h),is&&Xi(i,g),c;if(null===h){for(;g<a.length;g++)null!==(h=d(i,a[g],l))&&(s=o(h,s,g),null===u?c=h:u.sibling=h,u=h);return is&&Xi(i,g),c}for(h=r(i,h);g<a.length;g++)null!==(m=p(h,i,g,a[g],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?g:m.key),s=o(m,s,g),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(i,e)})),is&&Xi(i,g),c}function m(i,a,l,c){var u=L(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,g=a,m=a=0,v=null,y=l.next();null!==g&&!y.done;m++,y=l.next()){g.index>m?(v=g,g=null):v=g.sibling;var _=f(i,g,y.value,c);if(null===_){null===g&&(g=v);break}e&&g&&null===_.alternate&&t(i,g),a=o(_,a,m),null===h?u=_:h.sibling=_,h=_,g=v}if(y.done)return n(i,g),is&&Xi(i,m),u;if(null===g){for(;!y.done;m++,y=l.next())null!==(y=d(i,y.value,c))&&(a=o(y,a,m),null===h?u=y:h.sibling=y,h=y);return is&&Xi(i,m),u}for(g=r(i,g);!y.done;m++,y=l.next())null!==(y=p(g,i,m,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?m:y.key),a=o(y,a,m),null===h?u=y:h.sibling=y,h=y);return e&&g.forEach((function(e){return t(i,e)})),is&&Xi(i,m),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===S){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===A&&Ks(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=Gs(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===S?((s=Fc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Lc(o.type,o.key,o.props,null,r.mode,l)).ref=Gs(r,s,o),l.return=r,r=l)}return a(r);case k:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Uc(o,r.mode,l)).return=r,r=s}return a(r);case A:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return g(r,s,o,l);if(L(o))return m(r,s,o,l);$s(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=jc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var Ys=Qs(!0),Js=Qs(!1),Xs={},Zs=Ei(Xs),eo=Ei(Xs),to=Ei(Xs);function no(e){if(e===Xs)throw Error(s(174));return e}function ro(e,t){switch(Ti(to,t),Ti(eo,e),Ti(Zs,Xs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(Zs),Ti(Zs,t)}function io(){Ci(Zs),Ci(eo),Ci(to)}function so(e){no(to.current);var t=no(Zs.current),n=le(t,e.type);t!==n&&(Ti(eo,e),Ti(Zs,n))}function oo(e){eo.current===e&&(Ci(Zs),Ci(eo))}var ao=Ei(0);function lo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function uo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var ho=b.ReactCurrentDispatcher,fo=b.ReactCurrentBatchConfig,po=0,go=null,mo=null,vo=null,yo=!1,_o=!1,bo=0,wo=0;function ko(){throw Error(s(321))}function So(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function Eo(e,t,n,r,i,o){if(po=o,go=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ho.current=null===e||null===e.memoizedState?aa:la,e=n(r,i),_o){o=0;do{if(_o=!1,bo=0,25<=o)throw Error(s(301));o+=1,vo=mo=null,t.updateQueue=null,ho.current=ca,e=n(r,i)}while(_o)}if(ho.current=oa,t=null!==mo&&null!==mo.next,po=0,vo=mo=go=null,yo=!1,t)throw Error(s(300));return e}function Co(){var e=0!==bo;return bo=0,e}function To(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===vo?go.memoizedState=vo=e:vo=vo.next=e,vo}function Io(){if(null===mo){var e=go.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===vo?go.memoizedState:vo.next;if(null!==t)vo=t,mo=e;else{if(null===e)throw Error(s(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===vo?go.memoizedState=vo=e:vo=vo.next=e}return vo}function xo(e,t){return"function"===typeof t?t(e):t}function Ro(e){var t=Io(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=mo,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((po&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,go.lanes|=h,Ml|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(ba=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,go.lanes|=o,Ml|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function No(e){var t=Io(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(ba=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Po(){}function Ao(e,t){var n=go,r=Io(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,ba=!0),r=r.queue,Ho(Lo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==vo&&1&vo.memoizedState.tag){if(n.flags|=2048,Uo(9,Do.bind(null,n,r,i,t),void 0,null),null===Nl)throw Error(s(349));0!==(30&po)||Oo(n,t,i)}return i}function Oo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=go.updateQueue)?(t={lastEffect:null,stores:null},go.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Do(e,t,n,r){t.value=n,t.getSnapshot=r,Fo(t)&&Mo(e)}function Lo(e,t,n){return n((function(){Fo(t)&&Mo(e)}))}function Fo(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Mo(e){var t=Rs(e,1);null!==t&&rc(t,e,1,-1)}function jo(e){var t=To();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xo,lastRenderedState:e},t.queue=e,e=e.dispatch=na.bind(null,go,e),[t.memoizedState,e]}function Uo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=go.updateQueue)?(t={lastEffect:null,stores:null},go.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function qo(){return Io().memoizedState}function Vo(e,t,n,r){var i=To();go.flags|=e,i.memoizedState=Uo(1|t,n,void 0,void 0===r?null:r)}function zo(e,t,n,r){var i=Io();r=void 0===r?null:r;var s=void 0;if(null!==mo){var o=mo.memoizedState;if(s=o.destroy,null!==r&&So(r,o.deps))return void(i.memoizedState=Uo(t,n,s,r))}go.flags|=e,i.memoizedState=Uo(1|t,n,s,r)}function Bo(e,t){return Vo(8390656,8,e,t)}function Ho(e,t){return zo(2048,8,e,t)}function Wo(e,t){return zo(4,2,e,t)}function Go(e,t){return zo(4,4,e,t)}function $o(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ko(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,zo(4,4,$o.bind(null,t,e),n)}function Qo(){}function Yo(e,t){var n=Io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&So(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Jo(e,t){var n=Io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&So(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,ba=!0),e.memoizedState=n):(ar(n,t)||(n=gt(),go.lanes|=n,Ml|=n,e.baseState=!0),t)}function Zo(e,t){var n=_t;_t=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{_t=n,fo.transition=r}}function ea(){return Io().memoizedState}function ta(e,t,n){var r=nc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ra(e))ia(t,n);else if(null!==(n=xs(e,t,n,r))){rc(n,e,r,tc()),sa(n,t,r)}}function na(e,t,n){var r=nc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ra(e))ia(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,Is(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=xs(e,t,i,r))&&(rc(n,e,r,i=tc()),sa(n,t,r))}}function ra(e){var t=e.alternate;return e===go||null!==t&&t===go}function ia(e,t){_o=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function sa(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var oa={readContext:Cs,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},aa={readContext:Cs,useCallback:function(e,t){return To().memoizedState=[e,void 0===t?null:t],e},useContext:Cs,useEffect:Bo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4194308,4,$o.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Vo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Vo(4,2,e,t)},useMemo:function(e,t){var n=To();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=To();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ta.bind(null,go,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},To().memoizedState=e},useState:jo,useDebugValue:Qo,useDeferredValue:function(e){return To().memoizedState=e},useTransition:function(){var e=jo(!1),t=e[0];return e=Zo.bind(null,e[1]),To().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=go,i=To();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Nl)throw Error(s(349));0!==(30&po)||Oo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Bo(Lo.bind(null,r,o,e),[e]),r.flags|=2048,Uo(9,Do.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=To(),t=Nl.identifierPrefix;if(is){var n=Ji;t=":"+t+"R"+(n=(Yi&~(1<<32-ot(Yi)-1)).toString(32)+n),0<(n=bo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},la={readContext:Cs,useCallback:Yo,useContext:Cs,useEffect:Ho,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Go,useMemo:Jo,useReducer:Ro,useRef:qo,useState:function(){return Ro(xo)},useDebugValue:Qo,useDeferredValue:function(e){return Xo(Io(),mo.memoizedState,e)},useTransition:function(){return[Ro(xo)[0],Io().memoizedState]},useMutableSource:Po,useSyncExternalStore:Ao,useId:ea,unstable_isNewReconciler:!1},ca={readContext:Cs,useCallback:Yo,useContext:Cs,useEffect:Ho,useImperativeHandle:Ko,useInsertionEffect:Wo,useLayoutEffect:Go,useMemo:Jo,useReducer:No,useRef:qo,useState:function(){return No(xo)},useDebugValue:Qo,useDeferredValue:function(e){var t=Io();return null===mo?t.memoizedState=e:Xo(t,mo.memoizedState,e)},useTransition:function(){return[No(xo)[0],Io().memoizedState]},useMutableSource:Po,useSyncExternalStore:Ao,useId:ea,unstable_isNewReconciler:!1};function ua(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function ha(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function da(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fa="function"===typeof WeakMap?WeakMap:Map;function pa(e,t,n){(n=Os(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Gl=r),da(0,t)},n}function ga(e,t,n){(n=Os(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){da(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){da(0,t),"function"!==typeof r&&(null===$l?$l=new Set([this]):$l.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ma(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=Tc.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ya(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Os(-1,1)).tag=2,Ds(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var _a=b.ReactCurrentOwner,ba=!1;function wa(e,t,n,r){t.child=null===e?Js(t,null,n,r):Ys(t,e.child,n,r)}function ka(e,t,n,r,i){n=n.render;var s=t.ref;return Es(t,i),r=Eo(e,t,n,r,s,i),n=Co(),null===e||ba?(is&&n&&es(t),t.flags|=1,wa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function Sa(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Oc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ea(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Wa(e,t,i)}return t.flags|=1,(e=Dc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ea(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(ba=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Wa(e,t,i);0!==(131072&e.flags)&&(ba=!0)}}return Ia(e,t,n,r,i)}function Ca(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Dl,Ol),Ol|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Dl,Ol),Ol|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ti(Dl,Ol),Ol|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ti(Dl,Ol),Ol|=r;return wa(e,t,i,n),t.child}function Ta(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ia(e,t,n,r,i){var s=Ai(n)?Ni:xi.current;return s=Pi(t,s),Es(t,i),n=Eo(e,t,n,r,s,i),r=Co(),null===e||ba?(is&&r&&es(t),t.flags|=1,wa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function xa(e,t,n,r,i){if(Ai(n)){var s=!0;Fi(t)}else s=!1;if(Es(t,i),null===t.stateNode)Ha(e,t),Bs(t,n,r),Ws(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Cs(c):c=Pi(t,c=Ai(n)?Ni:xi.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&Hs(t,o,r,c),Ns=!1;var d=t.memoizedState;o.state=d,Ms(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ri.current||Ns?("function"===typeof u&&(qs(t,n,u,r),l=t.memoizedState),(a=Ns||zs(t,n,a,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,As(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ms(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Cs(l):l=Pi(t,l=Ai(n)?Ni:xi.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&Hs(t,o,r,l),Ns=!1,d=t.memoizedState,o.state=d,Ms(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Ri.current||Ns?("function"===typeof f&&(qs(t,n,f,r),p=t.memoizedState),(c=Ns||zs(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Ra(e,t,n,r,s,i)}function Ra(e,t,n,r,i,s){Ta(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Mi(t,n,!1),Wa(e,t,s);r=t.stateNode,_a.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ys(t,e.child,null,s),t.child=Ys(t,null,a,s)):wa(e,t,a,s),t.memoizedState=r.state,i&&Mi(t,n,!0),t.child}function Na(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),ro(e,t.containerInfo)}function Pa(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wa(e,t,n,r),t.child}var Aa,Oa,Da,La,Fa={dehydrated:null,treeContext:null,retryLane:0};function Ma(e){return{baseLanes:e,cachePool:null,transitions:null}}function ja(e,t,n){var r,i=t.pendingProps,o=ao.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ti(ao,1&o),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Mc(l,i,0,null),e=Fc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ma(n),t.memoizedState=Fa,e):Ua(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,qa(e,t,a,r=ha(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(o=Fc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ys(t,e.child,null,a),t.child.memoizedState=Ma(a),t.memoizedState=Fa,o);if(0===(1&t.mode))return qa(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,qa(e,t,a,r=ha(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),ba||l){if(null!==(r=Nl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Rs(e,i),rc(r,e,i,-1))}return mc(),qa(e,t,a,r=ha(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=xc.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&($i[Ki++]=Yi,$i[Ki++]=Ji,$i[Ki++]=Qi,Yi=e.id,Ji=e.overflow,Qi=t),t=Ua(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Dc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Dc(r,a):(a=Fc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?Ma(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,i}return e=(a=e.child).sibling,i=Dc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Ua(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function qa(e,t,n,r){return null!==r&&ps(r),Ys(t,e.child,null,n),(e=Ua(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Va(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ss(e.return,t,n)}function za(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ba(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wa(e,t,r.children,n),0!==(2&(r=ao.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Va(e,n,t);else if(19===e.tag)Va(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(ao,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===lo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),za(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===lo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}za(t,!0,n,null,s);break;case"together":za(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ha(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Dc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Dc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ga(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function $a(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ka(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $a(t),null;case 1:case 17:return Ai(t.type)&&Oi(),$a(t),null;case 3:return r=t.stateNode,io(),Ci(Ri),Ci(xi),uo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(hs(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Oa(e,t),$a(t),null;case 5:oo(t);var i=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Da(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return $a(t),null}if(e=no(Zs.current),hs(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Ur("cancel",r),Ur("close",r);break;case"iframe":case"object":case"embed":Ur("load",r);break;case"video":case"audio":for(i=0;i<Lr.length;i++)Ur(Lr[i],r);break;case"source":Ur("error",r);break;case"img":case"image":case"link":Ur("error",r),Ur("load",r);break;case"details":Ur("toggle",r);break;case"input":Y(r,o),Ur("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ur("invalid",r);break;case"textarea":ie(r,o),Ur("invalid",r)}for(var l in ye(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Ur("scroll",r)}switch(n){case"input":G(r),Z(r,o,!0);break;case"textarea":G(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Aa(e,t,!1,!1),t.stateNode=e;e:{switch(l=_e(n,r),n){case"dialog":Ur("cancel",e),Ur("close",e),i=r;break;case"iframe":case"object":case"embed":Ur("load",e),i=r;break;case"video":case"audio":for(i=0;i<Lr.length;i++)Ur(Lr[i],e);i=r;break;case"source":Ur("error",e),i=r;break;case"img":case"image":case"link":Ur("error",e),Ur("load",e),i=r;break;case"details":Ur("toggle",e),i=r;break;case"input":Y(e,r),i=Q(e,r),Ur("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=M({},r,{value:void 0}),Ur("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Ur("invalid",e)}for(o in ye(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?me(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Ur("scroll",e):null!=u&&_(e,o,u,l))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return $a(t),null;case 6:if(e&&null!=t.stateNode)La(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=no(to.current),no(Zs.current),hs(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return $a(t),null;case 13:if(Ci(ao),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))ds(),fs(),t.flags|=98560,o=!1;else if(o=hs(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;$a(t),o=!1}else null!==ss&&(ac(ss),ss=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ao.current)?0===Ll&&(Ll=3):mc())),null!==t.updateQueue&&(t.flags|=4),$a(t),null);case 4:return io(),Oa(e,t),null===e&&zr(t.stateNode.containerInfo),$a(t),null;case 10:return ks(t.type._context),$a(t),null;case 19:if(Ci(ao),null===(o=t.memoizedState))return $a(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ga(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=lo(e))){for(t.flags|=128,Ga(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(ao,1&ao.current|2),t.child}e=e.sibling}null!==o.tail&&Je()>Bl&&(t.flags|=128,r=!0,Ga(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=lo(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ga(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!is)return $a(t),null}else 2*Je()-o.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Ga(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Je(),t.sibling=null,n=ao.current,Ti(ao,r?1&n|2:1&n),t):($a(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ol)&&($a(t),6&t.subtreeFlags&&(t.flags|=8192)):$a(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qa(e,t){switch(ts(t),t.tag){case 1:return Ai(t.type)&&Oi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return io(),Ci(Ri),Ci(xi),uo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ci(ao),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(ao),null;case 4:return io(),null;case 10:return ks(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}Aa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Oa=function(){},Da=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,no(Zs.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=M({},i,{value:void 0}),r=M({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ye(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Ur("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,r){n!==r&&(t.flags|=4)};var Ya=!1,Ja=!1,Xa="function"===typeof WeakSet?WeakSet:Set,Za=null;function el(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cc(e,t,r)}else n.current=null}function tl(e,t,n){try{n()}catch(r){Cc(e,t,r)}}var nl=!1;function rl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&tl(t,n,s)}i=i.next}while(i!==r)}}function il(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[gi],delete t[mi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ll(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}var hl=null,dl=!1;function fl(e,t,n){for(n=n.child;null!==n;)pl(e,t,n),n=n.sibling}function pl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ja||el(n,t);case 6:var r=hl,i=dl;hl=null,fl(e,t,n),dl=i,null!==(hl=r)&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(dl?(e=hl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),zt(e)):li(hl,n.stateNode));break;case 4:r=hl,i=dl,hl=n.stateNode.containerInfo,dl=!0,fl(e,t,n),hl=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Ja&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&tl(n,t,o),i=i.next}while(i!==r)}fl(e,t,n);break;case 1:if(!Ja&&(el(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Cc(n,t,a)}fl(e,t,n);break;case 21:fl(e,t,n);break;case 22:1&n.mode?(Ja=(r=Ja)||null!==n.memoizedState,fl(e,t,n),Ja=r):fl(e,t,n);break;default:fl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xa),t.forEach((function(t){var r=Rc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,dl=!1;break e;case 3:case 4:hl=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===hl)throw Error(s(160));pl(o,a,i),hl=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Cc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{rl(3,e,e.return),il(3,e)}catch(m){Cc(e,e.return,m)}try{rl(5,e,e.return)}catch(m){Cc(e,e.return,m)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&el(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&el(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(m){Cc(e,e.return,m)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&J(i,o),_e(l,a);var u=_e(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?me(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):_(i,h,d,u)}switch(l){case"input":X(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(m){Cc(e,e.return,m)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(m){Cc(e,e.return,m)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{zt(t.containerInfo)}catch(m){Cc(e,e.return,m)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||(zl=Je())),4&r&&gl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ja=(u=Ja)||h,ml(t,e),Ja=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Za=e,h=e.child;null!==h;){for(d=Za=h;null!==Za;){switch(p=(f=Za).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:el(f,f.return);var g=f.stateNode;if("function"===typeof g.componentWillUnmount){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Cc(r,n,m)}}break;case 5:el(f,f.return);break;case 22:if(null!==f.memoizedState){kl(d);continue}}null!==p?(p.return=f,Za=p):kl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",a))}catch(m){Cc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Cc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ml(t,e),yl(e),4&r&&gl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),ul(e,ll(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;cl(e,ll(e),o);break;default:throw Error(s(161))}}catch(a){Cc(e,e.return,a)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){Za=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Za;){var i=Za,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Ya;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ja;a=Ya;var c=Ja;if(Ya=o,(Ja=l)&&!c)for(Za=i;null!==Za;)l=(o=Za).child,22===o.tag&&null!==o.memoizedState?Sl(i):null!==l?(l.return=o,Za=l):Sl(i);for(;null!==s;)Za=s,bl(s,t,n),s=s.sibling;Za=i,Ya=a,Ja=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Za=s):wl(e)}}function wl(e){for(;null!==Za;){var t=Za;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ja||il(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ja)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ms(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&js(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}js(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&zt(d)}}}break;default:throw Error(s(163))}Ja||512&t.flags&&sl(t)}catch(f){Cc(t,t.return,f)}}if(t===e){Za=null;break}if(null!==(n=t.sibling)){n.return=t.return,Za=n;break}Za=t.return}}function kl(e){for(;null!==Za;){var t=Za;if(t===e){Za=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Za=n;break}Za=t.return}}function Sl(e){for(;null!==Za;){var t=Za;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{il(4,t)}catch(l){Cc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Cc(t,i,l)}}var s=t.return;try{sl(t)}catch(l){Cc(t,s,l)}break;case 5:var o=t.return;try{sl(t)}catch(l){Cc(t,o,l)}}}catch(l){Cc(t,t.return,l)}if(t===e){Za=null;break}var a=t.sibling;if(null!==a){a.return=t.return,Za=a;break}Za=t.return}}var El,Cl=Math.ceil,Tl=b.ReactCurrentDispatcher,Il=b.ReactCurrentOwner,xl=b.ReactCurrentBatchConfig,Rl=0,Nl=null,Pl=null,Al=0,Ol=0,Dl=Ei(0),Ll=0,Fl=null,Ml=0,jl=0,Ul=0,ql=null,Vl=null,zl=0,Bl=1/0,Hl=null,Wl=!1,Gl=null,$l=null,Kl=!1,Ql=null,Yl=0,Jl=0,Xl=null,Zl=-1,ec=0;function tc(){return 0!==(6&Rl)?Je():-1!==Zl?Zl:Zl=Je()}function nc(e){return 0===(1&e.mode)?1:0!==(2&Rl)&&0!==Al?Al&-Al:null!==gs.transition?(0===ec&&(ec=gt()),ec):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function rc(e,t,n,r){if(50<Jl)throw Jl=0,Xl=null,Error(s(185));vt(e,n,r),0!==(2&Rl)&&e===Nl||(e===Nl&&(0===(2&Rl)&&(jl|=n),4===Ll&&lc(e,Al)),ic(e,r),1===n&&0===Rl&&0===(1&t.mode)&&(Bl=Je()+500,Ui&&zi()))}function ic(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Nl?Al:0);if(0===r)null!==n&&Ke(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ke(n),1===t)0===e.tag?function(e){Ui=!0,Vi(e)}(cc.bind(null,e)):Vi(cc.bind(null,e)),oi((function(){0===(6&Rl)&&zi()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Nc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Zl=-1,ec=0,0!==(6&Rl))throw Error(s(327));var n=e.callbackNode;if(Sc()&&e.callbackNode!==n)return null;var r=dt(e,e===Nl?Al:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=Rl;Rl|=2;var o=gc();for(Nl===e&&Al===t||(Hl=null,Bl=Je()+500,fc(e,t));;)try{_c();break}catch(l){pc(e,l)}ws(),Tl.current=o,Rl=i,null!==Pl?t=0:(Nl=null,Al=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=oc(e,i))),1===t)throw n=Fl,fc(e,0),lc(e,r),ic(e,Je()),n;if(6===t)lc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(o=pt(e))&&(r=o,t=oc(e,o))),1===t))throw n=Fl,fc(e,0),lc(e,r),ic(e,Je()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:kc(e,Vl,Hl);break;case 3:if(lc(e,r),(130023424&r)===r&&10<(t=zl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(kc.bind(null,e,Vl,Hl),t);break}kc(e,Vl,Hl);break;case 4:if(lc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Je()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=ri(kc.bind(null,e,Vl,Hl),r);break}kc(e,Vl,Hl);break;default:throw Error(s(329))}}}return ic(e,Je()),e.callbackNode===n?sc.bind(null,e):null}function oc(e,t){var n=ql;return e.current.memoizedState.isDehydrated&&(fc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Vl,Vl=n,null!==t&&ac(t)),e}function ac(e){null===Vl?Vl=e:Vl.push.apply(Vl,e)}function lc(e,t){for(t&=~Ul,t&=~jl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function cc(e){if(0!==(6&Rl))throw Error(s(327));Sc();var t=dt(e,0);if(0===(1&t))return ic(e,Je()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=oc(e,r))}if(1===n)throw n=Fl,fc(e,0),lc(e,t),ic(e,Je()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e,Vl,Hl),ic(e,Je()),null}function uc(e,t){var n=Rl;Rl|=1;try{return e(t)}finally{0===(Rl=n)&&(Bl=Je()+500,Ui&&zi())}}function hc(e){null!==Ql&&0===Ql.tag&&0===(6&Rl)&&Sc();var t=Rl;Rl|=1;var n=xl.transition,r=_t;try{if(xl.transition=null,_t=1,e)return e()}finally{_t=r,xl.transition=n,0===(6&(Rl=t))&&zi()}}function dc(){Ol=Dl.current,Ci(Dl)}function fc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Pl)for(n=Pl.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oi();break;case 3:io(),Ci(Ri),Ci(xi),uo();break;case 5:oo(r);break;case 4:io();break;case 13:case 19:Ci(ao);break;case 10:ks(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Nl=e,Pl=e=Dc(e.current,null),Al=Ol=t,Ll=0,Fl=null,Ul=jl=Ml=0,Vl=ql=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(r=(n=Ts[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Ts=null}return e}function pc(e,t){for(;;){var n=Pl;try{if(ws(),ho.current=oa,yo){for(var r=go.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}yo=!1}if(po=0,vo=mo=go=null,_o=!1,bo=0,Il.current=null,null===n||null===n.return){Ll=1,Fl=t,Pl=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Al,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=va(a);if(null!==p){p.flags&=-257,ya(p,a,l,0,t),1&p.mode&&ma(o,u,t),c=u;var g=(t=p).updateQueue;if(null===g){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}if(0===(1&t)){ma(o,u,t),mc();break e}c=Error(s(426))}else if(is&&1&l.mode){var v=va(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ya(v,a,l,0,t),ps(ua(c,l));break e}}o=c=ua(c,l),4!==Ll&&(Ll=2),null===ql?ql=[o]:ql.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Fs(o,pa(0,c,t));break e;case 1:l=c;var y=o.type,_=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===$l||!$l.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t,Fs(o,ga(o,l,t));break e}}o=o.return}while(null!==o)}wc(n)}catch(b){t=b,Pl===n&&null!==n&&(Pl=n=n.return);continue}break}}function gc(){var e=Tl.current;return Tl.current=oa,null===e?oa:e}function mc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Nl||0===(268435455&Ml)&&0===(268435455&jl)||lc(Nl,Al)}function vc(e,t){var n=Rl;Rl|=2;var r=gc();for(Nl===e&&Al===t||(Hl=null,fc(e,t));;)try{yc();break}catch(i){pc(e,i)}if(ws(),Rl=n,Tl.current=r,null!==Pl)throw Error(s(261));return Nl=null,Al=0,Ll}function yc(){for(;null!==Pl;)bc(Pl)}function _c(){for(;null!==Pl&&!Qe();)bc(Pl)}function bc(e){var t=El(e.alternate,e,Ol);e.memoizedProps=e.pendingProps,null===t?wc(e):Pl=t,Il.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ka(n,t,Ol)))return void(Pl=n)}else{if(null!==(n=Qa(n,t)))return n.flags&=32767,void(Pl=n);if(null===e)return Ll=6,void(Pl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Pl=t);Pl=t=e}while(null!==t);0===Ll&&(Ll=5)}function kc(e,t,n){var r=_t,i=xl.transition;try{xl.transition=null,_t=1,function(e,t,n,r){do{Sc()}while(null!==Ql);if(0!==(6&Rl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Nl&&(Pl=Nl=null,Al=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Nc(tt,(function(){return Sc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=xl.transition,xl.transition=null;var a=_t;_t=1;var l=Rl;Rl|=4,Il.current=null,function(e,t){if(ei=Ht,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},Ht=!1,Za=t;null!==Za;)if(e=(t=Za).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Za=e;else for(;null!==Za;){t=Za;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,v=g.memoizedState,y=t.stateNode,_=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ms(t.type,m),v);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(w){Cc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Za=e;break}Za=t.return}g=nl,nl=!1}(e,n),vl(n,e),pr(ti),Ht=!!ei,ti=ei=null,e.current=n,_l(n,e,i),Ye(),Rl=l,_t=a,xl.transition=o}else e.current=n;if(Kl&&(Kl=!1,Ql=e,Yl=i),o=e.pendingLanes,0===o&&($l=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ic(e,Je()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Gl,Gl=null,e;0!==(1&Yl)&&0!==e.tag&&Sc(),o=e.pendingLanes,0!==(1&o)?e===Xl?Jl++:(Jl=0,Xl=e):Jl=0,zi()}(e,t,n,r)}finally{xl.transition=i,_t=r}return null}function Sc(){if(null!==Ql){var e=bt(Yl),t=xl.transition,n=_t;try{if(xl.transition=null,_t=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Rl))throw Error(s(331));var i=Rl;for(Rl|=4,Za=e.current;null!==Za;){var o=Za,a=o.child;if(0!==(16&Za.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Za=u;null!==Za;){var h=Za;switch(h.tag){case 0:case 11:case 15:rl(8,h,o)}var d=h.child;if(null!==d)d.return=h,Za=d;else for(;null!==Za;){var f=(h=Za).sibling,p=h.return;if(ol(h),h===u){Za=null;break}if(null!==f){f.return=p,Za=f;break}Za=p}}}var g=o.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Za=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,Za=a;else e:for(;null!==Za;){if(0!==(2048&(o=Za).flags))switch(o.tag){case 0:case 11:case 15:rl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Za=y;break e}Za=o.return}}var _=e.current;for(Za=_;null!==Za;){var b=(a=Za).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,Za=b;else e:for(a=_;null!==Za;){if(0!==(2048&(l=Za).flags))try{switch(l.tag){case 0:case 11:case 15:il(9,l)}}catch(k){Cc(l,l.return,k)}if(l===a){Za=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Za=w;break e}Za=l.return}}if(Rl=i,zi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{_t=n,xl.transition=t}}return!1}function Ec(e,t,n){e=Ds(e,t=pa(0,t=ua(n,t),1),1),t=tc(),null!==e&&(vt(e,1,t),ic(e,t))}function Cc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===$l||!$l.has(r))){t=Ds(t,e=ga(t,e=ua(n,e),1),1),e=tc(),null!==t&&(vt(t,1,e),ic(t,e));break}}t=t.return}}function Tc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&n,Nl===e&&(Al&n)===n&&(4===Ll||3===Ll&&(130023424&Al)===Al&&500>Je()-zl?fc(e,0):Ul|=n),ic(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=tc();null!==(e=Rs(e,t))&&(vt(e,t,n),ic(e,n))}function xc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Rc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Ic(e,n)}function Nc(e,t){return $e(e,t)}function Pc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Pc(e,t,n,r)}function Oc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Oc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return Fc(n.children,i,o,t);case E:a=8,i|=8;break;case C:return(e=Ac(12,n,t,2|i)).elementType=C,e.lanes=o,e;case R:return(e=Ac(13,n,t,i)).elementType=R,e.lanes=o,e;case N:return(e=Ac(19,n,t,i)).elementType=N,e.lanes=o,e;case O:return Mc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case I:a=9;break e;case x:a=11;break e;case P:a=14;break e;case A:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ac(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Fc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function jc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function qc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Vc(e,t,n,r,i,s,o,a,l){return e=new qc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ac(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ps(s),e}function zc(e){if(!e)return Ii;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ai(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Ai(n))return Li(e,n,t)}return t}function Bc(e,t,n,r,i,s,o,a,l){return(e=Vc(n,r,!0,e,0,s,0,a,l)).context=zc(null),n=e.current,(s=Os(r=tc(),i=nc(n))).callback=void 0!==t&&null!==t?t:null,Ds(n,s,i),e.current.lanes=i,vt(e,i,r),ic(e,r),e}function Hc(e,t,n,r){var i=t.current,s=tc(),o=nc(i);return n=zc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Os(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ds(i,t,o))&&(rc(e,i,o,s),Ls(e,i,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function $c(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}El=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ri.current)ba=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return ba=!1,function(e,t,n){switch(t.tag){case 3:Na(t),fs();break;case 5:so(t);break;case 1:Ai(t.type)&&Fi(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(vs,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(ao,1&ao.current),t.flags|=128,null):0!==(n&t.child.childLanes)?ja(e,t,n):(Ti(ao,1&ao.current),null!==(e=Wa(e,t,n))?e.sibling:null);Ti(ao,1&ao.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ba(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(ao,ao.current),r)break;return null;case 22:case 23:return t.lanes=0,Ca(e,t,n)}return Wa(e,t,n)}(e,t,n);ba=0!==(131072&e.flags)}else ba=!1,is&&0!==(1048576&t.flags)&&Zi(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ha(e,t),e=t.pendingProps;var i=Pi(t,xi.current);Es(t,n),i=Eo(null,t,r,e,i,n);var o=Co();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ai(r)?(o=!0,Fi(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ps(t),i.updater=Vs,t.stateNode=i,i._reactInternals=t,Ws(t,r,e,n),t=Ra(null,t,r,!0,o,n)):(t.tag=0,is&&o&&es(t),wa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Oc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===x)return 11;if(e===P)return 14}return 2}(r),e=ms(r,e),i){case 0:t=Ia(null,t,r,e,n);break e;case 1:t=xa(null,t,r,e,n);break e;case 11:t=ka(null,t,r,e,n);break e;case 14:t=Sa(null,t,r,ms(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:ms(r,i),n);case 1:return r=t.type,i=t.pendingProps,xa(e,t,r,i=t.elementType===r?i:ms(r,i),n);case 3:e:{if(Na(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,As(e,t),Ms(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Pa(e,t,r,n,i=ua(Error(s(423)),t));break e}if(r!==i){t=Pa(e,t,r,n,i=ua(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=Js(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=Wa(e,t,n);break e}wa(e,t,r,n)}t=t.child}return t;case 5:return so(t),null===e&&cs(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),Ta(e,t),wa(e,t,a,n),t.child;case 6:return null===e&&cs(t),null;case 13:return ja(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ys(t,null,r,n):wa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,ka(e,t,r,i=t.elementType===r?i:ms(r,i),n);case 7:return wa(e,t,t.pendingProps,n),t.child;case 8:case 12:return wa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ti(vs,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ri.current){t=Wa(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Os(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ss(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ss(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}wa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Es(t,n),r=r(i=Cs(i)),t.flags|=1,wa(e,t,r,n),t.child;case 14:return i=ms(r=t.type,t.pendingProps),Sa(e,t,r,i=ms(r.type,i),n);case 15:return Ea(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ms(r,i),Ha(e,t),t.tag=1,Ai(r)?(e=!0,Fi(t)):e=!1,Es(t,n),Bs(t,r,i),Ws(t,r,i,n),Ra(null,t,r,!0,e,n);case 19:return Ba(e,t,n);case 22:return Ca(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function eu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Wc(o);a.call(e)}}Hc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Wc(o);s.call(e)}}var o=Bc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[pi]=o.current,zr(8===e.nodeType?e.parentNode:e),hc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Wc(l);a.call(e)}}var l=Vc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[pi]=l.current,zr(8===e.nodeType?e.parentNode:e),hc((function(){Hc(t,l,n,r)})),l}(n,t,e,i,r);return Wc(o)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Hc(null,e,null,null)})),t[pi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Mt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ic(t,Je()),0===(6&Rl)&&(Bl=Je()+500,zi()))}break;case 13:hc((function(){var t=Rs(e,1);if(null!==t){var n=tc();rc(t,e,1,n)}})),$c(e,1)}},kt=function(e){if(13===e.tag){var t=Rs(e,134217728);if(null!==t)rc(t,e,134217728,tc());$c(e,134217728)}},St=function(e){if(13===e.tag){var t=nc(e),n=Rs(e,t);if(null!==n)rc(n,e,t,tc());$c(e,t)}},Et=function(){return _t},Ct=function(e,t){var n=_t;try{return _t=e,t()}finally{_t=n}},ke=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=wi(r);if(!i)throw Error(s(90));$(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},xe=uc,Re=hc;var tu={usingClientEntryPoint:!1,Events:[_i,bi,wi,Te,Ie,uc]},nu={findFiberByHostInstance:yi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ru={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{it=iu.inject(ru),st=iu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Jc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Jc(e))throw Error(s(299));var n=!1,r="",i=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Vc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,zr(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,n){if(!Xc(t))throw Error(s(200));return eu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Jc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,zr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Yc(t)},t.render=function(e,t,n){if(!Xc(t))throw Error(s(200));return eu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xc(e))throw Error(s(40));return!!e._reactRootContainer&&(hc((function(){eu(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=uc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return eu(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}function y(){}function _(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=_.prototype=new y;b.constructor=_,g(b,v.prototype),b.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function x(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+x(l,0):s,w(o)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),R(o,t,i,"",(function(e){return e}))):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(I,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var u=s+x(a=e[c],c);l+=R(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=R(a=a.value,t,i,u=s+x(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var r=[],i=0;return R(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A={current:null},O={transition:null},D={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};t.Children={map:N,forEach:function(e,t,n){N(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return N(e,(function(){t++})),t},toArray:function(e){return N(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=_,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=g({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return A.current.useCallback(e,t)},t.useContext=function(e){return A.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return A.current.useDeferredValue(e)},t.useEffect=function(e,t){return A.current.useEffect(e,t)},t.useId=function(){return A.current.useId()},t.useImperativeHandle=function(e,t,n){return A.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return A.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return A.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return A.current.useMemo(e,t)},t.useReducer=function(e,t,n){return A.current.useReducer(e,t,n)},t.useRef=function(e){return A.current.useRef(e)},t.useState=function(e){return A.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return A.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return A.current.useTransition()},t.version="18.2.0"},43:(e,t,n)=>{e.exports=n(202)},579:(e,t,n)=>{e.exports=n(153)},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,g=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function w(e){if(m=!1,b(e),!g)if(null!==r(c))g=!0,O(k);else{var t=r(u);null!==t&&D(w,t.startTime-e)}}function k(e,n){g=!1,m&&(m=!1,y(T),T=-1),p=!0;var s=f;try{for(b(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!R());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&i(c),b(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&D(w,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,C=null,T=-1,I=5,x=-1;function R(){return!(t.unstable_now()-x<I)}function N(){if(null!==C){var e=t.unstable_now();x=e;var n=!0;try{n=C(!0,e)}finally{n?S():(E=!1,C=null)}}else E=!1}if("function"===typeof _)S=function(){_(N)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,A=P.port2;P.port1.onmessage=N,S=function(){A.postMessage(null)}}else S=function(){v(N,0)};function O(e){C=e,E||(E=!0,S())}function D(e,n){T=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||p||(g=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(m?(y(T),T=-1):m=!0,D(w,s-o))):(e.sortIndex=a,n(c,e),g||p||(g=!0,O(k))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{e.exports=n(234)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,i){if(1&i&&(r=this(r)),8&i)return r;if("object"===typeof r&&r){if(4&i&&r.__esModule)return r;if(16&i&&"function"===typeof r.then)return r}var s=Object.create(null);n.r(s);var o={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&r;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>o[e]=()=>r[e]));return o.default=()=>r,n.d(s,o),s}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".03f021ac.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="skincare:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var h=c[u];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="./",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],c=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);c<o.length;c++)s=o[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkskincare=self.webpackChunkskincare||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{var e,t=n(43),r=n.t(t,2),i=n(391),s=n(950),o=n.t(s,2);function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(e||(e={}));const l="popstate";function c(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function u(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(AE){}}}function h(e,t){return{usr:e.state,key:e.key,idx:t}}function d(e,t,n,r){return void 0===n&&(n=null),a({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?p(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function f(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function p(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function g(t,n,r,i){void 0===i&&(i={});let{window:s=document.defaultView,v5Compat:o=!1}=i,u=s.history,p=e.Pop,g=null,m=v();function v(){return(u.state||{idx:null}).idx}function y(){p=e.Pop;let t=v(),n=null==t?null:t-m;m=t,g&&g({action:p,location:b.location,delta:n})}function _(e){let t="null"!==s.location.origin?s.location.origin:s.location.href,n="string"===typeof e?e:f(e);return c(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==m&&(m=0,u.replaceState(a({},u.state,{idx:m}),""));let b={get action(){return p},get location(){return t(s,u)},listen(e){if(g)throw new Error("A history only accepts one active listener");return s.addEventListener(l,y),g=e,()=>{s.removeEventListener(l,y),g=null}},createHref:e=>n(s,e),createURL:_,encodeLocation(e){let t=_(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(t,n){p=e.Push;let i=d(b.location,t,n);r&&r(i,t),m=v()+1;let a=h(i,m),l=b.createHref(i);try{u.pushState(a,"",l)}catch(V_){if(V_ instanceof DOMException&&"DataCloneError"===V_.name)throw V_;s.location.assign(l)}o&&g&&g({action:p,location:b.location,delta:1})},replace:function(t,n){p=e.Replace;let i=d(b.location,t,n);r&&r(i,t),m=v();let s=h(i,m),a=b.createHref(i);u.replaceState(s,"",a),o&&g&&g({action:p,location:b.location,delta:0})},go:e=>u.go(e)};return b}var m;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(m||(m={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,n){void 0===n&&(n="/");let r=P(("string"===typeof t?p(t):t).pathname||"/",n);if(null==r)return null;let i=y(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(i);let s=null;for(let o=0;null==s&&o<i.length;++o)s=x(i[o],N(r));return s}function y(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let i=(e,i,s)=>{let o={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:i,route:e};o.relativePath.startsWith("/")&&(c(o.relativePath.startsWith(r),'Absolute route path "'+o.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),o.relativePath=o.relativePath.slice(r.length));let a=F([r,o.relativePath]),l=n.concat(o);e.children&&e.children.length>0&&(c(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+a+'".'),y(e.children,t,l,a)),(null!=e.path||e.index)&&t.push({path:a,score:I(a,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of _(e.path))i(e,t,r);else i(e,t)})),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(0===r.length)return i?[s,""]:[s];let o=_(r.join("/")),a=[];return a.push(...o.map((e=>""===e?s:[s,e].join("/")))),i&&a.push(...o),a.map((t=>e.startsWith("/")&&""===t?"/":t))}const b=/^:[\w-]+$/,w=3,k=2,S=1,E=10,C=-2,T=e=>"*"===e;function I(e,t){let n=e.split("/"),r=n.length;return n.some(T)&&(r+=C),t&&(r+=k),n.filter((e=>!T(e))).reduce(((e,t)=>e+(b.test(t)?w:""===t?S:E)),r)}function x(e,t){let{routesMeta:n}=e,r={},i="/",s=[];for(let o=0;o<n.length;++o){let e=n[o],a=o===n.length-1,l="/"===i?t:t.slice(i.length)||"/",c=R({path:e.relativePath,caseSensitive:e.caseSensitive,end:a},l);if(!c)return null;Object.assign(r,c.params);let u=e.route;s.push({params:r,pathname:F([i,c.pathname]),pathnameBase:M(F([i,c.pathnameBase])),route:u}),"/"!==c.pathnameBase&&(i=F([i,c.pathnameBase]))}return s}function R(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);u("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),i+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":""!==e&&"/"!==e&&(i+="(?:(?=\\/|$))");let s=new RegExp(i,t?void 0:"i");return[s,r]}(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:i}=t;if("*"===r){let e=a[n]||"";o=s.slice(0,s.length-e.length).replace(/(.)\/+$/,"$1")}const l=a[n];return e[r]=i&&!l?void 0:function(e,t){try{return decodeURIComponent(e)}catch(V_){return u(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+V_+")."),e}}(l||"",r),e}),{});return{params:l,pathname:s,pathnameBase:o,pattern:e}}function N(e){try{return decodeURI(e)}catch(V_){return u(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+V_+")."),e}}function P(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function A(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function O(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function D(e,t){let n=O(e);return t?n.map(((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)):n.map((e=>e.pathnameBase))}function L(e,t,n,r){let i;void 0===r&&(r=!1),"string"===typeof e?i=p(e):(i=a({},e),c(!i.pathname||!i.pathname.includes("?"),A("?","pathname","search",i)),c(!i.pathname||!i.pathname.includes("#"),A("#","pathname","hash",i)),c(!i.search||!i.search.includes("#"),A("#","search","hash",i)));let s,o=""===e||""===i.pathname,l=o?"/":i.pathname;if(null==l)s=n;else{let e=t.length-1;if(!r&&l.startsWith("..")){let t=l.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}s=e>=0?t[e]:"/"}let u=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:i=""}="string"===typeof e?p(e):e,s=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:s,search:j(r),hash:U(i)}}(i,s),h=l&&"/"!==l&&l.endsWith("/"),d=(o||"."===l)&&n.endsWith("/");return u.pathname.endsWith("/")||!h&&!d||(u.pathname+="/"),u}const F=e=>e.join("/").replace(/\/\/+/g,"/"),M=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),j=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",U=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],z=(new Set(V),["get",...V]);new Set(z),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},B.apply(this,arguments)}const H=t.createContext(null);const W=t.createContext(null);const G=t.createContext(null);const $=t.createContext(null);const K=t.createContext({outlet:null,matches:[],isDataRoute:!1});const Q=t.createContext(null);function Y(){return null!=t.useContext($)}function J(){return Y()||c(!1),t.useContext($).location}function X(e){t.useContext(G).static||t.useLayoutEffect(e)}function Z(){let{isDataRoute:e}=t.useContext(K);return e?function(){let{router:e}=ce(ae.UseNavigateStable),n=he(le.UseNavigateStable),r=t.useRef(!1);X((()=>{r.current=!0}));let i=t.useCallback((function(t,i){void 0===i&&(i={}),r.current&&("number"===typeof t?e.navigate(t):e.navigate(t,B({fromRouteId:n},i)))}),[e,n]);return i}():function(){Y()||c(!1);let e=t.useContext(H),{basename:n,future:r,navigator:i}=t.useContext(G),{matches:s}=t.useContext(K),{pathname:o}=J(),a=JSON.stringify(D(s,r.v7_relativeSplatPath)),l=t.useRef(!1);return X((()=>{l.current=!0})),t.useCallback((function(t,r){if(void 0===r&&(r={}),!l.current)return;if("number"===typeof t)return void i.go(t);let s=L(t,JSON.parse(a),o,"path"===r.relative);null==e&&"/"!==n&&(s.pathname="/"===s.pathname?n:F([n,s.pathname])),(r.replace?i.replace:i.push)(s,r.state,r)}),[n,i,a,o,e])}()}function ee(e,n){let{relative:r}=void 0===n?{}:n,{future:i}=t.useContext(G),{matches:s}=t.useContext(K),{pathname:o}=J(),a=JSON.stringify(D(s,i.v7_relativeSplatPath));return t.useMemo((()=>L(e,JSON.parse(a),o,"path"===r)),[e,a,o,r])}function te(n,r,i,s){Y()||c(!1);let{navigator:o}=t.useContext(G),{matches:a}=t.useContext(K),l=a[a.length-1],u=l?l.params:{},h=(l&&l.pathname,l?l.pathnameBase:"/");l&&l.route;let d,f=J();if(r){var g;let e="string"===typeof r?p(r):r;"/"===h||(null==(g=e.pathname)?void 0:g.startsWith(h))||c(!1),d=e}else d=f;let m=d.pathname||"/",y=v(n,{pathname:"/"===h?m:m.slice(h.length)||"/"});let _=oe(y&&y.map((e=>Object.assign({},e,{params:Object.assign({},u,e.params),pathname:F([h,o.encodeLocation?o.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:F([h,o.encodeLocation?o.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),a,i,s);return r&&_?t.createElement($.Provider,{value:{location:B({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:e.Pop}},_):_}function ne(){let e=function(){var e;let n=t.useContext(Q),r=ue(le.UseRouteError),i=he(le.UseRouteError);if(void 0!==n)return n;return null==(e=r.errors)?void 0:e[i]}(),n=q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i};return t.createElement(t.Fragment,null,t.createElement("h2",null,"Unexpected Application Error!"),t.createElement("h3",{style:{fontStyle:"italic"}},n),r?t.createElement("pre",{style:s},r):null,null)}const re=t.createElement(ne,null);class ie extends t.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?t.createElement(K.Provider,{value:this.props.routeContext},t.createElement(Q.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function se(e){let{routeContext:n,match:r,children:i}=e,s=t.useContext(H);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),t.createElement(K.Provider,{value:n},i)}function oe(e,n,r,i){var s;if(void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),null==e){var o;if(null==(o=r)||!o.errors)return null;e=r.matches}let a=e,l=null==(s=r)?void 0:s.errors;if(null!=l){let e=a.findIndex((e=>e.route.id&&(null==l?void 0:l[e.route.id])));e>=0||c(!1),a=a.slice(0,Math.min(a.length,e+1))}let u=!1,h=-1;if(r&&i&&i.v7_partialHydration)for(let t=0;t<a.length;t++){let e=a[t];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(h=t),e.route.id){let{loaderData:t,errors:n}=r,i=e.route.loader&&void 0===t[e.route.id]&&(!n||void 0===n[e.route.id]);if(e.route.lazy||i){u=!0,a=h>=0?a.slice(0,h+1):[a[0]];break}}}return a.reduceRight(((e,i,s)=>{let o,c=!1,d=null,f=null;var p;r&&(o=l&&i.route.id?l[i.route.id]:void 0,d=i.route.errorElement||re,u&&(h<0&&0===s?(p="route-fallback",!1||de[p]||(de[p]=!0),c=!0,f=null):h===s&&(c=!0,f=i.route.hydrateFallbackElement||null)));let g=n.concat(a.slice(0,s+1)),m=()=>{let n;return n=o?d:c?f:i.route.Component?t.createElement(i.route.Component,null):i.route.element?i.route.element:e,t.createElement(se,{match:i,routeContext:{outlet:e,matches:g,isDataRoute:null!=r},children:n})};return r&&(i.route.ErrorBoundary||i.route.errorElement||0===s)?t.createElement(ie,{location:r.location,revalidation:r.revalidation,component:d,error:o,children:m(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):m()}),null)}var ae=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ae||{}),le=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(le||{});function ce(e){let n=t.useContext(H);return n||c(!1),n}function ue(e){let n=t.useContext(W);return n||c(!1),n}function he(e){let n=function(e){let n=t.useContext(K);return n||c(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||c(!1),r.route.id}const de={};r.startTransition;function fe(e){let{to:n,replace:r,state:i,relative:s}=e;Y()||c(!1);let{future:o,static:a}=t.useContext(G),{matches:l}=t.useContext(K),{pathname:u}=J(),h=Z(),d=L(n,D(l,o.v7_relativeSplatPath),u,"path"===s),f=JSON.stringify(d);return t.useEffect((()=>h(JSON.parse(f),{replace:r,state:i,relative:s})),[h,f,s,r,i]),null}function pe(e){c(!1)}function ge(n){let{basename:r="/",children:i=null,location:s,navigationType:o=e.Pop,navigator:a,static:l=!1,future:u}=n;Y()&&c(!1);let h=r.replace(/^\/*/,"/"),d=t.useMemo((()=>({basename:h,navigator:a,static:l,future:B({v7_relativeSplatPath:!1},u)})),[h,u,a,l]);"string"===typeof s&&(s=p(s));let{pathname:f="/",search:g="",hash:m="",state:v=null,key:y="default"}=s,_=t.useMemo((()=>{let e=P(f,h);return null==e?null:{location:{pathname:e,search:g,hash:m,state:v,key:y},navigationType:o}}),[h,f,g,m,v,y,o]);return null==_?null:t.createElement(G.Provider,{value:d},t.createElement($.Provider,{children:i,value:_}))}function me(e){let{children:t,location:n}=e;return te(ve(t),n)}new Promise((()=>{}));t.Component;function ve(e,n){void 0===n&&(n=[]);let r=[];return t.Children.forEach(e,((e,i)=>{if(!t.isValidElement(e))return;let s=[...n,i];if(e.type===t.Fragment)return void r.push.apply(r,ve(e.props.children,s));e.type!==pe&&c(!1),e.props.index&&e.props.children&&c(!1);let o={id:e.props.id||s.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(o.children=ve(e.props.children,s)),r.push(o)})),r}function ye(){return ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}function _e(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const be=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","unstable_viewTransition"];new Map;const we=r.startTransition;o.flushSync,r.useId;function ke(e){let{basename:n,children:r,future:i,window:s}=e,o=t.useRef();var a;null==o.current&&(o.current=(void 0===(a={window:s,v5Compat:!0})&&(a={}),g((function(e,t){let{pathname:n="/",search:r="",hash:i=""}=p(e.location.hash.substr(1));return n.startsWith("/")||n.startsWith(".")||(n="/"+n),d("",{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){let n=e.document.querySelector("base"),r="";if(n&&n.getAttribute("href")){let t=e.location.href,n=t.indexOf("#");r=-1===n?t:t.slice(0,n)}return r+"#"+("string"===typeof t?t:f(t))}),(function(e,t){u("/"===e.pathname.charAt(0),"relative pathnames are not supported in hash history.push("+JSON.stringify(t)+")")}),a)));let l=o.current,[c,h]=t.useState({action:l.action,location:l.location}),{v7_startTransition:m}=i||{},v=t.useCallback((e=>{m&&we?we((()=>h(e))):h(e)}),[h,m]);return t.useLayoutEffect((()=>l.listen(v)),[l,v]),t.createElement(ge,{basename:n,children:r,location:c.location,navigationType:c.action,navigator:l,future:i})}const Se="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ee=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ce=t.forwardRef((function(e,n){let r,{onClick:i,relative:s,reloadDocument:o,replace:a,state:l,target:u,to:h,preventScrollReset:d,unstable_viewTransition:p}=e,g=_e(e,be),{basename:m}=t.useContext(G),v=!1;if("string"===typeof h&&Ee.test(h)&&(r=h,Se))try{let e=new URL(window.location.href),t=h.startsWith("//")?new URL(e.protocol+h):new URL(h),n=P(t.pathname,m);t.origin===e.origin&&null!=n?h=n+t.search+t.hash:v=!0}catch(AE){}let y=function(e,n){let{relative:r}=void 0===n?{}:n;Y()||c(!1);let{basename:i,navigator:s}=t.useContext(G),{hash:o,pathname:a,search:l}=ee(e,{relative:r}),u=a;return"/"!==i&&(u="/"===a?i:F([i,a])),s.createHref({pathname:u,search:l,hash:o})}(h,{relative:s}),_=function(e,n){let{target:r,replace:i,state:s,preventScrollReset:o,relative:a,unstable_viewTransition:l}=void 0===n?{}:n,c=Z(),u=J(),h=ee(e,{relative:a});return t.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,r)){t.preventDefault();let n=void 0!==i?i:f(u)===f(h);c(e,{replace:n,state:s,preventScrollReset:o,relative:a,unstable_viewTransition:l})}}),[u,c,h,i,s,r,e,o,a,l])}(h,{replace:a,state:l,target:u,preventScrollReset:d,relative:s,unstable_viewTransition:p});return t.createElement("a",ye({},g,{href:r||y,onClick:v||o?i:function(e){i&&i(e),e.defaultPrevented||_(e)},ref:n,target:u}))}));var Te,Ie;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Te||(Te={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Ie||(Ie={}));const xe=!1,Re=!1,Ne="${JSCORE_VERSION}",Pe=function(e,t){if(!e)throw Ae(t)},Ae=function(e){return new Error("Firebase Database ("+Ne+") INTERNAL ASSERT FAILED: "+e)},Oe=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},De={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Oe(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new Le;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class Le extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Fe=function(e){const t=Oe(e);return De.encodeByteArray(t,!0)},Me=function(e){return Fe(e).replace(/\./g,"")},je=function(e){try{return De.decodeString(e,!0)}catch(AE){console.error("base64Decode failed: ",AE)}return null};function Ue(e){return qe(void 0,e)}function qe(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=qe(e[n],t[n]));return e}const Ve=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,ze=()=>{try{return Ve()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(AE){return}const t=e&&je(e[1]);return t&&JSON.parse(t)})()}catch(AE){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(AE))}},Be=e=>{var t,n;return null===(n=null===(t=ze())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},He=()=>{var e;return null===(e=ze())||void 0===e?void 0:e.config},We=e=>{var t;return null===(t=ze())||void 0===t?void 0:t["_".concat(e)]};class Ge{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function $e(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Ke(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($e())}function Qe(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function Ye(){return!0===xe||!0===Re}function Je(){return!function(){var e;const t=null===(e=ze())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(AE){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xe(){try{return"object"===typeof indexedDB}catch(AE){return!1}}class Ze extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Ze.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,et.prototype.create)}}class et{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(tt,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new Ze(n,s,t)}}const tt=/\{\$([^}]+)}/g;function nt(e){return JSON.parse(e)}function rt(e){return JSON.stringify(e)}const it=function(e){let t={},n={},r={},i="";try{const s=e.split(".");t=nt(je(s[0])||""),n=nt(je(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(AE){}return{header:t,claims:n,data:r,signature:i}};function st(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ot(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function at(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function lt(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function ct(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(ut(n)&&ut(s)){if(!ct(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function ut(e){return null!==e&&"object"===typeof e}function ht(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function dt(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function ft(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class pt{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"===typeof e)for(let u=0;u<16;u++)n[u]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let u=0;u<16;u++)n[u]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let u=16;u<80;u++){const e=n[u-3]^n[u-8]^n[u-14]^n[u-16];n[u]=4294967295&(e<<1|e>>>31)}let r,i,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(r=l^o&(a^l),i=1518500249):(r=o^a^l,i=1859775393):u<60?(r=o&a|l&(o|a),i=2400959708):(r=o^a^l,i=3395469782);const e=(s<<5|s>>>27)+r+c+i+n[u]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let r=0;r<5;r++)for(let t=24;t>=0;t-=8)e[n]=this.chain_[r]>>t&255,++n;return e}}class gt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=mt),void 0===r.error&&(r.error=mt),void 0===r.complete&&(r.complete=mt);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(AE){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(AE){"undefined"!==typeof console&&console.error&&console.error(AE)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function mt(){}function vt(e,t){return"".concat(e," failed: ").concat(t," argument ")}const yt=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function _t(e){return e&&e._delegate?e._delegate:e}class bt{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const wt="[DEFAULT]";class kt{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Ge;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(AE){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(AE){if(r)return null;throw AE}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:wt})}catch(AE){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(AE){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===wt?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt;return this.component?this.component.multipleInstances?e:wt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class St{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new kt(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Et=[];var Ct;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Ct||(Ct={}));const Tt={debug:Ct.DEBUG,verbose:Ct.VERBOSE,info:Ct.INFO,warn:Ct.WARN,error:Ct.ERROR,silent:Ct.SILENT},It=Ct.INFO,xt={[Ct.DEBUG]:"log",[Ct.VERBOSE]:"log",[Ct.INFO]:"info",[Ct.WARN]:"warn",[Ct.ERROR]:"error"},Rt=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=xt[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class Nt{constructor(e){this.name=e,this._logLevel=It,this._logHandler=Rt,this._userLogHandler=null,Et.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ct))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?Tt[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ct.DEBUG,...t),this._logHandler(this,Ct.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ct.VERBOSE,...t),this._logHandler(this,Ct.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ct.INFO,...t),this._logHandler(this,Ct.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ct.WARN,...t),this._logHandler(this,Ct.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,Ct.ERROR,...t),this._logHandler(this,Ct.ERROR,...t)}}const Pt=(e,t)=>t.some((t=>e instanceof t));let At,Ot;const Dt=new WeakMap,Lt=new WeakMap,Ft=new WeakMap,Mt=new WeakMap,jt=new WeakMap;let Ut={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Lt.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Ft.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return zt(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function qt(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Ot||(Ot=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(Bt(this),n),zt(Dt.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return zt(e.apply(Bt(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(Bt(this),t,...r);return Ft.set(s,t.sort?t.sort():[t]),zt(s)}}function Vt(e){return"function"===typeof e?qt(e):(e instanceof IDBTransaction&&function(e){if(Lt.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));Lt.set(e,t)}(e),Pt(e,At||(At=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Ut):e)}function zt(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(zt(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&Dt.set(t,e)})).catch((()=>{})),jt.set(t,e),t}(e);if(Mt.has(e))return Mt.get(e);const t=Vt(e);return t!==e&&(Mt.set(e,t),jt.set(t,e)),t}const Bt=e=>jt.get(e);const Ht=["get","getKey","getAll","getAllKeys","count"],Wt=["put","add","delete","clear"],Gt=new Map;function $t(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(Gt.get(t))return Gt.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Wt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Ht.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return Gt.set(t,s),s}Ut=(e=>({...e,get:(t,n,r)=>$t(t,n)||e.get(t,n,r),has:(t,n)=>!!$t(t,n)||e.has(t,n)}))(Ut);class Kt{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const Qt="@firebase/app",Yt="0.10.2",Jt=new Nt("@firebase/app"),Xt="@firebase/app-compat",Zt="@firebase/analytics-compat",en="@firebase/analytics",tn="@firebase/app-check-compat",nn="@firebase/app-check",rn="@firebase/auth",sn="@firebase/auth-compat",on="@firebase/database",an="@firebase/database-compat",ln="@firebase/functions",cn="@firebase/functions-compat",un="@firebase/installations",hn="@firebase/installations-compat",dn="@firebase/messaging",fn="@firebase/messaging-compat",pn="@firebase/performance",gn="@firebase/performance-compat",mn="@firebase/remote-config",vn="@firebase/remote-config-compat",yn="@firebase/storage",_n="@firebase/storage-compat",bn="@firebase/firestore",wn="@firebase/firestore-compat",kn="firebase",Sn="[DEFAULT]",En={[Qt]:"fire-core",[Xt]:"fire-core-compat",[en]:"fire-analytics",[Zt]:"fire-analytics-compat",[nn]:"fire-app-check",[tn]:"fire-app-check-compat",[rn]:"fire-auth",[sn]:"fire-auth-compat",[on]:"fire-rtdb",[an]:"fire-rtdb-compat",[ln]:"fire-fn",[cn]:"fire-fn-compat",[un]:"fire-iid",[hn]:"fire-iid-compat",[dn]:"fire-fcm",[fn]:"fire-fcm-compat",[pn]:"fire-perf",[gn]:"fire-perf-compat",[mn]:"fire-rc",[vn]:"fire-rc-compat",[yn]:"fire-gcs",[_n]:"fire-gcs-compat",[bn]:"fire-fst",[wn]:"fire-fst-compat","fire-js":"fire-js",[kn]:"fire-js-all"},Cn=new Map,Tn=new Map,In=new Map;function xn(e,t){try{e.container.addComponent(t)}catch(AE){Jt.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),AE)}}function Rn(e){const t=e.name;if(In.has(t))return Jt.debug("There were multiple attempts to register component ".concat(t,".")),!1;In.set(t,e);for(const n of Cn.values())xn(n,e);for(const n of Tn.values())xn(n,e);return!0}function Nn(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Pn(e){return void 0!==e.settings}const An=new et("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class On{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bt("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw An.create("app-deleted",{appName:this._name})}}const Dn="10.11.1";function Ln(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Sn,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw An.create("bad-app-name",{appName:String(i)});if(n||(n=He()),!n)throw An.create("no-options");const s=Cn.get(i);if(s){if(ct(n,s.options)&&ct(r,s.config))return s;throw An.create("duplicate-app",{appName:i})}const o=new St(i);for(const l of In.values())o.addComponent(l);const a=new On(n,r,o);return Cn.set(i,a),a}function Fn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sn;const t=Cn.get(e);if(!t&&e===Sn&&He())return Ln();if(!t)throw An.create("no-app",{appName:e});return t}function Mn(e,t,n){var r;let i=null!==(r=En[e])&&void 0!==r?r:e;n&&(i+="-".concat(n));const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=['Unable to register library "'.concat(i,'" with version "').concat(t,'":')];return s&&e.push('library name "'.concat(i,'" contains illegal characters (whitespace or "/")')),s&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void Jt.warn(e.join(" "))}Rn(new bt("".concat(i,"-version"),(()=>({library:i,version:t})),"VERSION"))}const jn="firebase-heartbeat-database",Un=1,qn="firebase-heartbeat-store";let Vn=null;function zn(){return Vn||(Vn=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=zt(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(zt(o.result),e.oldVersion,e.newVersion,zt(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(jn,Un,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(qn)}catch(AE){console.warn(AE)}}}).catch((e=>{throw An.create("idb-open",{originalErrorMessage:e.message})}))),Vn}async function Bn(e,t){try{const n=(await zn()).transaction(qn,"readwrite"),r=n.objectStore(qn);await r.put(t,Hn(e)),await n.done}catch(AE){if(AE instanceof Ze)Jt.warn(AE.message);else{const t=An.create("idb-set",{originalErrorMessage:null===AE||void 0===AE?void 0:AE.message});Jt.warn(t.message)}}}function Hn(e){return"".concat(e.name,"!").concat(e.options.appId)}class Wn{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new $n(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=Gn();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=Gn(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Kn(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Kn(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=Me(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Gn(){return(new Date).toISOString().substring(0,10)}class $n{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!Xe()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(V_){t(V_)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await zn()).transaction(qn),n=await t.objectStore(qn).get(Hn(e));return await t.done,n}catch(AE){if(AE instanceof Ze)Jt.warn(AE.message);else{const t=An.create("idb-get",{originalErrorMessage:null===AE||void 0===AE?void 0:AE.message});Jt.warn(t.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Bn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Bn(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Kn(e){return Me(JSON.stringify({version:2,heartbeats:e})).length}var Qn;Qn="",Rn(new bt("platform-logger",(e=>new Kt(e)),"PRIVATE")),Rn(new bt("heartbeat",(e=>new Wn(e)),"PRIVATE")),Mn(Qt,Yt,Qn),Mn(Qt,Yt,"esm2017"),Mn("fire-js","");var Yn,Jn="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Xn={},Zn=Zn||{},er=Jn||self;function tr(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function nr(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var rr="closure_uid_"+(1e9*Math.random()>>>0),ir=0;function sr(e,t,n){return e.call.apply(e.bind,arguments)}function or(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function ar(e,t,n){return(ar=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?sr:or).apply(null,arguments)}function lr(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function cr(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function ur(){this.s=this.s,this.o=this.o}ur.prototype.s=!1,ur.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),0)&&function(e){Object.prototype.hasOwnProperty.call(e,rr)&&e[rr]||(e[rr]=++ir)}(this)},ur.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const hr=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function dr(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function fr(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(tr(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function pr(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}pr.prototype.h=function(){this.defaultPrevented=!0};var gr=function(){if(!er.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};er.addEventListener("test",e,t),er.removeEventListener("test",e,t)}catch(VE){}return e}();function mr(e){return/^[\s\xa0]*$/.test(e)}function vr(){var e=er.navigator;return e&&(e=e.userAgent)?e:""}function yr(e){return-1!=vr().indexOf(e)}function _r(e){return _r[" "](e),e}_r[" "]=function(){};var br,wr,kr=yr("Opera"),Sr=yr("Trident")||yr("MSIE"),Er=yr("Edge"),Cr=Er||Sr,Tr=yr("Gecko")&&!(-1!=vr().toLowerCase().indexOf("webkit")&&!yr("Edge"))&&!(yr("Trident")||yr("MSIE"))&&!yr("Edge"),Ir=-1!=vr().toLowerCase().indexOf("webkit")&&!yr("Edge");function xr(){var e=er.document;return e?e.documentMode:void 0}e:{var Rr="",Nr=function(){var e=vr();return Tr?/rv:([^\);]+)(\)|;)/.exec(e):Er?/Edge\/([\d\.]+)/.exec(e):Sr?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Ir?/WebKit\/(\S+)/.exec(e):kr?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Nr&&(Rr=Nr?Nr[1]:""),Sr){var Pr=xr();if(null!=Pr&&Pr>parseFloat(Rr)){br=String(Pr);break e}}br=Rr}if(er.document&&Sr){var Ar=xr();wr=Ar||(parseInt(br,10)||void 0)}else wr=void 0;var Or=wr;function Dr(e,t){if(pr.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Tr){e:{try{_r(t.nodeName);var i=!0;break e}catch(HE){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Lr[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Dr.$.h.call(this)}}cr(Dr,pr);var Lr={2:"touch",3:"pen",4:"mouse"};Dr.prototype.h=function(){Dr.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Fr="closure_listenable_"+(1e6*Math.random()|0),Mr=0;function jr(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++Mr,this.fa=this.ia=!1}function Ur(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function qr(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function Vr(e){const t={};for(const n in e)t[n]=e[n];return t}const zr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Br(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<zr.length;t++)n=zr[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function Hr(e){this.src=e,this.g={},this.h=0}function Wr(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=hr(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Ur(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function Gr(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&s.capture==!!n&&s.la==r)return i}return-1}Hr.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=Gr(e,t,r,i);return-1<o?(t=e[o],n||(t.ia=!1)):((t=new jr(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var $r="closure_lm_"+(1e6*Math.random()|0),Kr={};function Qr(e,t,n,r,i){if(r&&r.once)return Jr(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Qr(e,t[s],n,r,i);return null}return n=ii(n),e&&e[Fr]?e.O(t,n,nr(r)?!!r.capture:!!r,i):Yr(e,t,n,!1,r,i)}function Yr(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=nr(i)?!!i.capture:!!i,a=ni(e);if(a||(e[$r]=a=new Hr(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=ti;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)gr||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ei(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function Jr(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)Jr(e,t[s],n,r,i);return null}return n=ii(n),e&&e[Fr]?e.P(t,n,nr(r)?!!r.capture:!!r,i):Yr(e,t,n,!0,r,i)}function Xr(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Xr(e,t[s],n,r,i);else r=nr(r)?!!r.capture:!!r,n=ii(n),e&&e[Fr]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=Gr(s=e.g[t],n,r,i))&&(Ur(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=ni(e))&&(t=e.g[t.toString()],e=-1,t&&(e=Gr(t,n,r,i)),(n=-1<e?t[e]:null)&&Zr(n))}function Zr(e){if("number"!==typeof e&&e&&!e.fa){var t=e.src;if(t&&t[Fr])Wr(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ei(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ni(t))?(Wr(n,e),0==n.h&&(n.src=null,t[$r]=null)):Ur(e)}}}function ei(e){return e in Kr?Kr[e]:Kr[e]="on"+e}function ti(e,t){if(e.fa)e=!0;else{t=new Dr(t,this);var n=e.listener,r=e.la||e.src;e.ia&&Zr(e),e=n.call(r,t)}return e}function ni(e){return(e=e[$r])instanceof Hr?e:null}var ri="__closure_events_fn_"+(1e9*Math.random()>>>0);function ii(e){return"function"===typeof e?e:(e[ri]||(e[ri]=function(t){return e.handleEvent(t)}),e[ri])}function si(){ur.call(this),this.i=new Hr(this),this.S=this,this.J=null}function oi(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"===typeof t)t=new pr(t,e);else if(t instanceof pr)t.target=t.target||e;else{var i=t;Br(t=new pr(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ai(o,r,!0,t)&&i}if(i=ai(o=t.g=e,r,!0,t)&&i,i=ai(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ai(o=t.g=n[s],r,!1,t)&&i}function ai(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&Wr(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}cr(si,ur),si.prototype[Fr]=!0,si.prototype.removeEventListener=function(e,t,n,r){Xr(this,e,t,n,r)},si.prototype.N=function(){if(si.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ur(n[r]);delete t.g[e],t.h--}}this.J=null},si.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},si.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var li=er.JSON.stringify;function ci(){var e=mi;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var ui=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new hi),(e=>e.reset()));class hi{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function di(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function fi(e){er.setTimeout((()=>{throw e}),0)}let pi,gi=!1,mi=new class{constructor(){this.h=this.g=null}add(e,t){const n=ui.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},vi=()=>{const e=er.Promise.resolve(void 0);pi=()=>{e.then(yi)}};var yi=()=>{for(var e;e=ci();){try{e.h.call(e.g)}catch(VE){fi(VE)}var t=ui;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}gi=!1};function _i(e,t){si.call(this),this.h=e||1,this.g=t||er,this.j=ar(this.qb,this),this.l=Date.now()}function bi(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function wi(e,t,n){if("function"===typeof e)n&&(e=ar(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=ar(e.handleEvent,e)}return 2147483647<Number(t)?-1:er.setTimeout(e,t||0)}function ki(e){e.g=wi((()=>{e.g=null,e.i&&(e.i=!1,ki(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}cr(_i,si),(Yn=_i.prototype).ga=!1,Yn.T=null,Yn.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),oi(this,"tick"),this.ga&&(bi(this),this.start()))}},Yn.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Yn.N=function(){_i.$.N.call(this),bi(this),delete this.g};class Si extends ur{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ki(this)}N(){super.N(),this.g&&(er.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ei(e){ur.call(this),this.h=e,this.g={}}cr(Ei,ur);var Ci=[];function Ti(e,t,n,r){Array.isArray(n)||(n&&(Ci[0]=n.toString()),n=Ci);for(var i=0;i<n.length;i++){var s=Qr(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Ii(e){qr(e.g,(function(e,t){this.g.hasOwnProperty(t)&&Zr(e)}),e),e.g={}}function xi(){this.g=!0}function Ri(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return li(n)}catch(DE){return t}}(e,n)+(r?" "+r:"")}))}Ei.prototype.N=function(){Ei.$.N.call(this),Ii(this)},Ei.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},xi.prototype.Ea=function(){this.g=!1},xi.prototype.info=function(){};var Ni={},Pi=null;function Ai(){return Pi=Pi||new si}function Oi(e){pr.call(this,Ni.Ta,e)}function Di(e){const t=Ai();oi(t,new Oi(t))}function Li(e,t){pr.call(this,Ni.STAT_EVENT,e),this.stat=t}function Fi(e){const t=Ai();oi(t,new Li(t,e))}function Mi(e,t){pr.call(this,Ni.Ua,e),this.size=t}function ji(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return er.setTimeout((function(){e()}),t)}Ni.Ta="serverreachability",cr(Oi,pr),Ni.STAT_EVENT="statevent",cr(Li,pr),Ni.Ua="timingevent",cr(Mi,pr);var Ui={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},qi={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Vi(){}function zi(e){return e.h||(e.h=e.i())}function Bi(){}Vi.prototype.h=null;var Hi,Wi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Gi(){pr.call(this,"d")}function $i(){pr.call(this,"c")}function Ki(){}function Qi(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new Ei(this),this.P=Ji,e=Cr?125:void 0,this.V=new _i(e),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Yi}function Yi(){this.i=null,this.g="",this.h=!1}cr(Gi,pr),cr($i,pr),cr(Ki,Vi),Ki.prototype.g=function(){return new XMLHttpRequest},Ki.prototype.i=function(){return{}},Hi=new Ki;var Ji=45e3,Xi={},Zi={};function es(e,t,n){e.L=1,e.A=_s(ps(t)),e.u=n,e.S=!0,ts(e,null)}function ts(e,t){e.G=Date.now(),ss(e),e.B=ps(e.A);var n=e.B,r=e.W;Array.isArray(r)||(r=[String(r)]),As(n.i,"t",r),e.o=0,n=e.l.J,e.h=new Yi,e.g=Oo(e.l,n?t:null,!e.u),0<e.O&&(e.M=new Si(ar(e.Pa,e,e.g),e.O)),Ti(e.U,e.g,"readystatechange",e.nb),t=e.I?Vr(e.I):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.B,e.v,e.u,t)):(e.v="GET",e.g.ha(e.B,e.v,null,t)),Di(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var u=c[0];c=c[1];var h=u.split("_");o=2<=h.length&&"type"==h[1]?o+(u+"=")+c+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.v,e.B,e.m,e.W,e.u)}function ns(e){return!!e.g&&("GET"==e.v&&2!=e.L&&e.l.Ha)}function rs(e,t,n){let r,i=!0;for(;!e.J&&e.o<n.length;){if(r=is(e,n),r==Zi){4==t&&(e.s=4,Fi(14),i=!1),Ri(e.j,e.m,null,"[Incomplete Response]");break}if(r==Xi){e.s=4,Fi(15),Ri(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Ri(e.j,e.m,r,null),us(e,r)}ns(e)&&0!=e.o&&(e.h.g=e.h.g.slice(e.o),e.o=0),4!=t||0!=n.length||e.h.h||(e.s=1,Fi(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.ba&&(e.ba=!0,(t=e.l).g==e&&t.ca&&!t.M&&(t.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Co(t),t.M=!0,Fi(11))):(Ri(e.j,e.m,n,"[Invalid Chunked Response]"),cs(e),ls(e))}function is(e,t){var n=e.o,r=t.indexOf("\n",n);return-1==r?Zi:(n=Number(t.substring(n,r)),isNaN(n)?Xi:(r+=1)+n>t.length?Zi:(t=t.slice(r,r+n),e.o=r+n,t))}function ss(e){e.Y=Date.now()+e.P,os(e,e.P)}function os(e,t){if(null!=e.C)throw Error("WatchDog timer not null");e.C=ji(ar(e.lb,e),t)}function as(e){e.C&&(er.clearTimeout(e.C),e.C=null)}function ls(e){0==e.l.H||e.J||xo(e.l,e)}function cs(e){as(e);var t=e.M;t&&"function"==typeof t.sa&&t.sa(),e.M=null,bi(e.V),Ii(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.sa())}function us(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||Us(n.i,e)))if(!e.K&&Us(n.i,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(QE){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.G+3e3<e.G))break e;Io(n),vo(n)}Eo(n),Fi(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&0==n.A&&!n.v&&(n.v=ji(ar(n.ib,n),6e3));if(1>=js(n.i)&&n.oa){try{n.oa()}catch(QE){}n.oa=void 0}}else No(n,11)}else if((e.K||n.g==e)&&Io(n),!mr(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.V=c[0],c=c[1],2==n.H)if("c"==c[0]){n.K=c[1],n.pa=c[2];const t=c[3];null!=t&&(n.ra=t,n.l.info("VER="+n.ra));const i=c[4];null!=i&&(n.Ga=i,n.l.info("SVER="+n.Ga));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(qs(s,s.h),s.h=null))}if(r.F){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,ys(r.I,r.F,e))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-e.G,n.l.info("Handshake RTT: "+n.S+"ms"));var o=e;if((r=n).wa=Ao(r,r.J?r.pa:null,r.Y),o.K){Vs(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.C&&(as(a),ss(a)),r.g=o}else So(r);0<n.j.length&&_o(n)}else"stop"!=c[0]&&"close"!=c[0]||No(n,7);else 3==n.H&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?No(n,7):mo(n):"noop"!=c[0]&&n.h&&n.h.Aa(c),n.A=0)}Di()}catch(QE){}}function hs(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(tr(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.ta&&"function"==typeof e.ta)return e.ta();if(!e.Z||"function"!=typeof e.Z){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(tr(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(tr(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(Yn=Qi.prototype).setTimeout=function(e){this.P=e},Yn.nb=function(e){e=e.target;const t=this.M;t&&3==co(e)?t.l():this.Pa(e)},Yn.Pa=function(e){try{if(e==this.g)e:{const u=co(this.g);var t=this.g.Ia();this.g.da();if(!(3>u)&&(3!=u||Cr||this.g&&(this.h.h||this.g.ja()||uo(this.g)))){this.J||4!=u||7==t||Di(),as(this);var n=this.g.da();this.ca=n;t:if(ns(this)){var r=uo(this.g);e="";var i=r.length,s=4==co(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){cs(this),ls(this);var o="";break t}this.h.i=new er.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.length=0,this.h.g+=e,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.v,this.B,this.m,this.W,u,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!mr(a)){var c=a;break t}}c=null}if(!(n=c)){this.i=!1,this.s=3,Fi(12),cs(this),ls(this);break e}Ri(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,us(this,n)}this.S?(rs(this,u,o),Cr&&this.i&&3==u&&(Ti(this.U,this.V,"tick",this.mb),this.V.start())):(Ri(this.j,this.m,o,null),us(this,o)),4==u&&cs(this),this.i&&!this.J&&(4==u?xo(this.l,this):(this.i=!1,ss(this)))}else(function(e){const t={};e=(e.g&&2<=co(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(mr(e[r]))continue;var n=di(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Fi(12)):(this.s=0,Fi(13)),cs(this),ls(this)}}}catch(UE){}},Yn.mb=function(){if(this.g){var e=co(this.g),t=this.g.ja();this.o<t.length&&(as(this),rs(this,e,t),this.i&&4!=e&&ss(this))}},Yn.cancel=function(){this.J=!0,cs(this)},Yn.lb=function(){this.C=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.B),2!=this.L&&(Di(),Fi(17)),cs(this),this.s=2,ls(this)):os(this,this.Y-e)};var ds=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function fs(e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof fs){this.h=e.h,gs(this,e.j),this.s=e.s,this.g=e.g,ms(this,e.m),this.l=e.l;var t=e.i,n=new xs;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),vs(this,n),this.o=e.o}else e&&(t=String(e).match(ds))?(this.h=!1,gs(this,t[1]||"",!0),this.s=bs(t[2]||""),this.g=bs(t[3]||"",!0),ms(this,t[4]),this.l=bs(t[5]||"",!0),vs(this,t[6]||"",!0),this.o=bs(t[7]||"")):(this.h=!1,this.i=new xs(null,this.h))}function ps(e){return new fs(e)}function gs(e,t,n){e.j=n?bs(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function ms(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function vs(e,t,n){t instanceof xs?(e.i=t,function(e,t){t&&!e.j&&(Rs(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ns(this,t),As(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ws(t,Ts)),e.i=new xs(t,e.h))}function ys(e,t,n){e.i.set(t,n)}function _s(e){return ys(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function bs(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ws(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,ks),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ks(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}fs.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ws(t,Ss,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(ws(t,Ss,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ws(n,"/"==n.charAt(0)?Cs:Es,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",ws(n,Is)),e.join("")};var Ss=/[#\/\?@]/g,Es=/[#\?:]/g,Cs=/[#\?]/g,Ts=/[#\?@]/g,Is=/#/g;function xs(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Rs(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ns(e,t){Rs(e),t=Os(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ps(e,t){return Rs(e),t=Os(e,t),e.g.has(t)}function As(e,t,n){Ns(e,t),0<n.length&&(e.i=null,e.g.set(Os(e,t),dr(n)),e.h+=n.length)}function Os(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(Yn=xs.prototype).add=function(e,t){Rs(this),this.i=null,e=Os(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},Yn.forEach=function(e,t){Rs(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},Yn.ta=function(){Rs(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},Yn.Z=function(e){Rs(this);let t=[];if("string"===typeof e)Ps(this,e)&&(t=t.concat(this.g.get(Os(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},Yn.set=function(e,t){return Rs(this),this.i=null,Ps(this,e=Os(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},Yn.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},Yn.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var Ds=class{constructor(e,t){this.g=e,this.map=t}};function Ls(e){this.l=e||Fs,er.PerformanceNavigationTiming?e=0<(e=er.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(er.g&&er.g.Ka&&er.g.Ka()&&er.g.Ka().dc),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Fs=10;function Ms(e){return!!e.h||!!e.g&&e.g.size>=e.j}function js(e){return e.h?1:e.g?e.g.size:0}function Us(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function qs(e,t){e.g?e.g.add(t):e.h=t}function Vs(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function zs(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.F);return t}return dr(e.i)}Ls.prototype.cancel=function(){if(this.i=zs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Bs=class{stringify(e){return er.JSON.stringify(e,void 0)}parse(e){return er.JSON.parse(e,void 0)}};function Hs(){this.g=new Bs}function Ws(e,t,n){const r=n||"";try{hs(e,(function(e,n){let i=e;nr(e)&&(i=li(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(AE){throw t.push(r+"type="+encodeURIComponent("_badmap")),AE}}function Gs(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(HE){}}function $s(e){this.l=e.ec||null,this.j=e.ob||!1}function Ks(e,t){si.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=Qs,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}cr($s,Vi),$s.prototype.g=function(){return new Ks(this.l,this.j)},$s.prototype.i=function(e){return function(){return e}}({}),cr(Ks,si);var Qs=0;function Ys(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function Js(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Xs(e)}function Xs(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(Yn=Ks.prototype).open=function(e,t){if(this.readyState!=Qs)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Xs(this)},Yn.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||er).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},Yn.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Js(this)),this.readyState=Qs},Yn.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Xs(this)),this.g&&(this.readyState=3,Xs(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if("undefined"!==typeof er.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ys(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))},Yn.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Js(this):Xs(this),3==this.readyState&&Ys(this)}},Yn.Za=function(e){this.g&&(this.response=this.responseText=e,Js(this))},Yn.Ya=function(e){this.g&&(this.response=e,Js(this))},Yn.ka=function(){this.g&&Js(this)},Yn.setRequestHeader=function(e,t){this.v.append(e,t)},Yn.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},Yn.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ks.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Zs=er.JSON.parse;function eo(e){si.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=to,this.L=this.M=!1}cr(eo,si);var to="",no=/^https?$/i,ro=["POST","PUT"];function io(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,so(e),ao(e)}function so(e){e.F||(e.F=!0,oi(e,"complete"),oi(e,"error"))}function oo(e){if(e.h&&"undefined"!=typeof Zn&&(!e.C[1]||4!=co(e)||2!=e.da()))if(e.v&&4==co(e))wi(e.La,0,e);else if(oi(e,"readystatechange"),4==co(e)){e.h=!1;try{const o=e.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===o){var i=String(e.I).match(ds)[1]||null;!i&&er.self&&er.self.location&&(i=er.self.location.protocol.slice(0,-1)),r=!no.test(i?i.toLowerCase():"")}n=r}if(n)oi(e,"complete"),oi(e,"success");else{e.m=6;try{var s=2<co(e)?e.g.statusText:""}catch(DE){s=""}e.j=s+" ["+e.da()+"]",so(e)}}finally{ao(e)}}}function ao(e,t){if(e.g){lo(e);const n=e.g,r=e.C[0]?()=>{}:null;e.g=null,e.C=null,t||oi(e,"ready");try{n.onreadystatechange=r}catch(AE){}}}function lo(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(er.clearTimeout(e.A),e.A=null)}function co(e){return e.g?e.g.readyState:0}function uo(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case to:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(ya){return null}}function ho(e){let t="";return qr(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function fo(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=ho(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ys(e,t,n))}function po(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function go(e){this.Ga=0,this.j=[],this.l=new xi,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=po("failFast",!1,e),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=po("baseRetryDelayMs",5e3,e),this.hb=po("retryDelaySeedMs",1e4,e),this.eb=po("forwardChannelMaxRetries",2,e),this.xa=po("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.i=new Ls(e&&e.concurrentRequestLimit),this.Ja=new Hs,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.l.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.qa=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.qa=e.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function mo(e){if(yo(e),3==e.H){var t=e.W++,n=ps(e.I);if(ys(n,"SID",e.K),ys(n,"RID",t),ys(n,"TYPE","terminate"),wo(e,n),(t=new Qi(e,e.l,t)).L=2,t.A=_s(ps(n)),n=!1,er.navigator&&er.navigator.sendBeacon)try{n=er.navigator.sendBeacon(t.A.toString(),"")}catch(zE){}!n&&er.Image&&((new Image).src=t.A,n=!0),n||(t.g=Oo(t.l,null),t.g.ha(t.A)),t.G=Date.now(),ss(t)}Po(e)}function vo(e){e.g&&(Co(e),e.g.cancel(),e.g=null)}function yo(e){vo(e),e.u&&(er.clearTimeout(e.u),e.u=null),Io(e),e.i.cancel(),e.m&&("number"===typeof e.m&&er.clearTimeout(e.m),e.m=null)}function _o(e){if(!Ms(e.i)&&!e.m){e.m=!0;var t=e.Na;pi||vi(),gi||(pi(),gi=!0),mi.add(t,e),e.C=0}}function bo(e,t){var n;n=t?t.m:e.W++;const r=ps(e.I);ys(r,"SID",e.K),ys(r,"RID",n),ys(r,"AID",e.V),wo(e,r),e.o&&e.s&&fo(r,e.o,e.s),n=new Qi(e,e.l,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.j=t.F.concat(e.j)),t=ko(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),qs(e.i,n),es(n,r,t)}function wo(e,t){e.na&&qr(e.na,(function(e,n){ys(t,n,e)})),e.h&&hs({},(function(e,n){ys(t,n,e)}))}function ko(e,t,n){n=Math.min(e.j.length,n);var r=e.h?ar(e.h.Va,e.h,e):null;e:{var i=e.j;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let o=!0;for(let a=0;a<n;a++){let n=i[a].g;const l=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),o=!1;else try{Ws(l,e,"req"+n+"_")}catch(s){r&&r(l)}}if(o){r=e.join("&");break e}}}return e=e.j.splice(0,n),t.F=e,r}function So(e){if(!e.g&&!e.u){e.ba=1;var t=e.Ma;pi||vi(),gi||(pi(),gi=!0),mi.add(t,e),e.A=0}}function Eo(e){return!(e.g||e.u||3<=e.A)&&(e.ba++,e.u=ji(ar(e.Ma,e),Ro(e,e.A)),e.A++,!0)}function Co(e){null!=e.B&&(er.clearTimeout(e.B),e.B=null)}function To(e){e.g=new Qi(e,e.l,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=ps(e.wa);ys(t,"RID","rpc"),ys(t,"SID",e.K),ys(t,"AID",e.V),ys(t,"CI",e.G?"0":"1"),!e.G&&e.qa&&ys(t,"TO",e.qa),ys(t,"TYPE","xmlhttp"),wo(e,t),e.o&&e.s&&fo(t,e.o,e.s),e.L&&e.g.setTimeout(e.L);var n=e.g;e=e.pa,n.L=1,n.A=_s(ps(t)),n.u=null,n.S=!0,ts(n,e)}function Io(e){null!=e.v&&(er.clearTimeout(e.v),e.v=null)}function xo(e,t){var n=null;if(e.g==t){Io(e),Co(e),e.g=null;var r=2}else{if(!Us(e.i,t))return;n=t.F,Vs(e.i,t),r=1}if(0!=e.H)if(t.i)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.G;var i=e.C;oi(r=Ai(),new Mi(r,n)),_o(e)}else So(e);else if(3==(i=t.s)||0==i&&0<t.ca||!(1==r&&function(e,t){return!(js(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.j=t.F.concat(e.j),!0):!(1==e.H||2==e.H||e.C>=(e.cb?0:e.eb))&&(e.m=ji(ar(e.Na,e,t),Ro(e,e.C)),e.C++,!0))}(e,t)||2==r&&Eo(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:No(e,5);break;case 4:No(e,10);break;case 3:No(e,6);break;default:No(e,2)}}function Ro(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.isActive()||(n*=2),n*t}function No(e,t){if(e.l.info("Error code "+t),2==t){var n=null;e.h&&(n=null);var r=ar(e.pb,e);n||(n=new fs("//www.google.com/images/cleardot.gif"),er.location&&"http"==er.location.protocol||gs(n,"https"),_s(n)),function(e,t){const n=new xi;if(er.Image){const r=new Image;r.onload=lr(Gs,n,r,"TestLoadImage: loaded",!0,t),r.onerror=lr(Gs,n,r,"TestLoadImage: error",!1,t),r.onabort=lr(Gs,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=lr(Gs,n,r,"TestLoadImage: timeout",!1,t),er.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Fi(2);e.H=0,e.h&&e.h.za(t),Po(e),yo(e)}function Po(e){if(e.H=0,e.ma=[],e.h){const t=zs(e.i);0==t.length&&0==e.j.length||(fr(e.ma,t),fr(e.ma,e.j),e.i.i.length=0,dr(e.j),e.j.length=0),e.h.ya()}}function Ao(e,t,n){var r=n instanceof fs?ps(n):new fs(n);if(""!=r.g)t&&(r.g=t+"."+r.g),ms(r,r.m);else{var i=er.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new fs(null);r&&gs(s,r),t&&(s.g=t),i&&ms(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&ys(r,n,t),ys(r,"VER",e.ra),wo(e,r),r}function Oo(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ha&&!e.va?new eo(new $s({ob:n})):new eo(e.va)).Oa(e.J),t}function Do(){}function Lo(){if(Sr&&!(10<=Number(Or)))throw Error("Environmental error: no available transport.")}function Fo(e,t){si.call(this),this.g=new go(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!mr(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!mr(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Uo(this)}function Mo(e){Gi.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function jo(){$i.call(this),this.status=1}function Uo(e){this.g=e}function qo(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Vo(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function zo(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(Yn=eo.prototype).Oa=function(e){this.M=e},Yn.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Hi.g(),this.C=this.u?zi(this.u):zi(Hi),this.g.onreadystatechange=ar(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(HE){return void io(this,HE)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=er.FormData&&e instanceof er.FormData,!(0<=hr(ro,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{lo(this),0<this.B&&((this.L=function(e){return Sr&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ar(this.ua,this)):this.A=wi(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(HE){io(this,HE)}},Yn.ua=function(){"undefined"!=typeof Zn&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,oi(this,"timeout"),this.abort(8))},Yn.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,oi(this,"complete"),oi(this,"abort"),ao(this))},Yn.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ao(this,!0)),eo.$.N.call(this)},Yn.La=function(){this.s||(this.G||this.v||this.l?oo(this):this.kb())},Yn.kb=function(){oo(this)},Yn.isActive=function(){return!!this.g},Yn.da=function(){try{return 2<co(this)?this.g.status:-1}catch(e){return-1}},Yn.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},Yn.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Zs(t)}},Yn.Ia=function(){return this.m},Yn.Sa=function(){return"string"===typeof this.j?this.j:String(this.j)},(Yn=go.prototype).ra=8,Yn.H=1,Yn.Na=function(e){if(this.m)if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;const i=new Qi(this,this.l,e);let s=this.s;if(this.U&&(s?(s=Vr(s),Br(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.j.length;n++){var r=this.j[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.j.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=ko(this,i,t),ys(n=ps(this.I),"RID",e),ys(n,"CVER",22),this.F&&ys(n,"X-HTTP-Session-Id",this.F),wo(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(ho(s)))+"&"+t:this.o&&fo(n,this.o,s)),qs(this.i,i),this.bb&&ys(n,"TYPE","init"),this.P?(ys(n,"$req",t),ys(n,"SID","null"),i.aa=!0,es(i,n,null)):es(i,n,t),this.H=2}}else 3==this.H&&(e?bo(this,e):0==this.j.length||Ms(this.i)||bo(this))},Yn.Ma=function(){if(this.u=null,To(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var e=2*this.S;this.l.info("BP detection timer enabled: "+e),this.B=ji(ar(this.jb,this),e)}},Yn.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Fi(10),vo(this),To(this))},Yn.ib=function(){null!=this.v&&(this.v=null,vo(this),Eo(this),Fi(19))},Yn.pb=function(e){e?(this.l.info("Successfully pinged google.com"),Fi(2)):(this.l.info("Failed to ping google.com"),Fi(1))},Yn.isActive=function(){return!!this.h&&this.h.isActive(this)},(Yn=Do.prototype).Ba=function(){},Yn.Aa=function(){},Yn.za=function(){},Yn.ya=function(){},Yn.isActive=function(){return!0},Yn.Va=function(){},Lo.prototype.g=function(e,t){return new Fo(e,t)},cr(Fo,si),Fo.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var e=this.g,t=this.l,n=this.h||void 0;Fi(0),e.Y=t,e.na=n||{},e.G=e.aa,e.I=Ao(e,null,e.Y),_o(e)},Fo.prototype.close=function(){mo(this.g)},Fo.prototype.u=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=li(e),e=n);t.j.push(new Ds(t.fb++,e)),3==t.H&&_o(t)},Fo.prototype.N=function(){this.g.h=null,delete this.j,mo(this.g),delete this.g,Fo.$.N.call(this)},cr(Mo,Gi),cr(jo,$i),cr(Uo,Do),Uo.prototype.Ba=function(){oi(this.g,"a")},Uo.prototype.Aa=function(e){oi(this.g,new Mo(e))},Uo.prototype.za=function(e){oi(this.g,new jo)},Uo.prototype.ya=function(){oi(this.g,"b")},cr(qo,(function(){this.blockSize=-1})),qo.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},qo.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)Vo(this,e,s),s+=this.blockSize;if("string"===typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){Vo(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){Vo(this,r),i=0;break}}this.h=i,this.i+=t},qo.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var Bo={};function Ho(e){return-128<=e&&128>e?function(e,t){var n=Bo;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new zo([0|e],0>e?-1:0)})):new zo([0|e],0>e?-1:0)}function Wo(e){if(isNaN(e)||!isFinite(e))return $o;if(0>e)return Xo(Wo(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=Go;return new zo(t,0)}var Go=4294967296,$o=Ho(0),Ko=Ho(1),Qo=Ho(16777216);function Yo(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function Jo(e){return-1==e.h}function Xo(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new zo(n,~e.h).add(Ko)}function Zo(e,t){return e.add(Xo(t))}function ea(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function ta(e,t){this.g=e,this.h=t}function na(e,t){if(Yo(t))throw Error("division by zero");if(Yo(e))return new ta($o,$o);if(Jo(e))return t=na(Xo(e),t),new ta(Xo(t.g),Xo(t.h));if(Jo(t))return t=na(e,Xo(t)),new ta(Xo(t.g),t.h);if(30<e.g.length){if(Jo(e)||Jo(t))throw Error("slowDivide_ only works with positive integers.");for(var n=Ko,r=t;0>=r.X(e);)n=ra(n),r=ra(r);var i=ia(n,1),s=ia(r,1);for(r=ia(r,2),n=ia(n,2);!Yo(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=ia(r,1),n=ia(n,1)}return t=Zo(e,i.R(t)),new ta(i,t)}for(i=$o;0<=e.X(t);){for(n=Math.max(1,Math.floor(e.ea()/t.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Wo(n)).R(t);Jo(o)||0<o.X(e);)o=(s=Wo(n-=r)).R(t);Yo(s)&&(s=Ko),i=i.add(s),e=Zo(e,o)}return new ta(i,e)}function ra(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new zo(n,e.h)}function ia(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new zo(i,e.h)}(Yn=zo.prototype).ea=function(){if(Jo(this))return-Xo(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:Go+r)*t,t*=Go}return e},Yn.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(Yo(this))return"0";if(Jo(this))return"-"+Xo(this).toString(e);for(var t=Wo(Math.pow(e,6)),n=this,r="";;){var i=na(n,t).g,s=((0<(n=Zo(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(Yo(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Yn.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},Yn.X=function(e){return Jo(e=Zo(this,e))?-1:Yo(e)?0:1},Yn.abs=function(){return Jo(this)?Xo(this):this},Yn.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new zo(n,-2147483648&n[n.length-1]?-1:0)},Yn.R=function(e){if(Yo(this)||Yo(e))return $o;if(Jo(this))return Jo(e)?Xo(this).R(Xo(e)):Xo(Xo(this).R(e));if(Jo(e))return Xo(this.R(Xo(e)));if(0>this.X(Qo)&&0>e.X(Qo))return Wo(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=o*l,ea(n,2*r+2*i),n[2*r+2*i+1]+=s*l,ea(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,ea(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,ea(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new zo(n,0)},Yn.gb=function(e){return na(this,e).h},Yn.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new zo(n,this.h&e.h)},Yn.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new zo(n,this.h|e.h)},Yn.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new zo(n,this.h^e.h)},Lo.prototype.createWebChannel=Lo.prototype.g,Fo.prototype.send=Fo.prototype.u,Fo.prototype.open=Fo.prototype.m,Fo.prototype.close=Fo.prototype.close,Ui.NO_ERROR=0,Ui.TIMEOUT=8,Ui.HTTP_ERROR=6,qi.COMPLETE="complete",Bi.EventType=Wi,Wi.OPEN="a",Wi.CLOSE="b",Wi.ERROR="c",Wi.MESSAGE="d",si.prototype.listen=si.prototype.O,eo.prototype.listenOnce=eo.prototype.P,eo.prototype.getLastError=eo.prototype.Sa,eo.prototype.getLastErrorCode=eo.prototype.Ia,eo.prototype.getStatus=eo.prototype.da,eo.prototype.getResponseJson=eo.prototype.Wa,eo.prototype.getResponseText=eo.prototype.ja,eo.prototype.send=eo.prototype.ha,eo.prototype.setWithCredentials=eo.prototype.Oa,qo.prototype.digest=qo.prototype.l,qo.prototype.reset=qo.prototype.reset,qo.prototype.update=qo.prototype.j,zo.prototype.add=zo.prototype.add,zo.prototype.multiply=zo.prototype.R,zo.prototype.modulo=zo.prototype.gb,zo.prototype.compare=zo.prototype.X,zo.prototype.toNumber=zo.prototype.ea,zo.prototype.toString=zo.prototype.toString,zo.prototype.getBits=zo.prototype.D,zo.fromNumber=Wo,zo.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return Xo(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Wo(Math.pow(n,8)),i=$o,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=Wo(Math.pow(n,o)),i=i.R(o).add(Wo(a))):i=(i=i.R(r)).add(Wo(a))}return i};var sa=Xn.createWebChannelTransport=function(){return new Lo},oa=Xn.getStatEventTarget=function(){return Ai()},aa=Xn.ErrorCode=Ui,la=Xn.EventType=qi,ca=Xn.Event=Ni,ua=Xn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},ha=Xn.FetchXmlHttpFactory=$s,da=Xn.WebChannel=Bi,fa=Xn.XhrIo=eo,pa=Xn.Md5=qo,ga=Xn.Integer=zo;const ma="@firebase/firestore";class va{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}va.UNAUTHENTICATED=new va(null),va.GOOGLE_CREDENTIALS=new va("google-credentials-uid"),va.FIRST_PARTY=new va("first-party-uid"),va.MOCK_USER=new va("mock-user");let ya="10.11.1";const _a=new Nt("@firebase/firestore");function ba(){return _a.logLevel}function wa(e){if(_a.logLevel<=Ct.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ea);_a.debug("Firestore (".concat(ya,"): ").concat(e),...i)}}function ka(e){if(_a.logLevel<=Ct.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ea);_a.error("Firestore (".concat(ya,"): ").concat(e),...i)}}function Sa(e){if(_a.logLevel<=Ct.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(Ea);_a.warn("Firestore (".concat(ya,"): ").concat(e),...i)}}function Ea(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(OE){return e}}function Ca(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(ya,") INTERNAL ASSERTION FAILED: ")+e;throw ka(t),new Error(t)}function Ta(e,t){e||Ca()}function Ia(e,t){return e}const xa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ra extends Ze{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class Na{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Pa{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class Aa{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(va.UNAUTHENTICATED)))}shutdown(){}}class Oa{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Da{constructor(e){this.t=e,this.currentUser=va.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Na;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Na,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{wa("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(wa("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Na)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(wa("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Ta("string"==typeof t.accessToken),new Pa(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Ta(null===e||"string"==typeof e),new va(e)}}class La{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=va.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class Fa{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new La(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(va.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ma{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ja{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&wa("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,wa("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{wa("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):wa("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(Ta("string"==typeof e.token),this.R=e.token,new Ma(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Ua(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class qa{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=Ua(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function Va(e,t){return e<t?-1:e>t?1:0}function za(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Ba{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ra(xa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ra(xa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ra(xa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ra(xa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ba.fromMillis(Date.now())}static fromDate(e){return Ba.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Ba(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Va(this.nanoseconds,e.nanoseconds):Va(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ha{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ha(e)}static min(){return new Ha(new Ba(0,0))}static max(){return new Ha(new Ba(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Wa{constructor(e,t,n){void 0===t?t=0:t>e.length&&Ca(),void 0===n?n=e.length-t:n>e.length-t&&Ca(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Wa.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Wa?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ga extends Wa{construct(e,t,n){return new Ga(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new Ra(xa.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter((e=>e.length>0)))}return new Ga(e)}static emptyPath(){return new Ga([])}}const $a=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ka extends Wa{construct(e,t,n){return new Ka(e,t,n)}static isValidIdentifier(e){return $a.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ka.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ka(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Ra(xa.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Ra(xa.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ra(xa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Ra(xa.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ka(t)}static emptyPath(){return new Ka([])}}class Qa{constructor(e){this.path=e}static fromPath(e){return new Qa(Ga.fromString(e))}static fromName(e){return new Qa(Ga.fromString(e).popFirst(5))}static empty(){return new Qa(Ga.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ga.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ga.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Qa(new Ga(e.slice()))}}class Ya{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Ya.UNKNOWN_ID=-1;function Ja(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Ha.fromTimestamp(1e9===r?new Ba(n+1,0):new Ba(n,r));return new Za(i,Qa.empty(),t)}function Xa(e){return new Za(e.readTime,e.key,-1)}class Za{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Za(Ha.min(),Qa.empty(),-1)}static max(){return new Za(Ha.max(),Qa.empty(),-1)}}function el(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Qa.comparator(e.documentKey,t.documentKey),0!==n?n:Va(e.largestBatchId,t.largestBatchId))}const tl="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nl{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function rl(e){if(e.code!==xa.FAILED_PRECONDITION||e.message!==tl)throw e;wa("LocalStore","Unexpectedly lost primary lease")}class il{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ca(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new il(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof il?t:il.resolve(t)}catch(e){return il.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):il.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):il.reject(t)}static resolve(e){return new il(((t,n)=>{t(e)}))}static reject(e){return new il(((t,n)=>{n(e)}))}static waitFor(e){return new il(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=il.resolve(!1);for(const n of e)t=t.next((e=>e?il.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new il(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new il(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function sl(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ol(e){return"IndexedDbTransactionError"===e.name}class al{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function ll(e){return null==e}function cl(e){return 0===e&&1/e==-1/0}function ul(e){return"number"==typeof e&&Number.isInteger(e)&&!cl(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}al.oe=-1;const hl=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],dl=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fl=dl;function pl(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function gl(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ml(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class vl{constructor(e,t){this.comparator=e,this.root=t||_l.EMPTY}insert(e,t){return new vl(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,_l.BLACK,null,null))}remove(e){return new vl(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_l.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yl(this.root,e,this.comparator,!1)}getReverseIterator(){return new yl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yl(this.root,e,this.comparator,!0)}}class yl{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _l{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:_l.RED,this.left=null!=r?r:_l.EMPTY,this.right=null!=i?i:_l.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new _l(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return _l.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return _l.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_l.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_l.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ca();if(this.right.isRed())throw Ca();const e=this.left.check();if(e!==this.right.check())throw Ca();return e+(this.isRed()?0:1)}}_l.EMPTY=null,_l.RED=!0,_l.BLACK=!1,_l.EMPTY=new class{constructor(){this.size=0}get key(){throw Ca()}get value(){throw Ca()}get color(){throw Ca()}get left(){throw Ca()}get right(){throw Ca()}copy(e,t,n,r,i){return this}insert(e,t,n){return new _l(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class bl{constructor(e){this.comparator=e,this.data=new vl(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wl(this.data.getIterator())}getIteratorFrom(e){return new wl(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof bl))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new bl(this.comparator);return t.data=e,t}}class wl{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class kl{constructor(e){this.fields=e,e.sort(Ka.comparator)}static empty(){return new kl([])}unionWith(e){let t=new bl(Ka.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new kl(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return za(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Sl extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class El{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Sl("Invalid base64 string: "+e):e}}(e);return new El(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new El(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Va(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}El.EMPTY_BYTE_STRING=new El("");const Cl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Tl(e){if(Ta(!!e),"string"==typeof e){let t=0;const n=Cl.exec(e);if(Ta(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Il(e.seconds),nanos:Il(e.nanos)}}function Il(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function xl(e){return"string"==typeof e?El.fromBase64String(e):El.fromUint8Array(e)}function Rl(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Nl(e){const t=e.mapValue.fields.__previous_value__;return Rl(t)?Nl(t):t}function Pl(e){const t=Tl(e.mapValue.fields.__local_write_time__.timestampValue);return new Ba(t.seconds,t.nanos)}class Al{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class Ol{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Ol("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Ol&&e.projectId===this.projectId&&e.database===this.database}}const Dl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ll(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Rl(e)?4:Ql(e)?9007199254740991:10:Ca()}function Fl(e,t){if(e===t)return!0;const n=Ll(e);if(n!==Ll(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Pl(e).isEqual(Pl(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Tl(e.timestampValue),r=Tl(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return xl(e.bytesValue).isEqual(xl(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Il(e.geoPointValue.latitude)===Il(t.geoPointValue.latitude)&&Il(e.geoPointValue.longitude)===Il(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Il(e.integerValue)===Il(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Il(e.doubleValue),r=Il(t.doubleValue);return n===r?cl(n)===cl(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return za(e.arrayValue.values||[],t.arrayValue.values||[],Fl);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(pl(n)!==pl(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Fl(n[i],r[i])))return!1;return!0}(e,t);default:return Ca()}}function Ml(e,t){return void 0!==(e.values||[]).find((e=>Fl(e,t)))}function jl(e,t){if(e===t)return 0;const n=Ll(e),r=Ll(t);if(n!==r)return Va(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Va(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Il(e.integerValue||e.doubleValue),r=Il(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Ul(e.timestampValue,t.timestampValue);case 4:return Ul(Pl(e),Pl(t));case 5:return Va(e.stringValue,t.stringValue);case 6:return function(e,t){const n=xl(e),r=xl(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=Va(n[i],r[i]);if(0!==e)return e}return Va(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Va(Il(e.latitude),Il(t.latitude));return 0!==n?n:Va(Il(e.longitude),Il(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=jl(n[i],r[i]);if(e)return e}return Va(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Dl.mapValue&&t===Dl.mapValue)return 0;if(e===Dl.mapValue)return 1;if(t===Dl.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Va(r[o],s[o]);if(0!==e)return e;const t=jl(n[r[o]],i[s[o]]);if(0!==t)return t}return Va(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Ca()}}function Ul(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Va(e,t);const n=Tl(e),r=Tl(t),i=Va(n.seconds,r.seconds);return 0!==i?i:Va(n.nanos,r.nanos)}function ql(e){return Vl(e)}function Vl(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Tl(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return xl(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Qa.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Vl(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Vl(e.fields[i]));return n+"}"}(e.mapValue):Ca()}function zl(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Bl(e){return!!e&&"integerValue"in e}function Hl(e){return!!e&&"arrayValue"in e}function Wl(e){return!!e&&"nullValue"in e}function Gl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $l(e){return!!e&&"mapValue"in e}function Kl(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return gl(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Kl(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Kl(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ql(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Yl{constructor(e){this.value=e}static empty(){return new Yl({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$l(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kl(t)}setAll(e){let t=Ka.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Kl(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());$l(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Fl(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];$l(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){gl(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new Yl(Kl(this.value))}}function Jl(e){const t=[];return gl(e.fields,((e,n)=>{const r=new Ka([e]);if($l(n)){const e=Jl(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new kl(t)}class Xl{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Xl(e,0,Ha.min(),Ha.min(),Ha.min(),Yl.empty(),0)}static newFoundDocument(e,t,n,r){return new Xl(e,1,t,Ha.min(),n,r,0)}static newNoDocument(e,t){return new Xl(e,2,t,Ha.min(),Ha.min(),Yl.empty(),0)}static newUnknownDocument(e,t){return new Xl(e,3,t,Ha.min(),Ha.min(),Yl.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ha.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yl.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yl.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ha.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Xl&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Xl(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class Zl{constructor(e,t){this.position=e,this.inclusive=t}}function ec(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Qa.comparator(Qa.fromName(o.referenceValue),n.key):jl(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function tc(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Fl(e.position[n],t.position[n]))return!1;return!0}class nc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function rc(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ic{}class sc extends ic{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new fc(e,t,n):"array-contains"===t?new vc(e,n):"in"===t?new yc(e,n):"not-in"===t?new _c(e,n):"array-contains-any"===t?new bc(e,n):new sc(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new pc(e,n):new gc(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(jl(t,this.value)):null!==t&&Ll(this.value)===Ll(t)&&this.matchesComparison(jl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Ca()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class oc extends ic{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new oc(e,t)}matches(e){return ac(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ac(e){return"and"===e.op}function lc(e){return cc(e)&&ac(e)}function cc(e){for(const t of e.filters)if(t instanceof oc)return!1;return!0}function uc(e){if(e instanceof sc)return e.field.canonicalString()+e.op.toString()+ql(e.value);if(lc(e))return e.filters.map((e=>uc(e))).join(",");{const t=e.filters.map((e=>uc(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function hc(e,t){return e instanceof sc?function(e,t){return t instanceof sc&&e.op===t.op&&e.field.isEqual(t.field)&&Fl(e.value,t.value)}(e,t):e instanceof oc?function(e,t){return t instanceof oc&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&hc(n,t.filters[r])),!0)}(e,t):void Ca()}function dc(e){return e instanceof sc?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(ql(e.value))}(e):e instanceof oc?function(e){return e.op.toString()+" {"+e.getFilters().map(dc).join(" ,")+"}"}(e):"Filter"}class fc extends sc{constructor(e,t,n){super(e,t,n),this.key=Qa.fromName(n.referenceValue)}matches(e){const t=Qa.comparator(e.key,this.key);return this.matchesComparison(t)}}class pc extends sc{constructor(e,t){super(e,"in",t),this.keys=mc("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class gc extends sc{constructor(e,t){super(e,"not-in",t),this.keys=mc("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function mc(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Qa.fromName(e.referenceValue)))}class vc extends sc{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hl(t)&&Ml(t.arrayValue,this.value)}}class yc extends sc{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ml(this.value.arrayValue,t)}}class _c extends sc{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ml(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ml(this.value.arrayValue,t)}}class bc extends sc{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hl(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ml(this.value.arrayValue,e)))}}class wc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ue=null}}function kc(e){return new wc(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Sc(e){const t=Ia(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>uc(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),ll(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>ql(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>ql(e))).join(",")),t.ue=e}return t.ue}function Ec(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!rc(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!hc(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!tc(e.startAt,t.startAt)&&tc(e.endAt,t.endAt)}function Cc(e){return Qa.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Tc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Ic(e,t,n,r,i,s,o,a){return new Tc(e,t,n,r,i,s,o,a)}function xc(e){return new Tc(e)}function Rc(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Nc(e){return null!==e.collectionGroup}function Pc(e){const t=Ia(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new bl(Ka.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new nc(r,n))})),e.has(Ka.keyField().canonicalString())||t.ce.push(new nc(Ka.keyField(),n))}return t.ce}function Ac(e){const t=Ia(e);return t.le||(t.le=Oc(t,Pc(e))),t.le}function Oc(e,t){if("F"===e.limitType)return kc(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new nc(e.field,t)}));const n=e.endAt?new Zl(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Zl(e.startAt.position,e.startAt.inclusive):null;return kc(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Dc(e,t){const n=e.filters.concat([t]);return new Tc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Lc(e,t,n){return new Tc(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Fc(e,t){return Ec(Ac(e),Ac(t))&&e.limitType===t.limitType}function Mc(e){return"".concat(Sc(Ac(e)),"|lt:").concat(e.limitType)}function jc(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>dc(e))).join(", "),"]")),ll(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>ql(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>ql(e))).join(",")),"Target(".concat(t,")")}(Ac(e)),"; limitType=").concat(e.limitType,")")}function Uc(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Qa.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Pc(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=ec(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Pc(e),t))&&!(e.endAt&&!function(e,t,n){const r=ec(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Pc(e),t))}(e,t)}function qc(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Vc(e){return(t,n)=>{let r=!1;for(const i of Pc(e)){const e=zc(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function zc(e,t,n){const r=e.field.isKeyField()?Qa.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?jl(r,i):Ca()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Ca()}}class Bc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){gl(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return ml(this.inner)}size(){return this.innerSize}}const Hc=new vl(Qa.comparator);function Wc(){return Hc}const Gc=new vl(Qa.comparator);function $c(){let e=Gc;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Kc(e){let t=Gc;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Qc(){return Jc()}function Yc(){return Jc()}function Jc(){return new Bc((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Xc=new vl(Qa.comparator),Zc=new bl(Qa.comparator);function eu(){let e=Zc;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const tu=new bl(Va);function nu(){return tu}function ru(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:cl(t)?"-0":t}}function iu(e){return{integerValue:""+e}}function su(e,t){return ul(t)?iu(t):ru(e,t)}class ou{constructor(){this._=void 0}}function au(e,t,n){return e instanceof uu?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Rl(t)&&(t=Nl(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof hu?du(e,t):e instanceof fu?pu(e,t):function(e,t){const n=cu(e,t),r=mu(n)+mu(e.Pe);return Bl(n)&&Bl(e.Pe)?iu(r):ru(e.serializer,r)}(e,t)}function lu(e,t,n){return e instanceof hu?du(e,t):e instanceof fu?pu(e,t):n}function cu(e,t){return e instanceof gu?function(e){return Bl(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class uu extends ou{}class hu extends ou{constructor(e){super(),this.elements=e}}function du(e,t){const n=vu(t);for(const r of e.elements)n.some((e=>Fl(e,r)))||n.push(r);return{arrayValue:{values:n}}}class fu extends ou{constructor(e){super(),this.elements=e}}function pu(e,t){let n=vu(t);for(const r of e.elements)n=n.filter((e=>!Fl(e,r)));return{arrayValue:{values:n}}}class gu extends ou{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function mu(e){return Il(e.integerValue||e.doubleValue)}function vu(e){return Hl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class yu{constructor(e,t){this.version=e,this.transformResults=t}}class _u{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new _u}static exists(e){return new _u(void 0,e)}static updateTime(e){return new _u(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function bu(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class wu{}function ku(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Au(e.key,_u.none()):new Iu(e.key,e.data,_u.none());{const n=e.data,r=Yl.empty();let i=new bl(Ka.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new xu(e.key,r,new kl(i.toArray()),_u.none())}}function Su(e,t,n){e instanceof Iu?function(e,t,n){const r=e.value.clone(),i=Nu(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof xu?function(e,t,n){if(!bu(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Nu(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Ru(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Eu(e,t,n,r){return e instanceof Iu?function(e,t,n,r){if(!bu(e.precondition,t))return n;const i=e.value.clone(),s=Pu(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof xu?function(e,t,n,r){if(!bu(e.precondition,t))return n;const i=Pu(e.fieldTransforms,r,t),s=t.data;return s.setAll(Ru(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return bu(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Cu(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=cu(r.transform,e||null);null!=i&&(null===n&&(n=Yl.empty()),n.set(r.field,i))}return n||null}function Tu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&za(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof hu&&t instanceof hu||e instanceof fu&&t instanceof fu?za(e.elements,t.elements,Fl):e instanceof gu&&t instanceof gu?Fl(e.Pe,t.Pe):e instanceof uu&&t instanceof uu}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Iu extends wu{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class xu extends wu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Ru(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Nu(e,t,n){const r=new Map;Ta(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,lu(o,a,n[i]))}return r}function Pu(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,au(e,s,t))}return r}class Au extends wu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ou extends wu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Du{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Su(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Eu(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Eu(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Yc();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=ku(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Ha.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),eu())}isEqual(e){return this.batchId===e.batchId&&za(this.mutations,e.mutations,((e,t)=>Tu(e,t)))&&za(this.baseMutations,e.baseMutations,((e,t)=>Tu(e,t)))}}class Lu{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Ta(e.mutations.length===n.length);let r=Xc;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Lu(e,t,n,r)}}class Fu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Mu{constructor(e,t){this.count=e,this.unchangedNames=t}}var ju,Uu;function qu(e){switch(e){default:return Ca();case xa.CANCELLED:case xa.UNKNOWN:case xa.DEADLINE_EXCEEDED:case xa.RESOURCE_EXHAUSTED:case xa.INTERNAL:case xa.UNAVAILABLE:case xa.UNAUTHENTICATED:return!1;case xa.INVALID_ARGUMENT:case xa.NOT_FOUND:case xa.ALREADY_EXISTS:case xa.PERMISSION_DENIED:case xa.FAILED_PRECONDITION:case xa.ABORTED:case xa.OUT_OF_RANGE:case xa.UNIMPLEMENTED:case xa.DATA_LOSS:return!0}}function Vu(e){if(void 0===e)return ka("GRPC error has no .code"),xa.UNKNOWN;switch(e){case ju.OK:return xa.OK;case ju.CANCELLED:return xa.CANCELLED;case ju.UNKNOWN:return xa.UNKNOWN;case ju.DEADLINE_EXCEEDED:return xa.DEADLINE_EXCEEDED;case ju.RESOURCE_EXHAUSTED:return xa.RESOURCE_EXHAUSTED;case ju.INTERNAL:return xa.INTERNAL;case ju.UNAVAILABLE:return xa.UNAVAILABLE;case ju.UNAUTHENTICATED:return xa.UNAUTHENTICATED;case ju.INVALID_ARGUMENT:return xa.INVALID_ARGUMENT;case ju.NOT_FOUND:return xa.NOT_FOUND;case ju.ALREADY_EXISTS:return xa.ALREADY_EXISTS;case ju.PERMISSION_DENIED:return xa.PERMISSION_DENIED;case ju.FAILED_PRECONDITION:return xa.FAILED_PRECONDITION;case ju.ABORTED:return xa.ABORTED;case ju.OUT_OF_RANGE:return xa.OUT_OF_RANGE;case ju.UNIMPLEMENTED:return xa.UNIMPLEMENTED;case ju.DATA_LOSS:return xa.DATA_LOSS;default:return Ca()}}(Uu=ju||(ju={}))[Uu.OK=0]="OK",Uu[Uu.CANCELLED=1]="CANCELLED",Uu[Uu.UNKNOWN=2]="UNKNOWN",Uu[Uu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Uu[Uu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Uu[Uu.NOT_FOUND=5]="NOT_FOUND",Uu[Uu.ALREADY_EXISTS=6]="ALREADY_EXISTS",Uu[Uu.PERMISSION_DENIED=7]="PERMISSION_DENIED",Uu[Uu.UNAUTHENTICATED=16]="UNAUTHENTICATED",Uu[Uu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Uu[Uu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Uu[Uu.ABORTED=10]="ABORTED",Uu[Uu.OUT_OF_RANGE=11]="OUT_OF_RANGE",Uu[Uu.UNIMPLEMENTED=12]="UNIMPLEMENTED",Uu[Uu.INTERNAL=13]="INTERNAL",Uu[Uu.UNAVAILABLE=14]="UNAVAILABLE",Uu[Uu.DATA_LOSS=15]="DATA_LOSS";let zu=null;function Bu(){return new TextEncoder}const Hu=new ga([4294967295,4294967295],0);function Wu(e){const t=Bu().encode(e),n=new pa;return n.update(t),new Uint8Array(n.digest())}function Gu(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new ga([n,r],0),new ga([i,s],0)]}class $u{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ku("Invalid padding: ".concat(t));if(n<0)throw new Ku("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new Ku("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new Ku("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=ga.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(ga.fromNumber(n)));return 1===r.compare(Hu)&&(r=new ga([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=Wu(e),[n,r]=Gu(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new $u(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ie)return;const t=Wu(e),[n,r]=Gu(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ku extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Qu{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Yu.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Qu(Ha.min(),r,new vl(Va),Wc(),eu())}}class Yu{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Yu(n,t,eu(),eu(),eu())}}class Ju{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Xu{constructor(e,t){this.targetId=e,this.me=t}}class Zu{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:El.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class eh{constructor(){this.fe=0,this.ge=rh(),this.pe=El.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=eu(),t=eu(),n=eu();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Ca()}})),new Yu(this.pe,this.ye,e,t,n)}ve(){this.we=!1,this.ge=rh()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ta(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class th{constructor(e){this.Le=e,this.Be=new Map,this.ke=Wc(),this.qe=nh(),this.Qe=new vl(Va)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.ve(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:Ca()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Cc(i))if(0===n){const e=new Qa(i.path);this.Ue(t,e,Xl.newNoDocument(e,Ha.min()))}else Ta(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==zu||zu.et(function(e,t,n,r,i){var s,o,a,l,c,u;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==d?void 0:d.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=xl(n).toUint8Array()}catch(e){if(e instanceof Sl)return Sa("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new $u(s,r,i)}catch(e){return Sa(e instanceof Ku?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Cc(i.target)){const t=new Qa(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Xl.newNoDocument(t,e))}n.be&&(t.set(r,n.Ce()),n.ve())}}));let n=eu();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new Qu(e,t,this.Qe,this.ke,n);return this.ke=Wc(),this.qe=nh(),this.Qe=new vl(Va),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new eh,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new bl(Va),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||wa("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new eh),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function nh(){return new vl(Qa.comparator)}function rh(){return new vl(Qa.comparator)}const ih={asc:"ASCENDING",desc:"DESCENDING"},sh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oh={and:"AND",or:"OR"};class ah{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function lh(e,t){return e.useProto3Json||ll(t)?t:{value:t}}function ch(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function uh(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function hh(e,t){return ch(e,t.toTimestamp())}function dh(e){return Ta(!!e),Ha.fromTimestamp(function(e){const t=Tl(e);return new Ba(t.seconds,t.nanos)}(e))}function fh(e,t){return ph(e,t).canonicalString()}function ph(e,t){const n=function(e){return new Ga(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function gh(e){const t=Ga.fromString(e);return Ta(Lh(t)),t}function mh(e,t){return fh(e.databaseId,t.path)}function vh(e,t){const n=gh(t);if(n.get(1)!==e.databaseId.projectId)throw new Ra(xa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ra(xa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Qa(wh(n))}function yh(e,t){return fh(e.databaseId,t)}function _h(e){const t=gh(e);return 4===t.length?Ga.emptyPath():wh(t)}function bh(e){return new Ga(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function wh(e){return Ta(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function kh(e,t,n){return{name:mh(e,t),fields:n.value.mapValue.fields}}function Sh(e,t){let n;if(t instanceof Iu)n={update:kh(e,t.key,t.value)};else if(t instanceof Au)n={delete:mh(e,t.key)};else if(t instanceof xu)n={update:kh(e,t.key,t.data),updateMask:Dh(t.fieldMask)};else{if(!(t instanceof Ou))return Ca();n={verify:mh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof uu)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof hu)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof fu)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof gu)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw Ca()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:hh(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Ca()}(e,t.precondition)),n}function Eh(e,t){return{documents:[yh(e,t.path)]}}function Ch(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=yh(e,i);const s=function(e){if(0!==e.length)return Oh(oc.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Ph(e.field),direction:xh(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=lh(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Th(e){let t=_h(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Ta(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ih(e);return t instanceof oc&&lc(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new nc(Ah(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,ll(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Zl(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new Zl(n,t)}(n.endAt)),Ic(t,i,o,s,a,"F",l,c)}function Ih(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ah(e.unaryFilter.field);return sc.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ah(e.unaryFilter.field);return sc.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ah(e.unaryFilter.field);return sc.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Ah(e.unaryFilter.field);return sc.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Ca()}}(e):void 0!==e.fieldFilter?function(e){return sc.create(Ah(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ca()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return oc.create(e.compositeFilter.filters.map((e=>Ih(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return Ca()}}(e.compositeFilter.op))}(e):Ca()}function xh(e){return ih[e]}function Rh(e){return sh[e]}function Nh(e){return oh[e]}function Ph(e){return{fieldPath:e.canonicalString()}}function Ah(e){return Ka.fromServerFormat(e.fieldPath)}function Oh(e){return e instanceof sc?function(e){if("=="===e.op){if(Gl(e.value))return{unaryFilter:{field:Ph(e.field),op:"IS_NAN"}};if(Wl(e.value))return{unaryFilter:{field:Ph(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Gl(e.value))return{unaryFilter:{field:Ph(e.field),op:"IS_NOT_NAN"}};if(Wl(e.value))return{unaryFilter:{field:Ph(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ph(e.field),op:Rh(e.op),value:e.value}}}(e):e instanceof oc?function(e){const t=e.getFilters().map((e=>Oh(e)));return 1===t.length?t[0]:{compositeFilter:{op:Nh(e.op),filters:t}}}(e):Ca()}function Dh(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Lh(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Fh{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ha.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ha.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:El.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Fh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Fh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Fh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Fh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Mh{constructor(e){this.ut=e}}function jh(e){const t=Th({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Lc(t,t.limit,"L"):t}class Uh{constructor(){}ht(e,t){this.Pt(e,t),t.It()}Pt(e,t){if("nullValue"in e)this.Tt(t,5);else if("booleanValue"in e)this.Tt(t,10),t.Et(e.booleanValue?1:0);else if("integerValue"in e)this.Tt(t,15),t.Et(Il(e.integerValue));else if("doubleValue"in e){const n=Il(e.doubleValue);isNaN(n)?this.Tt(t,13):(this.Tt(t,15),cl(n)?t.Et(0):t.Et(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Tt(t,20),"string"==typeof n&&(n=Tl(n)),t.dt("".concat(n.seconds||"")),t.Et(n.nanos||0)}else if("stringValue"in e)this.At(e.stringValue,t),this.Rt(t);else if("bytesValue"in e)this.Tt(t,30),t.Vt(xl(e.bytesValue)),this.Rt(t);else if("referenceValue"in e)this.ft(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Tt(t,45),t.Et(n.latitude||0),t.Et(n.longitude||0)}else"mapValue"in e?Ql(e)?this.Tt(t,Number.MAX_SAFE_INTEGER):(this.gt(e.mapValue,t),this.Rt(t)):"arrayValue"in e?(this.yt(e.arrayValue,t),this.Rt(t)):Ca()}At(e,t){this.Tt(t,25),this.wt(e,t)}wt(e,t){t.dt(e)}gt(e,t){const n=e.fields||{};this.Tt(t,55);for(const r of Object.keys(n))this.At(r,t),this.Pt(n[r],t)}yt(e,t){const n=e.values||[];this.Tt(t,50);for(const r of n)this.Pt(r,t)}ft(e,t){this.Tt(t,37),Qa.fromName(e).path.forEach((e=>{this.Tt(t,60),this.wt(e,t)}))}Tt(e,t){e.Et(t)}Rt(e){e.Et(2)}}Uh.St=new Uh;class qh{constructor(){this.on=new Vh}addToCollectionParentIndex(e,t){return this.on.add(t),il.resolve()}getCollectionParents(e,t){return il.resolve(this.on.getEntries(t))}addFieldIndex(e,t){return il.resolve()}deleteFieldIndex(e,t){return il.resolve()}deleteAllFieldIndexes(e){return il.resolve()}createTargetIndexes(e,t){return il.resolve()}getDocumentsMatchingTarget(e,t){return il.resolve(null)}getIndexType(e,t){return il.resolve(0)}getFieldIndexes(e,t){return il.resolve([])}getNextCollectionGroupToUpdate(e){return il.resolve(null)}getMinOffset(e,t){return il.resolve(Za.min())}getMinOffsetFromCollectionGroup(e,t){return il.resolve(Za.min())}updateCollectionGroup(e,t,n){return il.resolve()}updateIndexEntries(e,t){return il.resolve()}}class Vh{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new bl(Ga.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new bl(Ga.comparator)).toArray()}}new Uint8Array(0);class zh{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new zh(e,zh.DEFAULT_COLLECTION_PERCENTILE,zh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}zh.DEFAULT_COLLECTION_PERCENTILE=10,zh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,zh.DEFAULT=new zh(41943040,zh.DEFAULT_COLLECTION_PERCENTILE,zh.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),zh.DISABLED=new zh(-1,0,0);class Bh{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static On(){return new Bh(0)}static Nn(){return new Bh(-1)}}class Hh{constructor(){this.changes=new Bc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Xl.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?il.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Wh{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Gh{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Eu(n.mutation,e,kl.empty(),Ba.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,eu()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eu();const r=Qc();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=$c();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Qc();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,eu())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Wc();const s=Jc(),o=Jc();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof xu)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Eu(o.mutation,t,o.mutation.getFieldMask(),Ba.now())):s.set(t.key,kl.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Wh(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Jc();let r=new vl(((e,t)=>e-t)),i=eu();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||kl.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||eu()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=Yc();l.forEach((e=>{if(!i.has(e)){const r=ku(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return il.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Qa.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Nc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):il.resolve(Qc());let o=-1,a=i;return s.next((t=>il.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?il.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,eu()))).next((e=>({batchId:o,changes:Kc(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Qa(t)).next((e=>{let t=$c();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=$c();return this.indexManager.getCollectionParents(e,i).next((o=>il.forEach(o,(o=>{const a=function(e,t){return new Tc(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Xl.newInvalidDocument(r)))}));let n=$c();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&Eu(s.mutation,r,kl.empty(),Ba.now()),Uc(t,r)&&(n=n.insert(e,r))})),n}))}}class $h{constructor(e){this.serializer=e,this.ur=new Map,this.cr=new Map}getBundleMetadata(e,t){return il.resolve(this.ur.get(t))}saveBundleMetadata(e,t){return this.ur.set(t.id,function(e){return{id:e.id,version:e.version,createTime:dh(e.createTime)}}(t)),il.resolve()}getNamedQuery(e,t){return il.resolve(this.cr.get(t))}saveNamedQuery(e,t){return this.cr.set(t.name,function(e){return{name:e.name,query:jh(e.bundledQuery),readTime:dh(e.readTime)}}(t)),il.resolve()}}class Kh{constructor(){this.overlays=new vl(Qa.comparator),this.lr=new Map}getOverlay(e,t){return il.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Qc();return il.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.lt(e,t,r)})),il.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.lr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.lr.delete(n)),il.resolve()}getOverlaysForCollection(e,t,n){const r=Qc(),i=t.length+1,s=new Qa(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return il.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new vl(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Qc(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Qc(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return il.resolve(o)}lt(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.lr.get(r.largestBatchId).delete(n.key);this.lr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Fu(t,n));let i=this.lr.get(t);void 0===i&&(i=eu(),this.lr.set(t,i)),this.lr.set(t,i.add(n.key))}}class Qh{constructor(){this.hr=new bl(Yh.Pr),this.Ir=new bl(Yh.Tr)}isEmpty(){return this.hr.isEmpty()}addReference(e,t){const n=new Yh(e,t);this.hr=this.hr.add(n),this.Ir=this.Ir.add(n)}Er(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.dr(new Yh(e,t))}Ar(e,t){e.forEach((e=>this.removeReference(e,t)))}Rr(e){const t=new Qa(new Ga([])),n=new Yh(t,e),r=new Yh(t,e+1),i=[];return this.Ir.forEachInRange([n,r],(e=>{this.dr(e),i.push(e.key)})),i}Vr(){this.hr.forEach((e=>this.dr(e)))}dr(e){this.hr=this.hr.delete(e),this.Ir=this.Ir.delete(e)}mr(e){const t=new Qa(new Ga([])),n=new Yh(t,e),r=new Yh(t,e+1);let i=eu();return this.Ir.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Yh(e,0),n=this.hr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Yh{constructor(e,t){this.key=e,this.gr=t}static Pr(e,t){return Qa.comparator(e.key,t.key)||Va(e.gr,t.gr)}static Tr(e,t){return Va(e.gr,t.gr)||Qa.comparator(e.key,t.key)}}class Jh{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.pr=1,this.yr=new bl(Yh.Pr)}checkEmpty(e){return il.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.pr;this.pr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Du(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.yr=this.yr.add(new Yh(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return il.resolve(s)}lookupMutationBatch(e,t){return il.resolve(this.wr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.Sr(n),i=r<0?0:r;return il.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return il.resolve(0===this.mutationQueue.length?-1:this.pr-1)}getAllMutationBatches(e){return il.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Yh(t,0),r=new Yh(t,Number.POSITIVE_INFINITY),i=[];return this.yr.forEachInRange([n,r],(e=>{const t=this.wr(e.gr);i.push(t)})),il.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new bl(Va);return t.forEach((e=>{const t=new Yh(e,0),r=new Yh(e,Number.POSITIVE_INFINITY);this.yr.forEachInRange([t,r],(e=>{n=n.add(e.gr)}))})),il.resolve(this.br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Qa.isDocumentKey(i)||(i=i.child(""));const s=new Yh(new Qa(i),0);let o=new bl(Va);return this.yr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.gr)),!0)}),s),il.resolve(this.br(o))}br(e){const t=[];return e.forEach((e=>{const n=this.wr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Ta(0===this.Dr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.yr;return il.forEach(t.mutations,(r=>{const i=new Yh(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.yr=n}))}Fn(e){}containsKey(e,t){const n=new Yh(t,0),r=this.yr.firstAfterOrEqual(n);return il.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,il.resolve()}Dr(e,t){return this.Sr(e)}Sr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}wr(e){const t=this.Sr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Xh{constructor(e){this.Cr=e,this.docs=new vl(Qa.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Cr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return il.resolve(n?n.document.mutableCopy():Xl.newInvalidDocument(t))}getEntries(e,t){let n=Wc();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Xl.newInvalidDocument(e))})),il.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Wc();const s=t.path,o=new Qa(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||el(Xa(o),n)<=0||(r.has(o.key)||Uc(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return il.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Ca()}vr(e,t){return il.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Zh(this)}getSize(e){return il.resolve(this.size)}}class Zh extends Hh{constructor(e){super(),this._r=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this._r.addEntry(e,r)):this._r.removeEntry(n)})),il.waitFor(t)}getFromCache(e,t){return this._r.getEntry(e,t)}getAllFromCache(e,t){return this._r.getEntries(e,t)}}class ed{constructor(e){this.persistence=e,this.Fr=new Bc((e=>Sc(e)),Ec),this.lastRemoteSnapshotVersion=Ha.min(),this.highestTargetId=0,this.Mr=0,this.Or=new Qh,this.targetCount=0,this.Nr=Bh.On()}forEachTarget(e,t){return this.Fr.forEach(((e,n)=>t(n))),il.resolve()}getLastRemoteSnapshotVersion(e){return il.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return il.resolve(this.Mr)}allocateTargetId(e){return this.highestTargetId=this.Nr.next(),il.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Mr&&(this.Mr=t),il.resolve()}kn(e){this.Fr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Nr=new Bh(t),this.highestTargetId=t),e.sequenceNumber>this.Mr&&(this.Mr=e.sequenceNumber)}addTargetData(e,t){return this.kn(t),this.targetCount+=1,il.resolve()}updateTargetData(e,t){return this.kn(t),il.resolve()}removeTargetData(e,t){return this.Fr.delete(t.target),this.Or.Rr(t.targetId),this.targetCount-=1,il.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Fr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Fr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),il.waitFor(i).next((()=>r))}getTargetCount(e){return il.resolve(this.targetCount)}getTargetData(e,t){const n=this.Fr.get(t)||null;return il.resolve(n)}addMatchingKeys(e,t,n){return this.Or.Er(t,n),il.resolve()}removeMatchingKeys(e,t,n){this.Or.Ar(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),il.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Or.Rr(t),il.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Or.mr(t);return il.resolve(n)}containsKey(e,t){return il.resolve(this.Or.containsKey(t))}}class td{constructor(e,t){this.Lr={},this.overlays={},this.Br=new al(0),this.kr=!1,this.kr=!0,this.referenceDelegate=e(this),this.qr=new ed(this),this.indexManager=new qh,this.remoteDocumentCache=function(e){return new Xh(e)}((e=>this.referenceDelegate.Qr(e))),this.serializer=new Mh(t),this.Kr=new $h(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.kr=!1,Promise.resolve()}get started(){return this.kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Kh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Lr[e.toKey()];return n||(n=new Jh(t,this.referenceDelegate),this.Lr[e.toKey()]=n),n}getTargetCache(){return this.qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Kr}runTransaction(e,t,n){wa("MemoryPersistence","Starting transaction:",e);const r=new nd(this.Br.next());return this.referenceDelegate.$r(),n(r).next((e=>this.referenceDelegate.Ur(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Wr(e,t){return il.or(Object.values(this.Lr).map((n=>()=>n.containsKey(e,t))))}}class nd extends nl{constructor(e){super(),this.currentSequenceNumber=e}}class rd{constructor(e){this.persistence=e,this.Gr=new Qh,this.zr=null}static jr(e){return new rd(e)}get Hr(){if(this.zr)return this.zr;throw Ca()}addReference(e,t,n){return this.Gr.addReference(n,t),this.Hr.delete(n.toString()),il.resolve()}removeReference(e,t,n){return this.Gr.removeReference(n,t),this.Hr.add(n.toString()),il.resolve()}markPotentiallyOrphaned(e,t){return this.Hr.add(t.toString()),il.resolve()}removeTarget(e,t){this.Gr.Rr(t.targetId).forEach((e=>this.Hr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Hr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}$r(){this.zr=new Set}Ur(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return il.forEach(this.Hr,(n=>{const r=Qa.fromPath(n);return this.Jr(e,r).next((e=>{e||t.removeEntry(r,Ha.min())}))})).next((()=>(this.zr=null,t.apply(e))))}updateLimboDocument(e,t){return this.Jr(e,t).next((e=>{e?this.Hr.delete(t.toString()):this.Hr.add(t.toString())}))}Qr(e){return 0}Jr(e,t){return il.or([()=>il.resolve(this.Gr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Wr(e,t)])}}class id{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.ki=n,this.qi=r}static Qi(e,t){let n=eu(),r=eu();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new id(e,t.fromCache,n,r)}}class sd{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class od{constructor(){this.Ki=!1,this.$i=!1,this.Ui=100,this.Wi=Je()?8:sl($e())>0?6:4}initialize(e,t){this.Gi=e,this.indexManager=t,this.Ki=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.zi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ji(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new sd;return this.Hi(e,t,n).next((r=>{if(i.result=r,this.$i)return this.Ji(e,t,n,r.size)}))})).next((()=>i.result))}Ji(e,t,n,r){return n.documentReadCount<this.Ui?(ba()<=Ct.DEBUG&&wa("QueryEngine","SDK will not create cache indexes for query:",jc(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Ui,"documents"),il.resolve()):(ba()<=Ct.DEBUG&&wa("QueryEngine","Query:",jc(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Wi*r?(ba()<=Ct.DEBUG&&wa("QueryEngine","The SDK decides to create cache indexes for query:",jc(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ac(t))):il.resolve())}zi(e,t){if(Rc(t))return il.resolve(null);let n=Ac(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Lc(t,null,"F"),n=Ac(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=eu(...r);return this.Gi.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Yi(t,r);return this.Zi(t,s,i,n.readTime)?this.zi(e,Lc(t,null,"F")):this.Xi(e,s,t,n)}))))})))))}ji(e,t,n,r){return Rc(t)||r.isEqual(Ha.min())?il.resolve(null):this.Gi.getDocuments(e,n).next((i=>{const s=this.Yi(t,i);return this.Zi(t,s,n,r)?il.resolve(null):(ba()<=Ct.DEBUG&&wa("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),jc(t)),this.Xi(e,s,t,Ja(r,-1)).next((e=>e)))}))}Yi(e,t){let n=new bl(Vc(e));return t.forEach(((t,r)=>{Uc(e,r)&&(n=n.add(r))})),n}Zi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Hi(e,t,n){return ba()<=Ct.DEBUG&&wa("QueryEngine","Using full collection scan to execute query:",jc(t)),this.Gi.getDocumentsMatchingQuery(e,t,Za.min(),n)}Xi(e,t,n,r){return this.Gi.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class ad{constructor(e,t,n,r){this.persistence=e,this.es=t,this.serializer=r,this.ts=new vl(Va),this.ns=new Bc((e=>Sc(e)),Ec),this.rs=new Map,this.ss=e.getRemoteDocumentCache(),this.qr=e.getTargetCache(),this.Kr=e.getBundleCache(),this.os(n)}os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Gh(this.ss,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ss.setIndexManager(this.indexManager),this.es.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.ts)))}}function ld(e,t,n,r){return new ad(e,t,n,r)}async function cd(e,t){const n=Ia(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.os(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=eu();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({_s:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function ud(e){const t=Ia(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.qr.getLastRemoteSnapshotVersion(e)))}function hd(e,t,n){let r=eu(),i=eu();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Wc();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Ha.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):wa("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{us:r,cs:i}}))}function dd(e,t){const n=Ia(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function fd(e,t){const n=Ia(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.qr.getTargetData(e,t).next((i=>i?(r=i,il.resolve(r)):n.qr.allocateTargetId(e).next((i=>(r=new Fh(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.qr.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.ts.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ts=n.ts.insert(e.targetId,e),n.ns.set(t,e.targetId)),e}))}async function pd(e,t,n){const r=Ia(e),i=r.ts.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!ol(e))throw e;wa("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.ts=r.ts.remove(t),r.ns.delete(i.target)}function gd(e,t,n){const r=Ia(e);let i=Ha.min(),s=eu();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=Ia(e),i=r.ns.get(n);return void 0!==i?il.resolve(r.ts.get(i)):r.qr.getTargetData(t,n)}(r,e,Ac(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.qr.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.es.getDocumentsMatchingQuery(e,t,n?i:Ha.min(),n?s:eu()))).next((e=>(md(r,qc(t),e),{documents:e,ls:s})))))}function md(e,t,n){let r=e.rs.get(t)||Ha.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.rs.set(t,r)}class vd{constructor(){this.activeTargetIds=nu()}ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}As(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Es(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yd{constructor(){this.eo=new vd,this.no={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.eo.ds(e),this.no[e]||"not-current"}updateQueryState(e,t,n){this.no[e]=t}removeLocalQueryTarget(e){this.eo.As(e)}isLocalQueryTarget(e){return this.eo.activeTargetIds.has(e)}clearQueryState(e){delete this.no[e]}getAllActiveQueryTargets(){return this.eo.activeTargetIds}isActiveQueryTarget(e){return this.eo.activeTargetIds.has(e)}start(){return this.eo=new vd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class _d{ro(e){}shutdown(){}}class bd{constructor(){this.io=()=>this.so(),this.oo=()=>this._o(),this.ao=[],this.uo()}ro(e){this.ao.push(e)}shutdown(){window.removeEventListener("online",this.io),window.removeEventListener("offline",this.oo)}uo(){window.addEventListener("online",this.io),window.addEventListener("offline",this.oo)}so(){wa("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ao)e(0)}_o(){wa("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ao)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let wd=null;function kd(){return null===wd?wd=268435456+Math.round(2147483648*Math.random()):wd++,"0x"+wd.toString(16)}const Sd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ed{constructor(e){this.co=e.co,this.lo=e.lo}ho(e){this.Po=e}Io(e){this.To=e}Eo(e){this.Ao=e}onMessage(e){this.Ro=e}close(){this.lo()}send(e){this.co(e)}Vo(){this.Po()}mo(){this.To()}fo(e){this.Ao(e)}po(e){this.Ro(e)}}const Cd="WebChannelConnection";class Td extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.yo=t+"://"+e.host,this.wo="projects/".concat(n,"/databases/").concat(r),this.So="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get bo(){return!1}Do(e,t,n,r,i){const s=kd(),o=this.Co(e,t.toUriEncodedString());wa("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),o,n);const a={"google-cloud-resource-prefix":this.wo,"x-goog-request-params":this.So};return this.vo(a,r,i),this.Fo(e,o,a,n).then((t=>(wa("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t)),(t=>{throw Sa("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",o,"request:",n),t}))}Mo(e,t,n,r,i,s){return this.Do(e,t,n,r,i)}vo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+ya,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}Co(e,t){const n=Sd[e];return"".concat(this.yo,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Fo(e,t,n,r){const i=kd();return new Promise(((s,o)=>{const a=new fa;a.setWithCredentials(!0),a.listenOnce(la.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case aa.NO_ERROR:const t=a.getResponseJson();wa(Cd,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case aa.TIMEOUT:wa(Cd,"RPC '".concat(e,"' ").concat(i," timed out")),o(new Ra(xa.DEADLINE_EXCEEDED,"Request time out"));break;case aa.HTTP_ERROR:const n=a.getStatus();if(wa(Cd,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(xa).indexOf(t)>=0?t:xa.UNKNOWN}(t.status);o(new Ra(e,t.message))}else o(new Ra(xa.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Ra(xa.UNAVAILABLE,"Connection failed."));break;default:Ca()}}finally{wa(Cd,"RPC '".concat(e,"' ").concat(i," completed."))}}));const l=JSON.stringify(r);wa(Cd,"RPC '".concat(e,"' ").concat(i," sending request:"),r),a.send(t,"POST",l,n,15)}))}xo(e,t,n){const r=kd(),i=[this.yo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=sa(),o=oa(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.xmlHttpFactory=new ha({})),this.vo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");wa(Cd,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),a);const u=s.createWebChannel(c,a);let h=!1,d=!1;const f=new Ed({co:t=>{d?wa(Cd,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(h||(wa(Cd,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),h=!0),wa(Cd,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},lo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(u,da.EventType.OPEN,(()=>{d||(wa(Cd,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),f.Vo())})),p(u,da.EventType.CLOSE,(()=>{d||(d=!0,wa(Cd,"RPC '".concat(e,"' stream ").concat(r," transport closed")),f.fo())})),p(u,da.EventType.ERROR,(t=>{d||(d=!0,Sa(Cd,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),f.fo(new Ra(xa.UNAVAILABLE,"The operation could not be completed")))})),p(u,da.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];Ta(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){wa(Cd,"RPC '".concat(e,"' stream ").concat(r," received error:"),o);const t=o.status;let n=function(e){const t=ju[e];if(void 0!==t)return Vu(t)}(t),i=o.message;void 0===n&&(n=xa.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.fo(new Ra(n,i)),u.close()}else wa(Cd,"RPC '".concat(e,"' stream ").concat(r," received:"),i),f.po(i)}})),p(o,ca.STAT_EVENT,(t=>{t.stat===ua.PROXY?wa(Cd,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===ua.NOPROXY&&wa(Cd,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{f.mo()}),0),f}}function Id(){return"undefined"!=typeof document?document:null}function xd(e){return new ah(e,!0)}class Rd{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.si=e,this.timerId=t,this.Oo=n,this.No=r,this.Lo=i,this.Bo=0,this.ko=null,this.qo=Date.now(),this.reset()}reset(){this.Bo=0}Qo(){this.Bo=this.Lo}Ko(e){this.cancel();const t=Math.floor(this.Bo+this.$o()),n=Math.max(0,Date.now()-this.qo),r=Math.max(0,t-n);r>0&&wa("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Bo," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.ko=this.si.enqueueAfterDelay(this.timerId,r,(()=>(this.qo=Date.now(),e()))),this.Bo*=this.No,this.Bo<this.Oo&&(this.Bo=this.Oo),this.Bo>this.Lo&&(this.Bo=this.Lo)}Uo(){null!==this.ko&&(this.ko.skipDelay(),this.ko=null)}cancel(){null!==this.ko&&(this.ko.cancel(),this.ko=null)}$o(){return(Math.random()-.5)*this.Bo}}class Nd{constructor(e,t,n,r,i,s,o,a){this.si=e,this.Wo=n,this.Go=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.zo=0,this.jo=null,this.Ho=null,this.stream=null,this.Jo=new Rd(e,t)}Yo(){return 1===this.state||5===this.state||this.Zo()}Zo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Xo()}async stop(){this.Yo()&&await this.close(0)}e_(){this.state=0,this.Jo.reset()}t_(){this.Zo()&&null===this.jo&&(this.jo=this.si.enqueueAfterDelay(this.Wo,6e4,(()=>this.n_())))}r_(e){this.i_(),this.stream.send(e)}async n_(){if(this.Zo())return this.close(0)}i_(){this.jo&&(this.jo.cancel(),this.jo=null)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}async close(e,t){this.i_(),this.s_(),this.Jo.cancel(),this.zo++,4!==e?this.Jo.reset():t&&t.code===xa.RESOURCE_EXHAUSTED?(ka(t.toString()),ka("Using maximum backoff delay to prevent overloading the backend."),this.Jo.Qo()):t&&t.code===xa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.o_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Eo(t)}o_(){}auth(){this.state=1;const e=this.__(this.zo),t=this.zo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.zo===t&&this.a_(n,r)}),(t=>{e((()=>{const e=new Ra(xa.UNKNOWN,"Fetching auth token failed: "+t.message);return this.u_(e)}))}))}a_(e,t){const n=this.__(this.zo);this.stream=this.c_(e,t),this.stream.ho((()=>{n((()=>this.listener.ho()))})),this.stream.Io((()=>{n((()=>(this.state=2,this.Ho=this.si.enqueueAfterDelay(this.Go,1e4,(()=>(this.Zo()&&(this.state=3),Promise.resolve()))),this.listener.Io())))})),this.stream.Eo((e=>{n((()=>this.u_(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Xo(){this.state=5,this.Jo.Ko((async()=>{this.state=0,this.start()}))}u_(e){return wa("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}__(e){return t=>{this.si.enqueueAndForget((()=>this.zo===e?t():(wa("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Pd extends Nd{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}c_(e,t){return this.connection.xo("Listen",e,t)}onMessage(e){this.Jo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Ca()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(Ta(void 0===t||"string"==typeof t),El.fromBase64String(t||"")):(Ta(void 0===t||t instanceof Buffer||t instanceof Uint8Array),El.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?xa.UNKNOWN:Vu(e.code);return new Ra(t,e.message||"")}(o);n=new Zu(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=vh(e,r.document.name),s=dh(r.document.updateTime),o=r.document.createTime?dh(r.document.createTime):Ha.min(),a=new Yl({mapValue:{fields:r.document.fields}}),l=Xl.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Ju(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=vh(e,r.document),s=r.readTime?dh(r.readTime):Ha.min(),o=Xl.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ju([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=vh(e,r.document),s=r.removedTargetIds||[];n=new Ju([],s,i,null)}else{if(!("filter"in t))return Ca();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Mu(r,i),o=e.targetId;n=new Xu(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ha.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ha.min():t.readTime?dh(t.readTime):Ha.min()}(e);return this.listener.l_(t,n)}h_(e){const t={};t.database=bh(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Cc(r)?{documents:Eh(e,r)}:{query:Ch(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=uh(e,t.resumeToken);const r=lh(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ha.min())>0){n.readTime=ch(e,t.snapshotVersion.toTimestamp());const r=lh(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ca()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.r_(t)}P_(e){const t={};t.database=bh(this.serializer),t.removeTarget=e,this.r_(t)}}class Ad extends Nd{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.I_=!1}get T_(){return this.I_}start(){this.I_=!1,this.lastStreamToken=void 0,super.start()}o_(){this.I_&&this.E_([])}c_(e,t){return this.connection.xo("Write",e,t)}onMessage(e){if(Ta(!!e.streamToken),this.lastStreamToken=e.streamToken,this.I_){this.Jo.reset();const t=function(e,t){return e&&e.length>0?(Ta(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?dh(e.updateTime):dh(t);return n.isEqual(Ha.min())&&(n=dh(t)),new yu(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=dh(e.commitTime);return this.listener.d_(n,t)}return Ta(!e.writeResults||0===e.writeResults.length),this.I_=!0,this.listener.A_()}R_(){const e={};e.database=bh(this.serializer),this.r_(e)}E_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Sh(this.serializer,e)))};this.r_(t)}}class Od extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.V_=!1}m_(){if(this.V_)throw new Ra(xa.FAILED_PRECONDITION,"The client has already been terminated.")}Do(e,t,n,r){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Do(e,ph(t,n),r,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===xa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ra(xa.UNKNOWN,e.toString())}))}Mo(e,t,n,r,i){return this.m_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.Mo(e,ph(t,n),r,o,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===xa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ra(xa.UNKNOWN,e.toString())}))}terminate(){this.V_=!0,this.connection.terminate()}}class Dd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){0===this.g_&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve()))))}D_(e){"Online"===this.state?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.S_("Offline")))}set(e){this.C_(),this.g_=0,"Online"===e&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.y_?(ka(t),this.y_=!1):wa("OnlineStateTracker",t)}C_(){null!==this.p_&&(this.p_.cancel(),this.p_=null)}}class Ld{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=i,this.O_.ro((e=>{n.enqueueAndForget((async()=>{Hd(this)&&(wa("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Ia(e);t.M_.add(4),await Md(t),t.N_.set("Unknown"),t.M_.delete(4),await Fd(t)}(this))}))})),this.N_=new Dd(n,r)}}async function Fd(e){if(Hd(e))for(const t of e.x_)await t(!0)}async function Md(e){for(const t of e.x_)await t(!1)}function jd(e,t){const n=Ia(e);n.F_.has(t.targetId)||(n.F_.set(t.targetId,t),Bd(n)?zd(n):uf(n).Zo()&&qd(n,t))}function Ud(e,t){const n=Ia(e),r=uf(n);n.F_.delete(t),r.Zo()&&Vd(n,t),0===n.F_.size&&(r.Zo()?r.t_():Hd(n)&&n.N_.set("Unknown"))}function qd(e,t){if(e.L_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ha.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}uf(e).h_(t)}function Vd(e,t){e.L_.xe(t),uf(e).P_(t)}function zd(e){e.L_=new th({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.F_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),uf(e).start(),e.N_.w_()}function Bd(e){return Hd(e)&&!uf(e).Yo()&&e.F_.size>0}function Hd(e){return 0===Ia(e).M_.size}function Wd(e){e.L_=void 0}async function Gd(e){e.N_.set("Online")}async function $d(e){e.F_.forEach(((t,n)=>{qd(e,t)}))}async function Kd(e,t){Wd(e),Bd(e)?(e.N_.D_(t),zd(e)):e.N_.set("Unknown")}async function Qd(e,t,n){if(e.N_.set("Online"),t instanceof Zu&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.F_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.F_.delete(r),e.L_.removeTarget(r))}(e,t)}catch(n){wa("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Yd(e,n)}else if(t instanceof Ju?e.L_.Ke(t):t instanceof Xu?e.L_.He(t):e.L_.We(t),!n.isEqual(Ha.min()))try{const t=await ud(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.L_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.F_.get(r);i&&e.F_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.F_.get(t);if(!r)return;e.F_.set(t,r.withResumeToken(El.EMPTY_BYTE_STRING,r.snapshotVersion)),Vd(e,t);const i=new Fh(r.target,t,n,r.sequenceNumber);qd(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){wa("RemoteStore","Failed to raise snapshot:",t),await Yd(e,t)}}async function Yd(e,t,n){if(!ol(t))throw t;e.M_.add(1),await Md(e),e.N_.set("Offline"),n||(n=()=>ud(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{wa("RemoteStore","Retrying IndexedDB access"),await n(),e.M_.delete(1),await Fd(e)}))}function Jd(e,t){return t().catch((n=>Yd(e,n,t)))}async function Xd(e){const t=Ia(e),n=hf(t);let r=t.v_.length>0?t.v_[t.v_.length-1].batchId:-1;for(;Zd(t);)try{const e=await dd(t.localStore,r);if(null===e){0===t.v_.length&&n.t_();break}r=e.batchId,ef(t,e)}catch(e){await Yd(t,e)}tf(t)&&nf(t)}function Zd(e){return Hd(e)&&e.v_.length<10}function ef(e,t){e.v_.push(t);const n=hf(e);n.Zo()&&n.T_&&n.E_(t.mutations)}function tf(e){return Hd(e)&&!hf(e).Yo()&&e.v_.length>0}function nf(e){hf(e).start()}async function rf(e){hf(e).R_()}async function sf(e){const t=hf(e);for(const n of e.v_)t.E_(n.mutations)}async function of(e,t,n){const r=e.v_.shift(),i=Lu.from(r,t,n);await Jd(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Xd(e)}async function af(e,t){t&&hf(e).T_&&await async function(e,t){if(function(e){return qu(e)&&e!==xa.ABORTED}(t.code)){const n=e.v_.shift();hf(e).e_(),await Jd(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Xd(e)}}(e,t),tf(e)&&nf(e)}async function lf(e,t){const n=Ia(e);n.asyncQueue.verifyOperationInProgress(),wa("RemoteStore","RemoteStore received new credentials");const r=Hd(n);n.M_.add(3),await Md(n),r&&n.N_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.M_.delete(3),await Fd(n)}async function cf(e,t){const n=Ia(e);t?(n.M_.delete(2),await Fd(n)):t||(n.M_.add(2),await Md(n),n.N_.set("Unknown"))}function uf(e){return e.B_||(e.B_=function(e,t,n){const r=Ia(e);return r.m_(),new Pd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{ho:Gd.bind(null,e),Io:$d.bind(null,e),Eo:Kd.bind(null,e),l_:Qd.bind(null,e)}),e.x_.push((async t=>{t?(e.B_.e_(),Bd(e)?zd(e):e.N_.set("Unknown")):(await e.B_.stop(),Wd(e))}))),e.B_}function hf(e){return e.k_||(e.k_=function(e,t,n){const r=Ia(e);return r.m_(),new Ad(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{ho:()=>Promise.resolve(),Io:rf.bind(null,e),Eo:af.bind(null,e),A_:sf.bind(null,e),d_:of.bind(null,e)}),e.x_.push((async t=>{t?(e.k_.e_(),await Xd(e)):(await e.k_.stop(),e.v_.length>0&&(wa("RemoteStore","Stopping write stream with ".concat(e.v_.length," pending writes")),e.v_=[]))}))),e.k_}class df{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Na,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new df(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ra(xa.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ff(e,t){if(ka("AsyncQueue","".concat(t,": ").concat(e)),ol(e))return new Ra(xa.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class pf{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Qa.comparator(t.key,n.key):(e,t)=>Qa.comparator(e.key,t.key),this.keyedMap=$c(),this.sortedSet=new vl(this.comparator)}static emptySet(e){return new pf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new pf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class gf{constructor(){this.q_=new vl(Qa.comparator)}track(e){const t=e.doc.key,n=this.q_.get(t);n?0!==e.type&&3===n.type?this.q_=this.q_.insert(t,e):3===e.type&&1!==n.type?this.q_=this.q_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.q_=this.q_.remove(t):1===e.type&&2===n.type?this.q_=this.q_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):Ca():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class mf{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new mf(e,t,pf.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class vf{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some((e=>e.G_()))}}class yf{constructor(){this.queries=new Bc((e=>Mc(e)),Fc),this.onlineState="Unknown",this.z_=new Set}}async function _f(e,t){const n=Ia(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.W_()&&t.G_()&&(r=2):(s=new vf,r=t.G_()?0:1);try{switch(r){case 0:s.K_=await n.onListen(i,!0);break;case 1:s.K_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=ff(e,"Initialization of query '".concat(jc(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.U_.push(t),t.j_(n.onlineState),s.K_&&t.H_(s.K_)&&Sf(n)}async function bf(e,t){const n=Ia(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.U_.indexOf(t);e>=0&&(s.U_.splice(e,1),0===s.U_.length?i=t.G_()?0:1:!s.W_()&&t.G_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wf(e,t){const n=Ia(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.U_)e.H_(i)&&(r=!0);t.K_=i}}r&&Sf(n)}function kf(e,t,n){const r=Ia(e),i=r.queries.get(t);if(i)for(const s of i.U_)s.onError(n);r.queries.delete(t)}function Sf(e){e.z_.forEach((e=>{e.next()}))}var Ef,Cf;(Cf=Ef||(Ef={})).J_="default",Cf.Cache="cache";class Tf{constructor(e,t,n){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=n||{}}H_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new mf(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache)return!0;if(!this.G_())return!0;const n="Offline"!==t;return(!this.options.ra||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}na(e){e=mf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Ef.Cache}}class If{constructor(e){this.key=e}}class xf{constructor(e){this.key=e}}class Rf{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=eu(),this.mutatedKeys=eu(),this.Ia=Vc(e),this.Ta=new pf(this.Ia)}get Ea(){return this.la}da(e,t){const n=t?t.Aa:new gf,r=t?t.Ta:this.Ta;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Uc(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.Ra(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.Ia(u,a)>0||l&&this.Ia(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ta:s,Aa:n,Zi:o,mutatedKeys:i}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const s=e.Aa.Q_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ca()}};return n(e)-n(t)}(e.type,t.type)||this.Ia(e.doc,t.doc))),this.Va(n),r=null!=r&&r;const o=t&&!r?this.ma():[],a=0===this.Pa.size&&this.current&&!r?1:0,l=a!==this.ha;return this.ha=a,0!==s.length||l?{snapshot:new mf(this.query,e.Ta,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),fa:o}:{fa:o}}j_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new gf,mutatedKeys:this.mutatedKeys,Zi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach((e=>this.la=this.la.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.la=this.la.delete(e))),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=eu(),this.Ta.forEach((e=>{this.ga(e.key)&&(this.Pa=this.Pa.add(e.key))}));const t=[];return e.forEach((e=>{this.Pa.has(e)||t.push(new xf(e))})),this.Pa.forEach((n=>{e.has(n)||t.push(new If(n))})),t}pa(e){this.la=e.ls,this.Pa=eu();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return mf.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,0===this.ha,this.hasCachedResults)}}class Nf{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Pf{constructor(e){this.key=e,this.wa=!1}}class Af{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Sa={},this.ba=new Bc((e=>Mc(e)),Fc),this.Da=new Map,this.Ca=new Set,this.va=new vl(Qa.comparator),this.Fa=new Map,this.Ma=new Qh,this.xa={},this.Oa=new Map,this.Na=Bh.Nn(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return!0===this.La}}async function Of(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=ep(e);let i;const s=r.ba.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.ya()):i=await Lf(r,t,n,!0),i}async function Df(e,t){const n=ep(e);await Lf(n,t,!0,!1)}async function Lf(e,t,n,r){const i=await fd(e.localStore,Ac(t)),s=i.targetId,o=n?e.sharedClientState.addLocalQueryTarget(s):"not-current";let a;return r&&(a=await Ff(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&jd(e.remoteStore,i),a}async function Ff(e,t,n,r,i){e.Ba=(t,n,r)=>async function(e,t,n,r){let i=t.view.da(n);i.Zi&&(i=await gd(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.da(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Kf(e,t.targetId,a.fa),a.snapshot}(e,t,n,r);const s=await gd(e.localStore,t,!0),o=new Rf(t,s.ls),a=o.da(s.documents),l=Yu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);Kf(e,n,c.fa);const u=new Nf(t,n,o);return e.ba.set(t,u),e.Da.has(n)?e.Da.get(n).push(t):e.Da.set(n,[t]),c.snapshot}async function Mf(e,t,n){const r=Ia(e),i=r.ba.get(t),s=r.Da.get(i.targetId);if(s.length>1)return r.Da.set(i.targetId,s.filter((e=>!Fc(e,t)))),void r.ba.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await pd(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ud(r.remoteStore,i.targetId),Gf(r,i.targetId)})).catch(rl)):(Gf(r,i.targetId),await pd(r.localStore,i.targetId,!0))}async function jf(e,t){const n=Ia(e),r=n.ba.get(t),i=n.Da.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ud(n.remoteStore,r.targetId))}async function Uf(e,t){const n=Ia(e);try{const e=await function(e,t){const n=Ia(e),r=t.snapshotVersion;let i=n.ts;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.ss.newChangeBuffer({trackRemovals:!0});i=n.ts;const o=[];t.targetChanges.forEach(((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.qr.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.qr.addMatchingKeys(e,s.addedDocuments,a))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(El.EMPTY_BYTE_STRING,Ha.min()).withLastLimboFreeSnapshotVersion(Ha.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&o.push(n.qr.updateTargetData(e,c))}));let a=Wc(),l=eu();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(hd(e,s,t.documentUpdates).next((e=>{a=e.us,l=e.cs}))),!r.isEqual(Ha.min())){const t=n.qr.getLastRemoteSnapshotVersion(e).next((t=>n.qr.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return il.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.ts=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Fa.get(t);r&&(Ta(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.wa=!0:e.modifiedDocuments.size>0?Ta(r.wa):e.removedDocuments.size>0&&(Ta(r.wa),r.wa=!1))})),await Jf(n,e,t)}catch(e){await rl(e)}}function qf(e,t,n){const r=Ia(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ba.forEach(((n,r)=>{const i=r.view.j_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Ia(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.U_)i.j_(t)&&(r=!0)})),r&&Sf(n)}(r.eventManager,t),e.length&&r.Sa.l_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Vf(e,t,n){const r=Ia(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Fa.get(t),s=i&&i.key;if(s){let e=new vl(Qa.comparator);e=e.insert(s,Xl.newNoDocument(s,Ha.min()));const n=eu().add(s),i=new Qu(Ha.min(),new Map,new vl(Va),e,n);await Uf(r,i),r.va=r.va.remove(s),r.Fa.delete(t),Yf(r)}else await pd(r.localStore,t,!1).then((()=>Gf(r,t,n))).catch(rl)}async function zf(e,t){const n=Ia(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Ia(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.ss.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=il.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);Ta(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=eu();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Wf(n,r,null),Hf(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Jf(n,e)}catch(e){await rl(e)}}async function Bf(e,t,n){const r=Ia(e);try{const e=await function(e,t){const n=Ia(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(Ta(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Wf(r,t,n),Hf(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Jf(r,e)}catch(n){await rl(n)}}function Hf(e,t){(e.Oa.get(t)||[]).forEach((e=>{e.resolve()})),e.Oa.delete(t)}function Wf(e,t,n){const r=Ia(e);let i=r.xa[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.xa[r.currentUser.toKey()]=i}}function Gf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Da.get(t))e.ba.delete(r),n&&e.Sa.ka(r,n);e.Da.delete(t),e.isPrimaryClient&&e.Ma.Rr(t).forEach((t=>{e.Ma.containsKey(t)||$f(e,t)}))}function $f(e,t){e.Ca.delete(t.path.canonicalString());const n=e.va.get(t);null!==n&&(Ud(e.remoteStore,n),e.va=e.va.remove(t),e.Fa.delete(n),Yf(e))}function Kf(e,t,n){for(const r of n)r instanceof If?(e.Ma.addReference(r.key,t),Qf(e,r)):r instanceof xf?(wa("SyncEngine","Document no longer in limbo: "+r.key),e.Ma.removeReference(r.key,t),e.Ma.containsKey(r.key)||$f(e,r.key)):Ca()}function Qf(e,t){const n=t.key,r=n.path.canonicalString();e.va.get(n)||e.Ca.has(r)||(wa("SyncEngine","New document in limbo: "+n),e.Ca.add(r),Yf(e))}function Yf(e){for(;e.Ca.size>0&&e.va.size<e.maxConcurrentLimboResolutions;){const t=e.Ca.values().next().value;e.Ca.delete(t);const n=new Qa(Ga.fromString(t)),r=e.Na.next();e.Fa.set(r,new Pf(n)),e.va=e.va.insert(n,r),jd(e.remoteStore,new Fh(Ac(xc(n.path)),r,"TargetPurposeLimboResolution",al.oe))}}async function Jf(e,t,n){const r=Ia(e),i=[],s=[],o=[];r.ba.isEmpty()||(r.ba.forEach(((e,a)=>{o.push(r.Ba(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=id.Qi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Sa.l_(i),await async function(e,t){const n=Ia(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>il.forEach(t,(t=>il.forEach(t.ki,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>il.forEach(t.qi,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!ol(e))throw e;wa("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.ts.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.ts=n.ts.insert(e,i)}}}(r.localStore,s))}async function Xf(e,t){const n=Ia(e);if(!n.currentUser.isEqual(t)){wa("SyncEngine","User change. New user:",t.toKey());const e=await cd(n.localStore,t);n.currentUser=t,function(e,t){e.Oa.forEach((e=>{e.forEach((e=>{e.reject(new Ra(xa.CANCELLED,t))}))})),e.Oa.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Jf(n,e._s)}}function Zf(e,t){const n=Ia(e),r=n.Fa.get(t);if(r&&r.wa)return eu().add(r.key);{let e=eu();const r=n.Da.get(t);if(!r)return e;for(const t of r){const r=n.ba.get(t);e=e.unionWith(r.view.Ea)}return e}}function ep(e){const t=Ia(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Uf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Zf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Vf.bind(null,t),t.Sa.l_=wf.bind(null,t.eventManager),t.Sa.ka=kf.bind(null,t.eventManager),t}function tp(e){const t=Ia(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=zf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Bf.bind(null,t),t}class np{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=xd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return ld(this.persistence,new od,e.initialUser,this.serializer)}createPersistence(e){return new td(rd.jr,this.serializer)}createSharedClientState(e){return new yd}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class rp{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>qf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xf.bind(null,this.syncEngine),await cf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new yf}createDatastore(e){const t=xd(e.databaseInfo.databaseId),n=function(e){return new Td(e)}(e.databaseInfo);return function(e,t,n,r){return new Od(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Ld(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>qf(this.syncEngine,e,0)),bd.D()?new bd:new _d)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Af(e,t,n,r,i,s);return o&&(a.La=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=Ia(e);wa("RemoteStore","RemoteStore shutting down."),t.M_.add(5),await Md(t),t.O_.shutdown(),t.N_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}class ip{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):ka("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class sp{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=va.UNAUTHENTICATED,this.clientId=qa.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{wa("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(wa("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ra(xa.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Na;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(OE){const n=ff(OE,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function op(e,t){e.asyncQueue.verifyOperationInProgress(),wa("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await cd(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function ap(e,t){e.asyncQueue.verifyOperationInProgress();const n=await cp(e);wa("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>lf(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>lf(t.remoteStore,n))),e._onlineComponents=t}function lp(e){return"FirebaseError"===e.name?e.code===xa.FAILED_PRECONDITION||e.code===xa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function cp(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){wa("FirestoreClient","Using user provided OfflineComponentProvider");try{await op(e,e._uninitializedComponentsProvider._offline)}catch(OE){const n=OE;if(!lp(n))throw n;Sa("Error using user provided cache. Falling back to memory cache: "+n),await op(e,new np)}}else wa("FirestoreClient","Using default OfflineComponentProvider"),await op(e,new np);return e._offlineComponents}async function up(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(wa("FirestoreClient","Using user provided OnlineComponentProvider"),await ap(e,e._uninitializedComponentsProvider._online)):(wa("FirestoreClient","Using default OnlineComponentProvider"),await ap(e,new rp))),e._onlineComponents}function hp(e){return up(e).then((e=>e.syncEngine))}async function dp(e){const t=await up(e),n=t.eventManager;return n.onListen=Of.bind(null,t.syncEngine),n.onUnlisten=Mf.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Df.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=jf.bind(null,t.syncEngine),n}function fp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Na;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new ip({next:s=>{t.enqueueAndForget((()=>bf(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Ra(xa.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Ra(xa.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new Tf(xc(n.path),s,{includeMetadataChanges:!0,ra:!0});return _f(e,o)}(await dp(e),e.asyncQueue,t,n,r))),r.promise}function pp(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new Na;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new ip({next:n=>{t.enqueueAndForget((()=>bf(e,o))),n.fromCache&&"server"===r.source?i.reject(new Ra(xa.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Tf(n,s,{includeMetadataChanges:!0,ra:!0});return _f(e,o)}(await dp(e),e.asyncQueue,t,n,r))),r.promise}function gp(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const mp=new Map;function vp(e,t,n){if(!n)throw new Ra(xa.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function yp(e){if(!Qa.isDocumentKey(e))throw new Ra(xa.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function _p(e){if(Qa.isDocumentKey(e))throw new Ra(xa.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function bp(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":Ca()}function wp(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ra(xa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bp(e);throw new Ra(xa.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}class kp{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new Ra(xa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ra(xa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new Ra(xa.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gp(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new Ra(xa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new Ra(xa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new Ra(xa.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sp{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ra(xa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ra(xa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kp(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Aa;switch(e.type){case"firstParty":return new Fa(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ra(xa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=mp.get(e);t&&(wa("ComponentProvider","Removing Datastore"),mp.delete(e),t.terminate())}(this),Promise.resolve()}}function Ep(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=wp(e,Sp))._getSettings(),o="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==o&&Sa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=va.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[Me(JSON.stringify({alg:"none",type:"JWT"})),Me(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Ra(xa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new va(s)}e._authCredentials=new Oa(new Pa(t,n))}}class Cp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cp(this.firestore,e,this._query)}}class Tp{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ip(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tp(this.firestore,e,this._key)}}class Ip extends Cp{constructor(e,t,n){super(e,t,xc(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tp(this.firestore,null,new Qa(e))}withConverter(e){return new Ip(this.firestore,e,this._path)}}function xp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=_t(e),vp("collection","path",t),e instanceof Sp){const n=Ga.fromString(t,...r);return _p(n),new Ip(e,null,n)}{if(!(e instanceof Tp||e instanceof Ip))throw new Ra(xa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ga.fromString(t,...r));return _p(n),new Ip(e.firestore,null,n)}}function Rp(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=_t(e),1===arguments.length&&(t=qa.newId()),vp("doc","path",t),e instanceof Sp){const n=Ga.fromString(t,...r);return yp(n),new Tp(e,null,new Qa(n))}{if(!(e instanceof Tp||e instanceof Ip))throw new Ra(xa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ga.fromString(t,...r));return yp(n),new Tp(e.firestore,e instanceof Ip?e.converter:null,new Qa(n))}}class Np{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Jo=new Rd(this,"async_queue_retry"),this.hu=()=>{const e=Id();e&&wa("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Jo.Uo()};const e=Id();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=Id();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise((()=>{}));const t=new Na;return this.Iu((()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.su.push(e),this.Tu())))}async Tu(){if(0!==this.su.length){try{await this.su[0](),this.su.shift(),this.Jo.reset()}catch(AE){if(!ol(AE))throw AE;wa("AsyncQueue","Operation failed with retryable error: "+AE)}this.su.length>0&&this.Jo.Ko((()=>this.Tu()))}}Iu(e){const t=this.iu.then((()=>(this.uu=!0,e().catch((e=>{this.au=e,this.uu=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw ka("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.uu=!1,e))))));return this.iu=t,t}enqueueAfterDelay(e,t,n){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const r=df.createAndSchedule(this,e,t,n,(e=>this.Eu(e)));return this._u.push(r),r}Pu(){this.au&&Ca()}verifyOperationInProgress(){}async du(){let e;do{e=this.iu,await e}while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then((()=>{this._u.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this._u)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.du()}))}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}class Pp extends Sp{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Np,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Op(this),this._firestoreClient.terminate()}}function Ap(e){return e._firestoreClient||Op(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Op(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Al(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,gp(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._firestoreClient=new sp(e._authCredentials,e._appCheckCredentials,e._queue,s),(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}class Dp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dp(El.fromBase64String(e))}catch(e){throw new Ra(xa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Dp(El.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Lp{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new Ra(xa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ka(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fp{constructor(e){this._methodName=e}}class Mp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ra(xa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ra(xa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Va(this._lat,e._lat)||Va(this._long,e._long)}}const jp=/^__.*__$/;class Up{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new xu(e,this.data,this.fieldMask,t,this.fieldTransforms):new Iu(e,this.data,t,this.fieldTransforms)}}class qp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new xu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Vp(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ca()}}class zp{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.mu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new zp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.wu(e),r}Su(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.gu({path:n,yu:!1});return r.mu(),r}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return rg(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(0===e.length)throw this.Du("Document fields must not be empty");if(Vp(this.fu)&&jp.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class Bp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||xd(e)}Fu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new zp({fu:e,methodName:t,vu:n,path:Ka.emptyPath(),yu:!1,Cu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hp(e){const t=e._freezeSettings(),n=xd(e._databaseId);return new Bp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Wp(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Fu(s.merge||s.mergeFields?2:0,t,n,i);Zp("Data must be an object, but it was:",o,r);const a=Jp(r,o);let l,c;if(s.merge)l=new kl(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=eg(t,r,n);if(!o.contains(i))throw new Ra(xa.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));ig(e,i)||e.push(i)}l=new kl(e),c=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=o.fieldTransforms;return new Up(new Yl(a),l,c)}class Gp extends Fp{_toFieldTransform(e){if(2!==e.fu)throw 1===e.fu?e.Du("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Du("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gp}}function $p(e,t,n,r){const i=e.Fu(1,t,n);Zp("Data must be an object, but it was:",i,r);const s=[],o=Yl.empty();gl(r,((e,r)=>{const a=ng(t,e,n);r=_t(r);const l=i.Su(a);if(r instanceof Gp)s.push(a);else{const e=Yp(r,l);null!=e&&(s.push(a),o.set(a,e))}}));const a=new kl(s);return new qp(o,a,i.fieldTransforms)}function Kp(e,t,n,r,i,s){const o=e.Fu(1,t,n),a=[eg(t,r,n)],l=[i];if(s.length%2!=0)throw new Ra(xa.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let d=0;d<s.length;d+=2)a.push(eg(t,s[d])),l.push(s[d+1]);const c=[],u=Yl.empty();for(let d=a.length-1;d>=0;--d)if(!ig(c,a[d])){const e=a[d];let t=l[d];t=_t(t);const n=o.Su(e);if(t instanceof Gp)c.push(e);else{const r=Yp(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new kl(c);return new qp(u,h,o.fieldTransforms)}function Qp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Yp(n,e.Fu(r?4:3,t))}function Yp(e,t){if(Xp(e=_t(e)))return Zp("Unsupported field value:",t,e),Jp(e,t);if(e instanceof Fp)return function(e,t){if(!Vp(t.fu))throw t.Du("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Du("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.yu&&4!==t.fu)throw t.Du("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Yp(i,t.bu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=_t(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return su(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ba.fromDate(e);return{timestampValue:ch(t.serializer,n)}}if(e instanceof Ba){const n=new Ba(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:ch(t.serializer,n)}}if(e instanceof Mp)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Dp)return{bytesValue:uh(t.serializer,e._byteString)};if(e instanceof Tp){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Du("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:fh(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Du("Unsupported field value: ".concat(bp(e)))}(e,t)}function Jp(e,t){const n={};return ml(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):gl(e,((e,r)=>{const i=Yp(r,t.pu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Xp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ba||e instanceof Mp||e instanceof Dp||e instanceof Tp||e instanceof Fp)}function Zp(e,t,n){if(!Xp(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=bp(n);throw"an object"===r?t.Du(e+" a custom object"):t.Du(e+" "+r)}}function eg(e,t,n){if((t=_t(t))instanceof Lp)return t._internalPath;if("string"==typeof t)return ng(e,t);throw rg("Field path arguments must be of type string or ",e,!1,void 0,n)}const tg=new RegExp("[~\\*/\\[\\]]");function ng(e,t,n){if(t.search(tg)>=0)throw rg("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new Lp(...t.split("."))._internalPath}catch(cr){throw rg("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function rg(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a="Function ".concat(t,"() called with invalid data");n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=" in field ".concat(r)),o&&(l+=" in document ".concat(i)),l+=")"),new Ra(xa.INVALID_ARGUMENT,a+e+l)}function ig(e,t){return e.some((e=>e.isEqual(t)))}class sg{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tp(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new og(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(ag("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class og extends sg{data(){return super.data()}}function ag(e,t){return"string"==typeof t?ng(e,t):t instanceof Lp?t._internalPath:t._delegate._internalPath}function lg(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ra(xa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class cg{}class ug extends cg{}function hg(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof cg&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof fg)).length,n=e.filter((e=>e instanceof dg)).length;if(t>1||t>0&&n>0)throw new Ra(xa.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class dg extends ug{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new dg(e,t,n)}_apply(e){const t=this._parse(e);return yg(e._query,t),new Cp(e.firestore,e.converter,Dc(e._query,t))}_parse(e){const t=Hp(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Ra(xa.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){vg(o,s);const t=[];for(const n of o)t.push(mg(r,e,n));a={arrayValue:{values:t}}}else a=mg(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||vg(o,s),a=Qp(n,t,o,"in"===s||"not-in"===s);return sc.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class fg extends cg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new fg(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:oc.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)yg(n,i),n=Dc(n,i)}(e._query,t),new Cp(e.firestore,e.converter,Dc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class pg extends ug{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new pg(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Ra(xa.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Ra(xa.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nc(t,n)}(e._query,this._field,this._direction);return new Cp(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Tc(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function gg(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=ag("orderBy",e);return pg._create(n,t)}function mg(e,t,n){if("string"==typeof(n=_t(n))){if(""===n)throw new Ra(xa.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Nc(t)&&-1!==n.indexOf("/"))throw new Ra(xa.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child(Ga.fromString(n));if(!Qa.isDocumentKey(r))throw new Ra(xa.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return zl(e,new Qa(r))}if(n instanceof Tp)return zl(e,n._key);throw new Ra(xa.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(bp(n),"."))}function vg(e,t){if(!Array.isArray(e)||0===e.length)throw new Ra(xa.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function yg(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Ra(xa.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new Ra(xa.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class _g{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Ll(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Il(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Ca()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return gl(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Mp(Il(e.latitude),Il(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Nl(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Pl(e));default:return null}}convertTimestamp(e){const t=Tl(e);return new Ba(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ga.fromString(e);Ta(Lh(n));const r=new Ol(n.get(1),n.get(3)),i=new Qa(n.popFirst(5));return r.isEqual(t)||ka("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function bg(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class wg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class kg extends sg{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Sg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(ag("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Sg extends kg{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Eg{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new wg(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Sg(this._firestore,this._userDataWriter,n.key,n,new wg(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Ra(xa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Sg(e._firestore,e._userDataWriter,n.doc.key,n.doc,new wg(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Sg(e._firestore,e._userDataWriter,t.doc.key,t.doc,new wg(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Cg(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Cg(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ca()}}function Tg(e){e=wp(e,Tp);const t=wp(e.firestore,Pp);return fp(Ap(t),e._key).then((n=>Og(t,e,n)))}class Ig extends _g{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dp(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tp(this.firestore,null,t)}}function xg(e){e=wp(e,Cp);const t=wp(e.firestore,Pp),n=Ap(t),r=new Ig(t);return lg(e._query),pp(n,e._query).then((n=>new Eg(t,r,e,n)))}function Rg(e,t,n){e=wp(e,Tp);const r=wp(e.firestore,Pp),i=bg(e.converter,t,n);return Ag(r,[Wp(Hp(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,_u.none())])}function Ng(e,t,n){e=wp(e,Tp);const r=wp(e.firestore,Pp),i=Hp(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=_t(t))||t instanceof Lp?Kp(i,"updateDoc",e._key,t,n,a):$p(i,"updateDoc",e._key,t),Ag(r,[s.toMutation(e._key,_u.exists(!0))])}function Pg(e,t){const n=wp(e.firestore,Pp),r=Rp(e),i=bg(e.converter,t);return Ag(n,[Wp(Hp(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,_u.exists(!1))]).then((()=>r))}function Ag(e,t){return function(e,t){const n=new Na;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=tp(e);try{const e=await function(e,t){const n=Ia(e),r=Ba.now(),i=t.reduce(((e,t)=>e.add(t.key)),eu());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Wc(),l=eu();return n.ss.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=Cu(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new xu(e.key,t,Jl(t.value.mapValue),_u.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:Kc(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.xa[e.currentUser.toKey()];r||(r=new vl(Va)),r=r.insert(t,n),e.xa[e.currentUser.toKey()]=r}(r,e.batchId,n),await Jf(r,e.changes),await Xd(r.remoteStore)}catch(e){const t=ff(e,"Failed to persist write");n.reject(t)}}(await hp(e),t,n))),n.promise}(Ap(e),t)}function Og(e,t,n){const r=n.docs.get(t._key),i=new Ig(e);return new kg(e,i,t._key,r,new wg(n.hasPendingWrites,n.fromCache),t.converter)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){ya=e}(Dn),Rn(new bt("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new Pp(new Da(e.getProvider("auth-internal")),new ja(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ra(xa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ol(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),Mn(ma,"4.6.1",e),Mn(ma,"4.6.1","esm2017")}();Mn("firebase","10.11.1","app");function Dg(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;function Lg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Fg=Lg,Mg=new et("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),jg=new Nt("@firebase/auth");function Ug(e){if(jg.logLevel<=Ct.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];jg.error("Auth (".concat(Dn,"): ").concat(e),...n)}}function qg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Wg(e,...n)}function Vg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Wg(e,...n)}function zg(e,t,n){const r=Object.assign(Object.assign({},Fg()),{[t]:n});return new et("auth","Firebase",r).create(t,{appName:e.name})}function Bg(e){return zg(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hg(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&qg(e,"argument-error"),zg(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function Wg(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return Mg.create(e,...n)}function Gg(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Wg(t,...r)}}function $g(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Ug(t),new Error(t)}function Kg(e,t){e||$g(t)}function Qg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Yg(){return"http:"===Jg()||"https:"===Jg()}function Jg(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Xg(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Yg()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class Zg{constructor(e,t){this.shortDelay=e,this.longDelay=t,Kg(t>e,"Short delay should be less than long delay!"),this.isMobile=Ke()||Qe()}get(){return Xg()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function em(e,t){Kg(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class tm{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void $g("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void $g("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void $g("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const nm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},rm=new Zg(3e4,6e4);function im(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function sm(e,t,n,r){return om(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=ht(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),tm.fetch()(lm(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function om(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},nm),t);try{const t=new um(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw hm(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw hm(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw hm(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw hm(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw zg(e,a,o);qg(e,a)}}catch(AE){if(AE instanceof Ze)throw AE;qg(e,"network-request-failed",{message:String(AE)})}}async function am(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await sm(e,t,n,r,i);return"mfaPendingCredential"in s&&qg(e,"multi-factor-auth-required",{_serverResponse:s}),s}function lm(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?em(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function cm(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class um{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Vg(this.auth,"network-request-failed"))),rm.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function hm(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Vg(e,t,r);return i.customData._tokenResponse=n,i}function dm(e){return void 0!==e&&void 0!==e.enterprise}class fm{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return cm(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function pm(e,t){return sm(e,"GET","/v2/recaptchaConfig",im(e,t))}async function gm(e,t){return sm(e,"POST","/v1/accounts:lookup",t)}function mm(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(AE){}}function vm(e){return 1e3*Number(e)}function ym(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Ug("JWT malformed, contained fewer than 3 sections"),null;try{const e=je(n);return e?JSON.parse(e):(Ug("Failed to decode base64 JWT payload"),null)}catch(AE){return Ug("Caught error parsing JWT payload as JSON",null===AE||void 0===AE?void 0:AE.toString()),null}}function _m(e){const t=ym(e);return Gg(t,"internal-error"),Gg("undefined"!==typeof t.exp,"internal-error"),Gg("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function bm(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(AE){throw AE instanceof Ze&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(AE)&&e.auth.currentUser===e&&await e.auth.signOut(),AE}}class wm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(AE){return void((null===AE||void 0===AE?void 0:AE.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class km{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=mm(this.lastLoginAt),this.creationTime=mm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Sm(e){var t;const n=e.auth,r=await e.getIdToken(),i=await bm(e,gm(n,{idToken:r}));Gg(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?Em(s.providerUserInfo):[],a=function(e,t){const n=e.filter((e=>!t.some((t=>t.providerId===e.providerId))));return[...n,...t]}(e.providerData,o),l=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),u=!!l&&c,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new km(s.createdAt,s.lastLoginAt),isAnonymous:u};Object.assign(e,h)}function Em(e){return e.map((e=>{var{providerId:t}=e,n=Dg(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Cm{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Gg(e.idToken,"internal-error"),Gg("undefined"!==typeof e.idToken,"internal-error"),Gg("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):_m(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Gg(0!==e.length,"internal-error");const t=_m(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Gg(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await om(e,{},(async()=>{const n=ht({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=lm(e,r,"/v1/token","key=".concat(i)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",tm.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Cm;return n&&(Gg("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Gg("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Gg("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Cm,this.toJSON())}_performRefresh(){return $g("not implemented")}}function Tm(e,t){Gg("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Im{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Dg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new wm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new km(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await bm(this,this.stsTokenManager.getToken(this.auth,e));return Gg(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=_t(e),r=await n.getIdToken(t),i=ym(r);Gg(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:mm(vm(i.auth_time)),issuedAtTime:mm(vm(i.iat)),expirationTime:mm(vm(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=_t(e);await Sm(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Gg(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Im(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Gg(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Sm(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Pn(this.auth.app))return Promise.reject(Bg(this.auth));const e=await this.getIdToken();return await bm(this,async function(e,t){return sm(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:_,isAnonymous:b,providerData:w,stsTokenManager:k}=t;Gg(y&&k,e,"internal-error");const S=Cm.fromJSON(this.name,k);Gg("string"===typeof y,e,"internal-error"),Tm(u,e.name),Tm(h,e.name),Gg("boolean"===typeof _,e,"internal-error"),Gg("boolean"===typeof b,e,"internal-error"),Tm(d,e.name),Tm(f,e.name),Tm(p,e.name),Tm(g,e.name),Tm(m,e.name),Tm(v,e.name);const E=new Im({uid:y,auth:e,email:h,emailVerified:_,displayName:u,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:S,createdAt:m,lastLoginAt:v});return w&&Array.isArray(w)&&(E.providerData=w.map((e=>Object.assign({},e)))),g&&(E._redirectEventId=g),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new Cm;r.updateFromServerResponse(t);const i=new Im({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Sm(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Gg(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Em(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new Cm;o.updateFromIdToken(n);const a=new Im({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new km(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const xm=new Map;function Rm(e){Kg(e instanceof Function,"Expected a class definition");let t=xm.get(e);return t?(Kg(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,xm.set(e,t),t)}class Nm{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Nm.type="NONE";const Pm=Nm;function Am(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class Om{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=Am(this.userKey,r.apiKey,i),this.fullPersistenceKey=Am("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Im._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new Om(Rm(Pm),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||Rm(Pm);const s=Am(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){const n=Im._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch(l){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(l){}}))),new Om(i,e,n)):new Om(i,e,n)}}function Dm(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(jm(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Lm(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(qm(t))return"Blackberry";if(Vm(t))return"Webos";if(Fm(t))return"Safari";if((t.includes("chrome/")||Mm(t))&&!t.includes("edge/"))return"Chrome";if(Um(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function Lm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/firefox\//i.test(e)}function Fm(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Mm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/crios\//i.test(e)}function jm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/iemobile/i.test(e)}function Um(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/android/i.test(e)}function qm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/blackberry/i.test(e)}function Vm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/webos/i.test(e)}function zm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Bm(){return function(){const e=$e();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Hm(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e();return zm(e)||Um(e)||Vm(e)||qm(e)||/windows phone/i.test(e)||jm(e)}function Wm(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=Dm($e());break;case"Worker":t="".concat(Dm($e()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Dn,"/").concat(r)}class Gm{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(AE){r(AE)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(AE){t.reverse();for(const n of t)try{n()}catch(KE){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===AE||void 0===AE?void 0:AE.message})}}}class $m{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Km{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ym(this),this.idTokenSubscription=new Ym(this),this.beforeStateQueue=new Gm(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Mg,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Rm(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await Om.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(AE){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await gm(this,{idToken:e}),n=await Im._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Pn(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(AE){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(AE)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Gg(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(AE){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Sm(e)}catch(AE){if((null===AE||void 0===AE?void 0:AE.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Pn(this.app))return Promise.reject(Bg(this));const t=e?_t(e):null;return t&&Gg(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Gg(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return Pn(this.app)?Promise.reject(Bg(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Pn(this.app)?Promise.reject(Bg(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Rm(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return sm(e,"GET","/v2/passwordPolicy",im(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new $m(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new et("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return sm(e,"POST","/v2/accounts:revokeToken",im(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Rm(e)||this._popupRedirectResolver;Gg(t,this,"argument-error"),this.redirectPersistenceManager=await Om.create(this,[Rm(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Gg(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Gg(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Wm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(jg.logLevel<=Ct.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];jg.warn("Auth (".concat(Dn,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function Qm(e){return _t(e)}class Ym{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new gt(e,t);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Gg(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Jm={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Xm(e){return Jm.loadJS(e)}function Zm(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class ev{constructor(e){this.type="recaptcha-enterprise",this.auth=Qm(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;dm(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{pm(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new fm(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&dm(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Jm.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Xm(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function tv(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new ev(e);let s;try{s=await i.verify(n)}catch(V_){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function nv(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await tv(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await tv(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function rv(e,t,n){const r=Qm(e);Gg(r._canInitEmulator,r,"emulator-config-failed"),Gg(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=iv(t),{host:o,port:a}=function(e){const t=iv(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:sv(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:sv(t)}}}(t),l=null===a?"":":".concat(a);r.config.emulator={url:"".concat(s,"//").concat(o).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function iv(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function sv(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ov{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return $g("not implemented")}_getIdTokenResponse(e){return $g("not implemented")}_linkToIdToken(e,t){return $g("not implemented")}_getReauthenticationResolver(e){return $g("not implemented")}}async function av(e,t){return sm(e,"POST","/v1/accounts:signUp",t)}async function lv(e,t){return am(e,"POST","/v1/accounts:signInWithPassword",im(e,t))}class cv extends ov{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new cv(e,t,"password")}static _fromEmailAndCode(e,t){return new cv(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return nv(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",lv);case"emailLink":return async function(e,t){return am(e,"POST","/v1/accounts:signInWithEmailLink",im(e,t))}(e,{email:this._email,oobCode:this._password});default:qg(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return nv(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",av);case"emailLink":return async function(e,t){return am(e,"POST","/v1/accounts:signInWithEmailLink",im(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:qg(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function uv(e,t){return am(e,"POST","/v1/accounts:signInWithIdp",im(e,t))}class hv extends ov{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new hv(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qg("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Dg(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new hv(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return uv(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,uv(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,uv(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ht(t)}return e}}const dv={USER_NOT_FOUND:"user-not-found"};class fv extends ov{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new fv({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new fv({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return am(e,"POST","/v1/accounts:signInWithPhoneNumber",im(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await am(e,"POST","/v1/accounts:signInWithPhoneNumber",im(e,t));if(n.temporaryProof)throw hm(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return am(e,"POST","/v1/accounts:signInWithPhoneNumber",im(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),dv)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new fv({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class pv{constructor(e){var t,n,r,i,s,o;const a=dt(ft(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Gg(l&&c&&u,"argument-error"),this.apiKey=l,this.operation=u,this.code=c,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=dt(ft(e)).link,n=t?dt(ft(t)).deep_link_id:null,r=dt(ft(e)).deep_link_id;return(r?dt(ft(r)).link:null)||r||n||t||e}(e);try{return new pv(t)}catch(n){return null}}}class gv{constructor(){this.providerId=gv.PROVIDER_ID}static credential(e,t){return cv._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=pv.parseLink(t);return Gg(n,"argument-error"),cv._fromEmailAndCode(e,n.code,n.tenantId)}}gv.PROVIDER_ID="password",gv.EMAIL_PASSWORD_SIGN_IN_METHOD="password",gv.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class mv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class vv extends mv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class yv extends vv{constructor(){super("facebook.com")}static credential(e){return hv._fromParams({providerId:yv.PROVIDER_ID,signInMethod:yv.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return yv.credentialFromTaggedObject(e)}static credentialFromError(e){return yv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return yv.credential(t.oauthAccessToken)}catch(n){return null}}}yv.FACEBOOK_SIGN_IN_METHOD="facebook.com",yv.PROVIDER_ID="facebook.com";class _v extends vv{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return hv._fromParams({providerId:_v.PROVIDER_ID,signInMethod:_v.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return _v.credentialFromTaggedObject(e)}static credentialFromError(e){return _v.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return _v.credential(n,r)}catch(i){return null}}}_v.GOOGLE_SIGN_IN_METHOD="google.com",_v.PROVIDER_ID="google.com";class bv extends vv{constructor(){super("github.com")}static credential(e){return hv._fromParams({providerId:bv.PROVIDER_ID,signInMethod:bv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return bv.credentialFromTaggedObject(e)}static credentialFromError(e){return bv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return bv.credential(t.oauthAccessToken)}catch(n){return null}}}bv.GITHUB_SIGN_IN_METHOD="github.com",bv.PROVIDER_ID="github.com";class wv extends vv{constructor(){super("twitter.com")}static credential(e,t){return hv._fromParams({providerId:wv.PROVIDER_ID,signInMethod:wv.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return wv.credentialFromTaggedObject(e)}static credentialFromError(e){return wv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return wv.credential(n,r)}catch(i){return null}}}wv.TWITTER_SIGN_IN_METHOD="twitter.com",wv.PROVIDER_ID="twitter.com";class kv{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await Im._fromIdTokenResponse(e,n,r),s=Sv(n);return new kv({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Sv(n);return new kv({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Sv(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Ev extends Ze{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Ev.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Ev(e,t,n,r)}}function Cv(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Ev._fromErrorAndOperation(e,n,t,r);throw n}))}async function Tv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await bm(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return kv._forOperation(e,"link",r)}async function Iv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Pn(r.app))return Promise.reject(Bg(r));const i="reauthenticate";try{const s=await bm(e,Cv(r,i,t,e),n);Gg(s.idToken,r,"internal-error");const o=ym(s.idToken);Gg(o,r,"internal-error");const{sub:a}=o;return Gg(e.uid===a,r,"user-mismatch"),kv._forOperation(e,i,s)}catch(AE){throw(null===AE||void 0===AE?void 0:AE.code)==="auth/".concat("user-not-found")&&qg(r,"user-mismatch"),AE}}async function xv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Pn(e.app))return Promise.reject(Bg(e));const r="signIn",i=await Cv(e,r,t),s=await kv._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}new WeakMap;const Rv="__sak";class Nv{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rv,"1"),this.storage.removeItem(Rv),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Pv extends Nv{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=$e();return Fm(e)||zm(e)}()&&function(){try{return!(!window||window===window.top)}catch(AE){return!1}}(),this.fallbackToPolling=Hm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Bm()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Pv.type="LOCAL";const Av=Pv;class Ov extends Nv{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Ov.type="SESSION";const Dv=Ov;class Lv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Lv(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Fv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Lv.receivers=[];class Mv{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const l=Fv("",20);r.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function jv(){return window}function Uv(){return"undefined"!==typeof jv().WorkerGlobalScope&&"function"===typeof jv().importScripts}const qv="firebaseLocalStorageDb",Vv="firebaseLocalStorage",zv="fbase_key";class Bv{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Hv(e,t){return e.transaction([Vv],t?"readwrite":"readonly").objectStore(Vv)}function Wv(){const e=indexedDB.open(qv,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Vv,{keyPath:zv})}catch(AE){n(AE)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Vv)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(qv);return new Bv(e).toPromise()}(),t(await Wv()))}))}))}async function Gv(e,t,n){const r=Hv(e,!0).put({[zv]:t,value:n});return new Bv(r).toPromise()}function $v(e,t){const n=Hv(e,!0).delete(t);return new Bv(n).toPromise()}class Kv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await Wv()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(AE){if(t++>3)throw AE;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Lv._getInstance(Uv()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Mv(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Wv();return await Gv(e,Rv,"1"),await $v(e,Rv),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Gv(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Hv(e,!1).get(t),r=await new Bv(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>$v(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Hv(e,!1).getAll();return new Bv(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Kv.type="LOCAL";const Qv=Kv;Zm("rcb"),new Zg(3e4,6e4);const Yv="recaptcha";async function Jv(e,t,n){var r;const i=await n.verify();try{let s;if(Gg("string"===typeof i,e,"argument-error"),Gg(n.type===Yv,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Gg("enroll"===t.type,e,"internal-error");const n=await function(e,t){return sm(e,"POST","/v2/accounts/mfaEnrollment:start",im(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Gg("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Gg(n,e,"missing-multi-factor-info");const o=await function(e,t){return sm(e,"POST","/v2/accounts/mfaSignIn:start",im(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return sm(e,"POST","/v1/accounts:sendVerificationCode",im(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Xv{constructor(e){this.providerId=Xv.PROVIDER_ID,this.auth=Qm(e)}verifyPhoneNumber(e,t){return Jv(this.auth,e,_t(t))}static credential(e,t){return fv._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Xv.credentialFromTaggedObject(t)}static credentialFromError(e){return Xv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?fv._fromTokenResponse(n,r):null}}function Zv(e,t){return t?Rm(t):(Gg(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Xv.PROVIDER_ID="phone",Xv.PHONE_SIGN_IN_METHOD="phone";class ey extends ov{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return uv(e,this._buildIdpRequest())}_linkToIdToken(e,t){return uv(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return uv(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ty(e){return xv(e.auth,new ey(e),e.bypassAuthState)}function ny(e){const{auth:t,user:n}=e;return Gg(n,t,"internal-error"),Iv(n,new ey(e),e.bypassAuthState)}async function ry(e){const{auth:t,user:n}=e;return Gg(n,t,"internal-error"),Tv(n,new ey(e),e.bypassAuthState)}class iy{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(AE){this.reject(AE)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(AE){this.reject(AE)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ty;case"linkViaPopup":case"linkViaRedirect":return ry;case"reauthViaPopup":case"reauthViaRedirect":return ny;default:qg(this.auth,"internal-error")}}resolve(e){Kg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Kg(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const sy=new Zg(2e3,1e4);class oy extends iy{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,oy.currentPopupAction&&oy.currentPopupAction.cancel(),oy.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Gg(e,this.auth,"internal-error"),e}async onExecution(){Kg(1===this.filter.length,"Popup operations only handle one event");const e=Fv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Vg(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Vg(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,oy.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Vg(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,sy.get())};e()}}oy.currentPopupAction=null;const ay="pendingRedirect",ly=new Map;class cy extends iy{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=ly.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=dy(t),r=hy(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(AE){e=()=>Promise.reject(AE)}ly.set(this.auth._key(),e)}return this.bypassAuthState||ly.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function uy(e,t){ly.set(e._key(),t)}function hy(e){return Rm(e._redirectPersistence)}function dy(e){return Am(ay,e.config.apiKey,e.name)}async function fy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Pn(e.app))return Promise.reject(Bg(e));const r=Qm(e),i=Zv(r,t),s=new cy(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class py{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return my(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!my(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Vg(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(gy(e))}saveEventToCache(e){this.cachedEventUids.add(gy(e)),this.lastProcessedEventTime=Date.now()}}function gy(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function my(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const vy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,yy=/^https?/;async function _y(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return sm(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(by(r))return}catch(n){}qg(e,"unauthorized-domain")}function by(e){const t=Qg(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!yy.test(n))return!1;if(vy.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const wy=new Zg(3e4,6e4);function ky(){const e=jv().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Sy(e){return new Promise(((t,n)=>{var r,i,s;function o(){ky(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ky(),n(Vg(e,"network-request-failed"))},timeout:wy.get()})}if(null===(i=null===(r=jv().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=jv().gapi)||void 0===s?void 0:s.load)){const t=Zm("iframefcb");return jv()[t]=()=>{gapi.load?o():n(Vg(e,"network-request-failed"))},Xm("".concat(Jm.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}o()}})).catch((e=>{throw Ey=null,e}))}let Ey=null;const Cy=new Zg(5e3,15e3),Ty="__/auth/iframe",Iy="emulator/auth/iframe",xy={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ry=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ny(e){const t=e.config;Gg(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?em(t,Iy):"https://".concat(e.config.authDomain,"/").concat(Ty),r={apiKey:t.apiKey,appName:e.name,v:Dn},i=Ry.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),"".concat(n,"?").concat(ht(r).slice(1))}async function Py(e){const t=await function(e){return Ey=Ey||Sy(e),Ey}(e),n=jv().gapi;return Gg(n,e,"internal-error"),t.open({where:document.body,url:Ny(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:xy,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Vg(e,"network-request-failed"),s=jv().setTimeout((()=>{r(i)}),Cy.get());function o(){jv().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const Ay={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Oy{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(AE){}}}function Dy(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Ay),{width:r.toString(),height:i.toString(),top:s,left:o}),c=$e().toLowerCase();n&&(a=Mm(c)?"_blank":n),Lm(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return zm(arguments.length>0&&void 0!==arguments[0]?arguments[0]:$e())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new Oy(null);const h=window.open(t||"",a,u);Gg(h,e,"popup-blocked");try{h.focus()}catch(AE){}return new Oy(h)}const Ly="__/auth/handler",Fy="emulator/auth/handler",My=encodeURIComponent("fac");async function jy(e,t,n,r,i,s){Gg(e.config.authDomain,e,"auth-domain-config-required"),Gg(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Dn,eventId:i};if(t instanceof mv){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",at(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof vv){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?"#".concat(My,"=").concat(encodeURIComponent(l)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Ly);return em(t,Fy)}(e),"?").concat(ht(a).slice(1)).concat(c)}const Uy="webStorageSupport";const qy=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Dv,this._completeRedirectFn=fy,this._overrideRedirectResult=uy}async _openPopup(e,t,n,r){var i;Kg(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Dy(e,await jy(e,t,n,Qg(),r),Fv())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){jv().location.href=e}(await jy(e,t,n,Qg(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Kg(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await Py(e),n=new py(e);return t.register("authEvent",(t=>{Gg(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Uy,{type:Uy},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[Uy];void 0!==i&&t(!!i),qg(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=_y(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Hm()||Fm()||zm()}};var Vy="@firebase/auth",zy="1.7.2";class By{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Gg(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Hy=We("authIdTokenMaxAge")||300;let Wy=null;var Gy;!function(e){Jm=e}({loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Vg("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Gy="Browser",Rn(new bt("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Gg(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:Gy,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wm(Gy)},c=new Km(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Rm);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),Rn(new bt("auth-internal",(e=>(e=>new By(e))(Qm(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),Mn(Vy,zy,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Gy)),Mn(Vy,zy,"esm2017");const $y=Ln({apiKey:"AIzaSyD-XWrjMOmhRPjjRz-MOA1ARZN_RVwTcbc",authDomain:"skincare-recipe-tool.firebaseapp.com",projectId:"skincare-recipe-tool",storageBucket:"skincare-recipe-tool.appspot.com",messagingSenderId:"1053752399193",appId:"1:1053752399193:web:caf58158f655ca8e0f2848"}),Ky=function(e,t){const n="string"==typeof e?e:t||"(default)",r=Nn("object"==typeof e?e:Fn(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=Be(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Ep(r,...e)}return r}($y),Qy=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fn();const t=Nn(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Nn(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(ct(n.getOptions(),null!==t&&void 0!==t?t:{}))return e;qg(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:qy,persistence:[Qv,Av,Dv]}),r=We("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Hy)return;const r=null===t||void 0===t?void 0:t.token;Wy!==r&&(Wy=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){_t(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){_t(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const s=Be("auth");return s&&rv(n,"http://".concat(s)),n}($y),Yy=new _v;!function(e,t){_t(e).setPersistence(t)}(Qy,Av);const Jy=e=>{const t=e+"=",n=document.cookie.split(";");for(let r=0;r<n.length;r++){let e=n[r];for(;" "===e.charAt(0);)e=e.substring(1);if(0===e.indexOf(t))return e.substring(t.length,e.length)}return null},Xy=async()=>{const e=Jy("sessionId");if(e)try{const t=Rp(Ky,"sessions",e);await Ng(t,{lastDateTime:new Date}),console.log("Session lastDateTime updated in Firestore")}catch(V_){console.error("Error updating document: ",V_)}else{const e=navigator.userAgent,{innerWidth:t,innerHeight:n}=window;try{const r=await Pg(xp(Ky,"sessions"),{firstDatetime:new Date,lastDateTime:new Date,userAgent:e,resolution:"".concat(t,"x").concat(n)});console.log("Session info added to Firestore with ID: ",r.id),((e,t)=>{let n="";const r=new Date;r.setTime(r.getTime()+31536e6),n="; expires="+r.toUTCString(),document.cookie=e+"="+(t||"")+n+"; path=/"})("sessionId",r.id)}catch(V_){console.error("Error adding document: ",V_)}}},Zy=async e=>{const t=Jy("sessionId");if(!t)return void console.error("Session ID cookie not found.");const n={...e,lastDateTime:new Date};try{const e=Rp(Ky,"sessions",t);await Ng(e,n),console.log("Session updated successfully")}catch(V_){console.error("Error updating session: ",V_)}};var e_=n(579);const t_=t.memo((e=>{let{children:t,title:n,handleSubmit:r,isSubmitDisabled:i=!1,buttonText:s="Next",whyDisabled:o="Please make a selection"}=e;return(0,e_.jsxs)("div",{className:"layout",children:[(0,e_.jsxs)("div",{className:"body-container",children:[(0,e_.jsx)("h2",{children:n}),(0,e_.jsx)("div",{className:"scroller",children:t})]}),(0,e_.jsxs)("div",{className:"button-footer",children:[(0,e_.jsx)("button",{className:"footer-submit".concat(i?" disabled":""),type:"submit",onClick:r,disabled:i,"aria-label":i?o:s,children:s}),i&&(0,e_.jsx)("p",{className:"why-disabled","aria-live":"polite",children:o})]})]})}));t_.displayName="Layout";const n_=t_,r_={"Sunflower Oil":{phase:"oil",type:"carrier",hlb:0,description:"Moisturizer, rich in Vitamin E, non-comedogenic, suitable for sensitive skin.",good_for:["Sensitive Skin","Dry skin"],bad_for:[],cost:"$20/half gallon",density:.92,cost_per_g:.01148,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:2,gentle_active:5},"Jojoba Oil":{phase:"oil",type:"carrier",hlb:0,description:"Moisturizer, mimics natural skin oils, balances sebum production, good for acne-prone skin.",good_for:["Oily Skin","Dry skin","Sensitive Skin"],bad_for:[],cost:"$9.99/8oz",density:.87,cost_per_g:.0485,light_heavy:4,penetrating_occlusive:3,soothing_stimulating:2,gentle_active:5},"Argan Oil":{phase:"oil",type:"carrier",hlb:11,description:"Rich in antioxidants and Vitamin E, moisturizes, reduces signs of aging, improves skin elasticity and enhances hair shine.",good_for:["Aging or age spots","Dry skin","Wrinkles"],bad_for:[],cost:"$54.99/32oz",density:.91,cost_per_g:.0639,buy_again_url:"https://www.organicpureoil.com/product/pure-1-oz-organic-argan-oil-extra-virgin-unrefined-cold-pressed/",light_heavy:4,penetrating_occlusive:3,soothing_stimulating:3,gentle_active:3},"Castor Oil":{phase:"oil",type:"carrier",hlb:0,description:"Thick, viscous oil; promotes hair growth, deeply hydrating, natural humectant drawing moisture to the skin.",good_for:["Dry scalp","Dry skin","Thickening hair"],bad_for:[],cost:"$15/16oz",density:.96,cost_per_g:.0289,light_heavy:7,penetrating_occlusive:2,soothing_stimulating:2,gentle_active:5},"Sweet Almond Oil":{phase:"oil",type:"carrier",hlb:6,description:"Lightweight, moisturizing oil that easily absorbs into the skin, rich in Vitamin E, helps improve skin tone and texture, ideal for sensitive skin.",good_for:["Sensitive skin","Dry skin","Eczema"],bad_for:[],cost:"$12.99/16oz",density:.91,cost_per_g:.0391,light_heavy:3,penetrating_occlusive:4,soothing_stimulating:5,gentle_active:5},"Shea Butter":{phase:"oil",type:"carrier",hlb:8,description:"Moisturizer, rich in fatty acids and vitamins, anti-inflammatory, helps with skin healing.",good_for:["Dry skin","Atopic dermatitis"],bad_for:["Oily Skin"],cost:"$9.99/16oz",density:.927,cost_per_g:.0228,light_heavy:7,penetrating_occlusive:7,soothing_stimulating:5,gentle_active:3},"Cocoa Butter":{phase:"oil",type:"carrier",hlb:8,description:"Moisturizer, high in fatty acids, helps to hydrate and nourish the skin, reduces the appearance of scars.",good_for:["Dry skin","Wrinkles"],bad_for:["Oily Skin"],cost:"$1/oz",cost_per_g:.0338,buy_again_url:"https://simply-ingredients.com/collections/butters-waxes/products/fair-trade-cocoa-butter?variant=37889946484922",light_heavy:8,penetrating_occlusive:8,soothing_stimulating:5,gentle_active:3},"Coconut Oil":{phase:"oil",type:"carrier",hlb:8,description:"Moisturizes skin and hair, rich in fatty acids and antioxidants. Can be comedogenic (acne-causing) for some.",good_for:["Dry skin"],bad_for:["Oily Skin"],cost:"$6.96/15oz",density:.924,cost_per_g:.017,light_heavy:7,penetrating_occlusive:4,soothing_stimulating:4,gentle_active:4},"Pecan Oil":{phase:"oil",type:"carrier",hlb:0,description:"Moisturizer, rich in antioxidants, promotes skin and hair health, hydrating properties.",good_for:["Dry skin"],bad_for:[],cost:"$17/8oz",density:.95,cost_per_g:.0756,light_heavy:6,penetrating_occlusive:5,soothing_stimulating:4,gentle_active:3},"Pumpkin Seed Oil":{phase:"oil",type:"carrier",hlb:0,description:"Rich in zinc and vitamins, improves skin tone, fights acne, and soothes sensitive skin.",good_for:["Oily Skin","Sensitive Skin"],bad_for:[],cost:"$3/2oz",density:.95,cost_per_g:.0534,light_heavy:5,penetrating_occlusive:4,soothing_stimulating:4,gentle_active:4},"Rosehip Seed Oil":{phase:"oil",type:"carrier",hlb:0,max_percent:10,default_percent:2,description:"Rosehip Seed Oil is rich in essential fatty acids and antioxidants. It's renowned for its skin-regenerative properties, aiding in reducing scars and fine lines. High in vitamins A and C, it helps in evening out skin tone and improving hydration.",good_for:["Wrinkles","Dry skin","Sun Protection","Aging or age spots"],bad_for:[],density:.92,cost_per_g:.19,light_heavy:3,penetrating_occlusive:3,soothing_stimulating:4,gentle_active:4},"Olive Oil":{phase:"oil",type:"carrier",hlb:0,description:"Moisturizer, rich in vitamins and antioxidants, promotes skin and hair health, but can be comedogenic (acne-causing) for some.",good_for:["Dry skin"],bad_for:["Oily Skin"],cost:"$18.99/68oz",density:.9,cost_per_g:.0105,light_heavy:6,penetrating_occlusive:5,soothing_stimulating:3,gentle_active:6,nourishing_acnefighting:3},"Distilled Water":{phase:"aqueous",type:"aqueous",hlb:20,description:"Hydrates and serves as a base for water-soluble ingredients.",good_for:[],bad_for:[],cost_per_g:1e-4,endogenous:!0,light_heavy:1,penetrating_occlusive:1,soothing_stimulating:2,gentle_active:1},"Aloe Vera Gel":{phase:"aqueous",type:"aqueous",hlb:20,description:"Soothes skin irritations, hydrates, promotes healing, good for sunburns and inflammation",good_for:["Sensitive Skin","Sun Protection","Redness"],bad_for:[],cost:"9.99/300ml",density:1.2,cost_per_g:.02775,light_heavy:2,penetrating_occlusive:2,soothing_stimulating:1,gentle_active:2},Glycerin:{phase:"aqueous",type:"aqueous",hlb:20,description:"Humectant, draws moisture into the skin, suitable for all skin types, enhances skin hydration.",good_for:["Dry skin"],bad_for:[],cost:"3.66/4oz",density:1.26,cost_per_g:.0246,endogenous:!0,light_heavy:3,penetrating_occlusive:2,soothing_stimulating:2,gentle_active:3},Honey:{phase:"aqueous",type:"aqueous",hlb:20,description:"Natural humectant, antibacterial, great for acne treatment and hydration, soothing for the skin.",good_for:["Dry skin","Oily Skin"],cost_per_g:.03,bad_for:[],light_heavy:6,penetrating_occlusive:3,soothing_stimulating:2,gentle_active:4},"Cucumber Juice":{phase:"aqueous",type:"aqueous",hlb:20,description:" Hydrating, soothing, rich in vitamins and minerals, good for puffiness and calming irritated skin.",good_for:["Puffiness","Sensitive Skin"],bad_for:[],light_heavy:2,penetrating_occlusive:2,soothing_stimulating:1,gentle_active:2,cost_per_g:.025},"Oat Milk":{phase:"aqueous",type:"aqueous",hlb:20,description:"Contains lipids and water-absorbing substances, providing moisturizing and soothing benefits. Helps in reducing inflammation",good_for:["Dry skin","Sensitive Skin"],bad_for:[],cost_per_g:8e-4,light_heavy:3,penetrating_occlusive:2,soothing_stimulating:1,gentle_active:3},"Hyaluronic Acid Serum (2%)":{phase:"aqueous",type:"aqueous",hlb:20,description:"Powerful humectant, helps to hydrate and plump the skin by retaining moisture, reduces the appearance of fine lines and wrinkles.  Mixed to order with 10% Glycerin and 88% Distilled water to form a ultra-hydrating gel.",good_for:["Dry skin","Wrinkles","Aging or age spots"],bad_for:[],cost_per_g:.05,endogenous:!0,light_heavy:2,penetrating_occlusive:1,soothing_stimulating:1,gentle_active:2},Beeswax:{phase:"emulsifier",type:"emulsifier",hlb:12,description:" Emulsifier and stabilizer in formulations, creates a protective barrier on the skin, retains moisture.",good_for:["Dry skin"],bad_for:[],cost_per_g:.1706,light_heavy:9,penetrating_occlusive:9,soothing_stimulating:3,gentle_active:4},Lecithin:{phase:"emulsifier",type:"emulsifier",hlb:8,description:"Natural stabilizer, thickens formulas and creates protective barrier on skin.",good_for:[],bad_for:[],cost_per_g:.0884,endogenous:!0,light_heavy:6,penetrating_occlusive:5,soothing_stimulating:4,gentle_active:5},"Cetearyl Alcohol":{phase:"emulsifier",type:"emulsifier",hlb:16,description:"A waxy fatty alcohol used as an emulsifier, thickener and stabilizer in creams and lotions. Extracted from Coconut and Palm Kernel oils",good_for:[],bad_for:["Sensitive Skin"],cost_per_g:.0439,light_heavy:7,penetrating_occlusive:6,soothing_stimulating:2,gentle_active:3},"Sorbitan Oleate":{phase:"emulsifier",type:"emulsifier",hlb:4.3,description:"A non-ionic surfactant and emulsifier derived from the fatty acids of olive oil and sorbitol. Used in creams, lotions, and other cosmetics to stabilize oil-in-water formulations."},"Zinc Oxide":{phase:"additive",type:"active",hlb:20,max_percent:25,default_percent:10,description:"Sunscreen agent, provides broad-spectrum UV protection, also known for its soothing and astringent properties.",good_for:["Sun Protection"],bad_for:[],cost_per_g:.0958,light_heavy:7,penetrating_occlusive:8,soothing_stimulating:1,gentle_active:2},"Hyaluronic Acid":{phase:"additive",type:"active",hlb:20,max_percent:2,default_percent:.5,description:"Powerful humectant, helps to hydrate and plump the skin by retaining moisture, reduces the appearance of fine lines and wrinkles.",good_for:["Dry skin","Wrinkles","Aging or age spots"],bad_for:[],cost_per_g:.4639,endogenous:!0,light_heavy:2,penetrating_occlusive:1,soothing_stimulating:1,gentle_active:2,deprecated:!0},Retinol:{phase:"oil",type:"active",hlb:0,max_percent:1,default_percent:.1,description:"Retinyl Palmitate is an ester of Retinol (Vitamin A) and Palmitic Acid.  It is a powerful antioxidant that may help boosts collagen in the skin, minimizes fine lines and wrinkles, as well as smooths the texture of the skin. Should be used intermittently until skin aclimates to it. Sun sensitizing, so should only be used at night.",good_for:["Wrinkles","Aging or age spots"],bad_for:["Sensitive Skin"],cost_per_g:.4282,deprecated:!0,light_heavy:4,penetrating_occlusive:3,soothing_stimulating:7,gentle_active:6},"Retinyl Palmitate":{phase:"additive",type:"active",hlb:0,max_percent:2,default_percent:1,description:"An ester of Retinol (Vitamin A) and Palmitic Acid, it is the weakest form of Retinol. It is a powerful antioxidant that may help boosts collagen in the skin, minimizes fine lines and wrinkles, as well as smooths the texture of the skin. Should be used intermittently until skin aclimates to it. Sun sensitizing, so should only be used at night.",good_for:["Wrinkles","Aging or age spots"],bad_for:["Sensitive Skin"],cost_per_g:.4282,endogenous:!0,light_heavy:4,penetrating_occlusive:3,soothing_stimulating:9,gentle_active:9,advanced:!0},"Vitamin C":{phase:"additive",type:"active",hlb:20,max_percent:20,default_percent:5,description:"Antioxidant, aids in skin repair and regeneration, can help in reducing pigmentation and promoting collagen production.",good_for:["Aging or age spots","Sun Protection"],bad_for:[],cost_per_g:.0288,endogenous:!0,light_heavy:3,penetrating_occlusive:2,soothing_stimulating:7,gentle_active:7,deprecated:!0},"Vitamin E":{phase:"additive",type:"active",hlb:0,max_percent:1,default_percent:.5,description:"Antioxidant, helps in protecting the skin from environmental damage, moisturizes, and heals. Extends shelf life of oils.",good_for:["Sun Protection","Aging or age spots"],bad_for:[],density:.95,cost_per_g:.3505,endogenous:!0,light_heavy:4,penetrating_occlusive:3,soothing_stimulating:3,gentle_active:4},"Niacinamide (Vitamin B3)":{phase:"additive",type:"active",hlb:20,max_percent:5,default_percent:2,description:"Improves appearance of enlarged pores, uneven skin tone, fine lines. Reduces redness and irritation.",good_for:["Large pores","Wrinkles","Redness"],bad_for:[],cost_per_g:.3567,endogenous:!0,light_heavy:2,penetrating_occlusive:1,soothing_stimulating:6,gentle_active:6},"Lavender Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:1,default_percent:.5,description:"Calming and relaxing, and can be used to soothe irritated skin. Anti-inflammatory and antimicrobial properties.",good_for:["Sensitive Skin","Redness"],bad_for:[],density:.885,cost_per_g:1.1578,light_heavy:5,penetrating_occlusive:4,soothing_stimulating:6,gentle_active:5},"Rosemary Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:2,default_percent:1,description:"Rejuvenates skin, improves hair growth and scalp health, and has antioxidant properties. Improves circulation and can help with puffiness.",good_for:["Aging or age spots"],bad_for:["Sensitive Skin"],density:.895,cost_per_g:.1214,light_heavy:5,penetrating_occlusive:4,soothing_stimulating:7,gentle_active:6},"Tea Tree Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:2,default_percent:1,description:"Antimicrobial and anti-inflammatory, very effective against acne, helps in cleansing the skin.",good_for:["Oily Skin"],bad_for:["Dry skin"],density:.878,cost_per_g:.3792,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:8,gentle_active:7},"Jasmine Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:1,default_percent:.5,description:"Moisturizes, soothes, often used for its fragrance and hydrating properties.",good_for:["Dry skin"],bad_for:[],density:.947,cost_per_g:2.7434,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:5,gentle_active:5},"Eucalyptus Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:2,default_percent:1,description:"Antiseptic and anti-inflammatory properties, good for healing. Refreshing scent.",good_for:["Oily Skin"],bad_for:["Sensitive Skin","Dry skin"],densitY:.914,cost_per_g:.153,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:7,gentle_active:6},"Peppermint Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:1,default_percent:.5,description:"Cooling sensation and refreshing scent. It has antiseptic and antimicrobial properties. Can help with acne and oily skin, but can be irritating.",good_for:["Oily Skin","Puffiness"],bad_for:["Sensitive Skin","Redness"],density:.898,cost_per_g:.0942,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:8,gentle_active:6},"Pine Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:1,default_percent:.5,description:"Known for its invigorating and refreshing scent, has antimicrobial and anti-inflammatory properties. It's often used in skincare for its soothing effects on the skin and its ability to help with respiratory issues.",good_for:["Atopic dermatitis","Oily Skin"],bad_for:["Sensitive Skin"],cost_per_g:1.155,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:8,gentle_active:7},"Cedar Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:1,default_percent:.5,description:"With its woodsy aroma, is known for its calming and grounding effects. It has antiseptic, anti-inflammatory, and astringent properties, making it beneficial for skin conditions like acne and aiding in soothing irritated skin.",good_for:["Oily Skin","Atopic dermatitis"],bad_for:["Sensitive Skin"],density:.952,cost_per_g:1.7507,light_heavy:5,penetrating_occlusive:5,soothing_stimulating:7,gentle_active:6},"Geranium Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:2,default_percent:.5,description:"Geranium Oil, known for its floral scent, is used for its astringent, antiseptic, and anti-inflammatory properties. It helps in balancing sebum production, enhancing skin elasticity, and promoting the healing of scars and spots.",good_for:["Oily Skin","Large pores","Wrinkles"],bad_for:["Sensitive Skin"],density:.887,cost_per_g:1.5031,light_heavy:4,penetrating_occlusive:4,soothing_stimulating:6,gentle_active:5},"Carrot Seed Oil":{phase:"additive",type:"fragrance",hlb:0,max_percent:5,default_percent:1,description:"Carrot Seed Oil is valued for its antioxidant properties and high vitamin A content. It's considered excellent for sun protection, rejuvenating aged skin, and promoting skin healing. Also known for its ability to rejuvenate and regenerate skin tissues.",good_for:["Aging or age spots","Sun Protection","Wrinkles"],bad_for:["Sensitive Skin"],density:.92,cost_per_g:1.5942,light_heavy:5,penetrating_occlusive:4,soothing_stimulating:4,gentle_active:5},Phenoxyethanol:{phase:"additive",type:"preservative",hlb:20,max_percent:1,default_percent:.5,description:"Broad-spectrum synthetic preservative, effective against bacteria, yeast, and mold. It is used in concentrations of 0.5% to 1%. It is commonly found in ballpoint pen ink, many skincare products, and used as a solvent in pharmaceutical injections because its safety has been well established.",cost_per_g:.0712,good_for:[],bad_for:[],light_heavy:1,penetrating_occlusive:1,soothing_stimulating:1,gentle_active:1},"AntiMicro Banana":{phase:"additive",type:"preservative",hlb:20,max_percent:4,default_percent:2,description:"Broad-spectrum preservative, 100% plant derived - made of parts of the banana tree that would go to waste. Water soluble, concentrated plant extract.",cost_per_g:.16,good_for:[],bad_for:[],light_heavy:1,penetrating_occlusive:1,soothing_stimulating:1,gentle_active:1},"AntiMicro Root Blend":{phase:"additive",type:"preservative",hlb:20,max_percent:2,default_percent:1,description:"This blend of garlic, ginger & wasabi extracts dissolved in hydrating glycols provides effective microbial growth prevention.",cost_per_g:.16,good_for:[],bad_for:[],light_heavy:1,penetrating_occlusive:1,soothing_stimulating:1,gentle_active:1}},i_=r_,s_=e=>{let{items:n,handleSelection:r,selectedItem:i,itemRefs:s,big:o}=e;return(0,e_.jsx)("div",{className:"scroll-items",children:n.map(((e,n)=>(0,e_.jsxs)("div",{ref:e=>s.current[n]=e,className:"scroll-item ".concat(i===e.title?"selected-item":""),onClick:()=>r(e,n),children:[(0,e_.jsx)("h2",{children:e.title}),(0,e_.jsx)("p",{className:o?"big":"",children:e.description}),e.ingredients&&Object.keys(e.ingredients).length>0&&(0,e_.jsxs)(e_.Fragment,{children:[(0,e_.jsx)("p",{children:"Ingredients:"}),Object.entries(e.ingredients).map((e=>{let[n,r]=e;return((e,n)=>{var r;return(0,e_.jsxs)(t.Fragment,{children:[(0,e_.jsxs)("p",{className:"expanded-ingredient",children:[e,": ",n," Parts"]}),(0,e_.jsx)("p",{className:"ingredient-description",children:(null===(r=i_[e])||void 0===r?void 0:r.description)||"Description not available."})]},e)})(n,r)}))]})]},n)))})},o_={"Face Moisturizing Cream or Lotion":{description:"Maintain your skin's hydration and keep it soft and supple with a moisturizing cream or lotion. Regular use supports a healthy skin barrier, protecting against dryness and environmental stressors while promoting a balanced complexion.",mustIncludeIngredients:[],typeOrder:["emulsifier","carrier","aqueous","active","fragrance","preservative"]},"Body Moisturizing Cream or Body Butter":{description:"A deeply hydrating and nourishing body moisturizer that locks in moisture and rejuvenates the skin. Its rich, thick texture is ideal for the body's less sensitive, resilient skin.",mustIncludeIngredients:[],typeOrder:["emulsifier","carrier","aqueous","active","fragrance","preservative"]},"Face Oil":{description:"Face oil offers intense hydration and nourishment, absorbing deeply to enhance skin's natural glow. Unlike lotions, oils lock in moisture and provide a concentrated boost, ideal for restoring softness and radiance.",mustIncludeIngredients:[],typeOrder:["carrier","fragrance"]},"Hair and Scalp Oil":{description:"A soothing and revitalizing oil that nourishes the scalp, strengthens hair roots, and adds a healthy shine. Use as a pre-shampoo treatment or leave-in conditioner.",mustIncludeIngredients:[],typeOrder:["carrier","fragrance"]}};const a_=function(){const{dispatch:e}=m_(),n=Z(),[r,i]=(0,t.useState)(""),s=(0,t.useRef)([]),o=Object.entries(o_).map((e=>{let[t,n]=e;return{title:t,description:n.description}}));return(0,e_.jsx)(n_,{title:"Select a Skincare Product",handleSubmit:t=>{t.preventDefault(),e({type:"SET_PRODUCT_DATA",payload:r}),Zy({selectedProduct:r}).then((()=>{n("/goals")}))},isSubmitDisabled:!r,buttonText:"Next",children:(0,e_.jsx)(s_,{items:o,handleSelection:(e,t)=>{i(e.title),s.current[t]&&s.current[t].scrollIntoView({behavior:"smooth",inline:"center"})},selectedItem:r,isMultipleSelection:!1,itemRefs:s,big:!0})})},l_=(0,t.createContext)(),c_=e=>{let{children:n}=e;const[r,i]=(0,t.useState)(null),[s,o]=(0,t.useState)(!0);(0,t.useEffect)((()=>{let e;return(async()=>{try{console.log("UserProvider: Initializing auth");const e=await async function(e,t){return await Qm(e)._initializationPromise,fy(e,t,!1)}(Qy);e&&e.user?(console.log("UserProvider: Redirect result found",e.user),i(e.user)):console.log("UserProvider: No redirect result found")}catch(V_){console.error("UserProvider: Error handling redirect",V_)}finally{console.log("UserProvider: Setting up auth state listener"),e=Qy.onAuthStateChanged((e=>{console.log("UserProvider: Auth state changed",e),i(e),o(!1)}))}})(),()=>{e&&e()}}),[]);const a={user:r,setUser:i,loading:s,logout:async()=>{try{await Qy.signOut(),console.log("UserProvider: User signed out")}catch(V_){console.error("UserProvider: Error signing out",V_)}}};return(0,e_.jsx)(l_.Provider,{value:a,children:n})},u_=()=>{const e=(0,t.useContext)(l_);if(void 0===e)throw new Error("useUser must be used within a UserProvider");return e},h_=(0,t.createContext)(),d_={recipeId:"",createdAt:(new Date).getTime().toString(),goalsData:[],productData:"",includeFragrance:"no",phaseOrder:[],currentPhase:"",recipe:{},rawRecipe:{},recipeName:"",baseName:"Untitled",variationName:"",generation:0,displayName:"Untitled (Gen 0)",originRecipeId:"",parentRecipeId:"",creatorId:"",orderCount:0,favoriteCount:0,status:"Incomplete",variationRequest:{selectedOptions:[],customRequest:""}},f_=(e,t,n)=>{let r=e||"Untitled";return t&&(r+=" var. ".concat(t)),r+=" (Gen ".concat(n,")"),r},p_=(e,t)=>{switch(t.type){case"SET_PRODUCT_DATA":return{...e,productData:t.payload,phaseOrder:o_[t.payload].typeOrder,currentPhase:o_[t.payload].typeOrder[0]};case"SET_GOALS_DATA":return{...e,goalsData:t.payload};case"SET_INCLUDE_FRAGRANCE":return{...e,includeFragrance:t.payload};case"SET_CURRENT_PHASE":return{...e,currentPhase:t.payload};case"SET_RAW_RECIPE":return{...e,rawRecipe:t.payload};case"SET_RECIPE_NAME":return{...e,recipeName:t.payload};case"UPDATE_RECIPE":const{phase:n,data:r}=t.payload;return{...e,recipe:{...e.recipe,[n]:{...e.recipe[n],...r}}};case"RESET_RECIPE":return d_;case"SET_BASE_NAME":return{...e,baseName:t.payload,displayName:f_(t.payload,e.variationName,e.generation),recipeId:e.createdAt+t.payload+e.generation};case"SET_VARIATION_NAME":return{...e,variationName:t.payload,displayName:f_(e.baseName,t.payload,e.generation)};case"SET_GENERATION":return{...e,generation:t.payload,displayName:f_(e.baseName,e.variationName,t.payload),recipeId:e.createdAt+e+baseName+e.generation};case"CREATE_VARIATION":const i=e.generation+1;return{...d_,createdAt:(new Date).getTime().toString(),baseName:e.baseName,parentRecipeId:e.recipeId,originRecipeId:e.originRecipeId||e.recipeId,generation:i,displayName:f_(e.baseName,"",i),recipe:JSON.parse(JSON.stringify(e.recipe)),rawRecipe:JSON.parse(JSON.stringify(e.rawRecipe)),productData:e.productData,goalsData:[...e.goalsData],includeFragrance:e.includeFragrance,phaseOrder:[...e.phaseOrder],currentPhase:e.currentPhase};case"SET_PARENT_RECIPE_ID":return{...e,parentRecipeId:t.payload};case"SET_ORIGIN_RECIPE_ID":return{...e,originRecipeId:t.payload};case"SET_GENERATION":return{...e,generation:t.payload};case"INCREMENT_ORDER_COUNT":return{...e,orderCount:e.orderCount+1};case"INCREMENT_FAVORITE_COUNT":return{...e,favoriteCount:e.favoriteCount+1};case"DECREMENT_FAVORITE_COUNT":return{...e,favoriteCount:Math.max(0,e.favoriteCount-1)};case"CREATE_VARIATION":return{...d_,baseName:e.baseName,parentRecipeId:e.id,originRecipeId:e.originRecipeId||e.id,generation:e.generation+1,recipe:JSON.parse(JSON.stringify(e.recipe)),rawRecipe:JSON.parse(JSON.stringify(e.rawRecipe)),productData:e.productData,goalsData:[...e.goalsData],includeFragrance:e.includeFragrance,phaseOrder:[...e.phaseOrder],currentPhase:e.currentPhase};case"SET_VARIATION_REQUEST":return{...e,variationRequest:t.payload};case"SET_CREATOR_ID":return{...e,creatorId:t.payload};default:return e}},g_=e=>{let{children:n}=e;const[r,i]=(0,t.useReducer)(p_,d_),{user:s}=u_();return(0,t.useEffect)((()=>{"Untitled"!==r.baseName&&(s&&s.uid&&!r.creatorId&&i({type:"SET_CREATOR_ID",payload:s.uid}),console.log(r),(async e=>{try{if(!e.baseName||""===e.baseName)return;console.log("Updating recipe in Firebase:",e);const t=Rp(Ky,"recipes",e.recipeId);await Rg(t,e,{merge:!0}),console.log("Recipe updated successfully")}catch(V_){console.error("Error updating recipe in Firebase:",V_)}})(r))}),[r,s]),(0,e_.jsx)(h_.Provider,{value:{state:r,dispatch:i},children:n})},m_=()=>(0,t.useContext)(h_);const v_=function(){const{state:e,dispatch:n}=m_(),r=Z(),[i,s]=(0,t.useState)([]),[o,a]=(0,t.useState)("no");var l=[];return l="Hair and Scalp Oil"===e.productData?["Dry Scalp","Hair Vitality","Hair Shine","Frizz Control","Curl Definition","Scalp Soothing"]:"Body Moisturizing Cream or Body Butter"===e.productData?["Oily Skin","Dry skin","Sensitive Skin","Softer Skin","Skin Elasticity","Uneven Skin Tone"]:["Oily Skin","Dry Skin","Soothing","Wrinkles","Puffiness","Dullness","Aging","Large Pores"],console.log(0===i.length,o),(0,e_.jsx)(n_,{title:"Select Your Skincare Goals + Concerns",isSubmitDisabled:0===i.length||"yes"===o&&0===selectedMoods.length,handleSubmit:e=>{e.preventDefault();Zy({selectedOptions:i,includeFragrance:o}).then((()=>{n({type:"SET_GOALS_DATA",payload:i}),n({type:"SET_INCLUDE_FRAGRANCE",payload:o}),r("/phase-choices")}))},buttonText:"Next",children:(0,e_.jsx)("form",{children:(0,e_.jsx)("div",{className:"multiselect-container",children:l.map(((e,t)=>{return(0,e_.jsx)("button",{type:"button",onClick:()=>(e=>{const t=i.includes(e)?i.filter((t=>t!==e)):[...i,e];s(t)})(e),className:"multiselect-button ".concat((n=e,i.includes(n)?"selected":"")),children:e},t);var n}))})})})},y_=(0,t.createContext)();function __(e){let{children:n}=e;const[r,i]=(0,t.useState)(!1);(0,t.useEffect)((()=>{const e="true"===localStorage.getItem("devFeature");i(e)}),[]);return(0,e_.jsx)(y_.Provider,{value:{isDevFeatureEnabled:r,toggleFeature:()=>{localStorage.setItem("devFeature",!r),i(!r)}},children:n})}const b_=["AI is preparing a recipe for you...","Considering which ingredients will work best for your concerns...","Balancing proportions to ensure proper texture...","Optimizing for your skin type...","Finalizing the perfect skincare formula...","Almost there, just adding the finishing touches..."];const w_=function(){const{state:e}=m_(),n=Z(),[r,i]=(0,t.useState)(!1),[s,o]=(0,t.useState)(b_[0]);return(0,t.useEffect)((()=>{if(r){const e=setInterval((()=>{o((e=>{const t=(b_.indexOf(e)+1)%b_.length;return b_[t]}))}),4e3);return()=>clearInterval(e)}}),[r]),(0,e_.jsx)(n_,{title:"How it works",handleSubmit:()=>{n("/product")},buttonText:"Let's Get Started!",isSubmitDisabled:r,whyDisabled:"Loading...",children:(0,e_.jsxs)("div",{className:"summary-content",children:[(0,e_.jsx)("p",{className:"intro-text",children:"Welcome to our personalized skincare journey! Create custom skincare formulations tailored to your unique needs and preferences."}),(0,e_.jsxs)("ol",{className:"steps-list",children:[(0,e_.jsxs)("li",{children:[(0,e_.jsx)("b",{children:"Complete a Brief Questionnaire:"})," Answer questions about your skincare goals and concerns."]}),(0,e_.jsxs)("li",{children:[(0,e_.jsx)("b",{children:"Design Your Formula:"})," Choose from AI-suggested ingredients to build your base skincare product recipe."]}),(0,e_.jsxs)("li",{children:[(0,e_.jsx)("b",{children:"Create a Variation:"})," Experiment with a second version of your formula to find your perfect match."]}),(0,e_.jsxs)("li",{children:[(0,e_.jsx)("b",{children:"Try Your Customized Products:"})," Receive ",(0,e_.jsx)("b",{children:"TWO 1-oz portions"})," to try and compare."]}),(0,e_.jsxs)("li",{children:[(0,e_.jsx)("b",{children:"Refine and Reorder:"})," Choose your favorite and design a new variation for your next order."]}),(0,e_.jsxs)("li",{children:[(0,e_.jsx)("b",{children:"Perfect Your Skincare Recipe:"})," Repeat until you've found your perfect skincare recipe!"]})]}),(0,e_.jsx)("p",{className:"outro-text",children:"Our service offers unparalleled personalization, ensuring your skincare products are as unique as you are."})]})})};const k_=function(){const[e,n]=(0,t.useState)(null),[r,i]=(0,t.useState)("Unknown"),s=J(),o=Z(),a=new URLSearchParams(s.search).get("id");if((0,t.useEffect)((()=>{const e=async e=>{if(e){const t=Rp(Ky,"users",e),n=await Tg(t);if(n.exists()){const e=n.data();i(e.displayName||"Unknown")}}};(async()=>{if(a){const t=Rp(Ky,"recipes",a),r=await Tg(t);if(r.exists()){const t=r.data();n(t),e(t.creatorId)}else console.log("No such document!")}})()}),[a]),!e)return(0,e_.jsx)("div",{children:"Loading..."});let l="Invalid Date";if(e.createdAt){const t="string"===typeof e.createdAt?parseInt(e.createdAt,10):e.createdAt,n=new Date(t);isNaN(n.getTime())||(l=n.toLocaleString())}return(0,e_.jsxs)("div",{children:[(0,e_.jsx)("h2",{children:e.displayName||e.baseName}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Created At:"})," ",l]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Creator:"})," ",r]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Status:"})," ",e.status]}),(0,e_.jsxs)("div",{className:"recipe-details",children:[(0,e_.jsx)("h3",{children:"Ingredients:"}),e.recipe&&Object.keys(e.recipe).length>0?Object.keys(e.recipe).map(((t,n)=>(0,e_.jsxs)("div",{children:[(0,e_.jsxs)("h4",{children:[t.charAt(0).toUpperCase()+t.slice(1)," Phase"]}),(0,e_.jsx)("ul",{children:Object.keys(e.recipe[t].ingredients||{}).map((t=>(0,e_.jsxs)("li",{children:[t,": ",e.rawRecipe&&e.rawRecipe[t]?parseFloat(e.rawRecipe[t]).toFixed(2):"0.00","%"]},t)))})]},n))):(0,e_.jsx)("p",{children:"No ingredients listed."})]}),(0,e_.jsx)("button",{onClick:()=>o("/order-formulation",{state:{recipeId:a}}),children:"Order Formulation"})]})},S_="@firebase/database",E_="1.0.4";let C_="";function T_(e){C_=e}class I_{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),rt(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:nt(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class x_{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return st(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const R_=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new I_(t)}}catch(AE){}return new x_},N_=R_("localStorage"),P_=R_("sessionStorage"),A_=new Nt("@firebase/database"),O_=function(){let e=1;return function(){return e++}}(),D_=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,Pe(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new pt;n.update(t);const r=n.digest();return De.encodeByteArray(r)},L_=function(){let e="";for(let t=0;t<arguments.length;t++){const n=t<0||arguments.length<=t?void 0:arguments[t];Array.isArray(n)||n&&"object"===typeof n&&"number"===typeof n.length?e+=L_.apply(null,n):e+="object"===typeof n?rt(n):n,e+=" "}return e};let F_=null,M_=!0;const j_=function(e,t){Pe(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(A_.logLevel=Ct.VERBOSE,F_=A_.log.bind(A_),t&&P_.set("logging_enabled",!0)):"function"===typeof e?F_=e:(F_=null,P_.remove("logging_enabled"))},U_=function(){if(!0===M_&&(M_=!1,null===F_&&!0===P_.get("logging_enabled")&&j_(!0)),F_){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=L_.apply(null,t);F_(r)}},q_=function(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];U_(e,...n)}},V_=function(){const e="FIREBASE INTERNAL ERROR: "+L_(...arguments);A_.error(e)},z_=function(){const e="FIREBASE FATAL ERROR: ".concat(L_(...arguments));throw A_.error(e),new Error(e)},B_=function(){const e="FIREBASE WARNING: "+L_(...arguments);A_.warn(e)},H_=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},W_="[MIN_NAME]",G_="[MAX_NAME]",$_=function(e,t){if(e===t)return 0;if(e===W_||t===G_)return-1;if(t===W_||e===G_)return 1;{const n=tb(e),r=tb(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},K_=function(e,t){return e===t?0:e<t?-1:1},Q_=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+rt(t))},Y_=function(e){if("object"!==typeof e||null===e)return rt(e);const t=[];for(const r in e)t.push(r);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=rt(t[r]),n+=":",n+=Y_(e[t[r]]);return n+="}",n},J_=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function X_(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const Z_=function(e){Pe(!H_(e),"Invalid JSON number");const t=1023;let n,r,i,s,o;0===e?(r=0,i=0,n=1/e===-1/0?1:0):(n=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(e)/Math.LN2),t),r=s+t,i=Math.round(e*Math.pow(2,52-s)-Math.pow(2,52))):(r=0,i=Math.round(e/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(o=0;o<64;o+=8){let e=parseInt(l.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),c+=e}return c.toLowerCase()};const eb=new RegExp("^-?(0*)\\d{1,10}$"),tb=function(e){if(eb.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},nb=function(e){try{e()}catch(AE){setTimeout((()=>{const t=AE.stack||"";throw B_("Exception was thrown by user callback.",t),AE}),Math.floor(0))}},rb=function(e,t){const n=setTimeout(e,t);return"number"===typeof n&&"undefined"!==typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"===typeof n&&n.unref&&n.unref(),n};class ib{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null===t||void 0===t?void 0:t.getImmediate({optional:!0}),this.appCheck||null===t||void 0===t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){B_('Provided AppCheck credentials for the app named "'.concat(this.appName_,'" ')+"are invalid. This usually indicates your app was not initialized correctly.")}}class sb{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(U_("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',B_(e)}}class ob{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ob.OWNER="owner";const ab="5",lb=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,cb="ac",ub="websocket",hb="long_polling";class db{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],a=arguments.length>7&&void 0!==arguments[7]&&arguments[7];this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=N_.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&N_.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns=".concat(this.namespace):"";return"".concat(e).concat(this.host,"/").concat(t)}}function fb(e,t,n){let r;if(Pe("string"===typeof t,"typeof type must == string"),Pe("object"===typeof n,"typeof params must == object"),t===ub)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==hb)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return X_(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class pb{constructor(){this.counters_={}}incrementCounter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;st(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return Ue(this.counters_)}}const gb={},mb={};function vb(e){const t=e.toString();return gb[t]||(gb[t]=new pb),gb[t]}class yb{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&nb((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const _b="start";class bb{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=q_(e),this.stats_=vb(t),this.urlFn=e=>(this.appCheckToken&&(e[cb]=this.appCheckToken),fb(t,hb,e))}open(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new yb(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Ye()||"complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new wb((function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s,o,a,l]=t;if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===_b)n.id=s,n.password=o;else{if("close"!==i)throw new Error("Unrecognized command received: "+i);s?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(s,(()=>{n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[i,s]=t;n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,s)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[_b]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=ab,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[cb]=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&lb.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){bb.forceAllow_=!0}static forceDisallow(){bb.forceDisallow_=!0}static isAvailable(){return!Ye()&&(!!bb.forceAllow_||!bb.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=rt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Fe(t),r=J_(n,1840);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if(Ye())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=rt(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class wb{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Ye())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=O_(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=wb.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){n='<script>document.domain="'+document.domain+'";<\/script>'}const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(AE){U_("frame writing exception"),AE.stack&&U_(AE.stack),U_(AE)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||U_("No IE domain setting required")}catch(AE){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){Ye()?this.doNodeLongPoll(e,t):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{U_("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(AE){}}),Math.floor(1))}}let kb=null;"undefined"!==typeof MozWebSocket?kb=MozWebSocket:"undefined"!==typeof WebSocket&&(kb=WebSocket);class Sb{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=q_(this.connId),this.stats_=vb(t),this.connURL=Sb.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const s={};return s.v=ab,!Ye()&&"undefined"!==typeof location&&location.hostname&&lb.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s[cb]=r),i&&(s.p=i),fb(e,ub,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,N_.set("previous_websocket_failure",!0);try{let e;if(Ye()){const t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":"Firebase/".concat(ab,"/").concat(C_,"/").concat(process.platform,"/").concat(t),"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization="Bearer ".concat(this.authToken)),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0},r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new kb(this.connURL,[],e)}catch(AE){this.log_("Error instantiating WebSocket.");const t=AE.message||AE.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Sb.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==kb&&!Sb.forceDisallow_}static previouslyFailed(){return N_.isInMemoryStorage||!0===N_.get("previous_websocket_failure")}markConnectionHealthy(){N_.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=nt(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Pe(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=rt(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=J_(t,16384);n.length>1&&this.sendString_(String(n.length));for(let r=0;r<n.length;r++)this.sendString_(n[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(AE){this.log_("Exception thrown from WebSocket.send():",AE.message||AE.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Sb.responsesRequiredToBeHealthy=2,Sb.healthyTimeout=3e4;class Eb{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[bb,Sb]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Sb&&Sb.isAvailable();let n=t&&!Sb.previouslyFailed();if(e.webSocketOnly&&(t||B_("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Sb];else{const e=this.transports_=[];for(const t of Eb.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);Eb.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Eb.globalTransportInitialized_=!1;class Cb{constructor(e,t,n,r,i,s,o,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=q_("c:"+this.id+":"),this.transportManager_=new Eb(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=rb((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Q_("t",e),n=Q_("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Q_("t",e),n=Q_("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Q_("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?V_("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):V_("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),ab!==n&&B_("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),rb((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):rb((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(N_.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Tb{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class Ib{constructor(e){this.allowedEvents_=e,this.listeners_={},Pe(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e){if(Array.isArray(this.listeners_[e])){const i=[...this.listeners_[e]];for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(let e=0;e<i.length;e++)i[e].callback.apply(i[e].context,n)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)}validateEventType_(e){Pe(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class xb extends Ib{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Ke()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new xb}getInitialEvent(e){return Pe("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}const Rb=32,Nb=768;class Pb{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Ab(){return new Pb("")}function Ob(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Db(e){return e.pieces_.length-e.pieceNum_}function Lb(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Pb(e.pieces_,t)}function Fb(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function Mb(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.pieces_.slice(e.pieceNum_+t)}function jb(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Pb(t,0)}function Ub(e,t){const n=[];for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof Pb)for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Pb(n,0)}function qb(e){return e.pieceNum_>=e.pieces_.length}function Vb(e,t){const n=Ob(e),r=Ob(t);if(null===n)return t;if(n===r)return Vb(Lb(e),Lb(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function zb(e,t){if(Db(e)!==Db(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Bb(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Db(e)>Db(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Hb{constructor(e,t){this.errorPrefix_=t,this.parts_=Mb(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=yt(this.parts_[n]);Wb(this)}}function Wb(e){if(e.byteLength_>Nb)throw new Error(e.errorPrefix_+"has a key path longer than "+Nb+" bytes ("+e.byteLength_+").");if(e.parts_.length>Rb)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+Rb+") or object contains a cycle "+Gb(e))}function Gb(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class $b extends Ib{constructor(){let e,t;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(t="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(t="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new $b}getInitialEvent(e){return Pe("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Kb=1e3;class Qb extends Tb{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=Qb.nextPersistentConnectionId_++,this.log_=q_("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Kb,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!Ye())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");$b.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&xb.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(rt(i)),Pe(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new Ge,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),Pe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Pe(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");const o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const s=i.d,o=i.s;Qb.warnOnListenWarnings_(s,t);(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))}))}static warnOnListenWarnings_(e,t){if(e&&"object"===typeof e&&st(e,"w")){const n=ot(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();B_("Using an unspecified index. Your data will be downloaded and "+"filtered on the client. Consider adding ".concat(e," at ")+"".concat(n," to your security rules for better performance."))}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=it(e).claims;return"object"===typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=it(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Pe(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+rt(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):V_("Unrecognized action received from server: "+rt(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Pe(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Kb,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Kb,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Kb),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Qb.nextConnectionId_++,i=this.lastSessionId;let s=!1,o=null;const a=function(){o?o.close():(s=!0,n())},l=function(e){Pe(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);s?U_("getToken() completed but was canceled"):(U_("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,o=new Cb(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{B_(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(V_){this.log_("Failed to get token: "+V_),s||(this.repoInfo_.nodeAdmin&&B_(V_),a())}}}interrupt(e){U_("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){U_("Resuming connection for reason: "+e),delete this.interruptReasons_[e],at(this.interruptReasons_)&&(this.reconnectDelay_=Kb,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Y_(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Pb(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){U_("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){U_("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";Ye()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+C_.replace(/\./g,"-")]=1,Ke()?e["framework.cordova"]=1:Qe()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=xb.getInstance().currentlyOnline();return at(this.interruptReasons_)&&e}}Qb.nextPersistentConnectionId_=0,Qb.nextConnectionId_=0;class Yb{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Yb(e,t)}}class Jb{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Yb(W_,e),r=new Yb(W_,t);return 0!==this.compare(n,r)}minPost(){return Yb.MIN}}let Xb;class Zb extends Jb{static get __EMPTY_NODE(){return Xb}static set __EMPTY_NODE(e){Xb=e}compare(e,t){return $_(e.name,t.name)}isDefinedOn(e){throw Ae("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Yb.MIN}maxPost(){return new Yb(G_,Xb)}makePost(e,t){return Pe("string"===typeof e,"KeyIndex indexValue must always be a string."),new Yb(e,Xb)}toString(){return".key"}}const ew=new Zb;class tw{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else{if(0===s){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class nw{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:nw.RED,this.left=null!=r?r:rw.EMPTY_NODE,this.right=null!=i?i:rw.EMPTY_NODE}copy(e,t,n,r,i){return new nw(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return rw.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return rw.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,nw.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,nw.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}nw.RED=!0,nw.BLACK=!1;class rw{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rw.EMPTY_NODE;this.comparator_=e,this.root_=t}insert(e,t){return new rw(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,nw.BLACK,null,null))}remove(e){return new rw(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,nw.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new tw(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new tw(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new tw(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new tw(this.root_,null,this.comparator_,!0,e)}}function iw(e,t){return $_(e.name,t.name)}function sw(e,t){return $_(e,t)}let ow;rw.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new nw(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const aw=function(e){return"number"===typeof e?"number:"+Z_(e):"string:"+e},lw=function(e){if(e.isLeafNode()){const t=e.val();Pe("string"===typeof t||"number"===typeof t||"object"===typeof t&&st(t,".sv"),"Priority must be a string or number.")}else Pe(e===ow||e.isEmpty(),"priority of unexpected type.");Pe(e===ow||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let cw,uw,hw;class dw{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dw.__childrenNodeConstructor.EMPTY_NODE;this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Pe(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),lw(this.priorityNode_)}static set __childrenNodeConstructor(e){cw=e}static get __childrenNodeConstructor(){return cw}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new dw(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:dw.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return qb(e)?this:".priority"===Ob(e)?this.priorityNode_:dw.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:dw.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Ob(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Pe(".priority"!==n||1===Db(e),".priority must be the last token in a path"),this.updateImmediateChild(n,dw.__childrenNodeConstructor.EMPTY_NODE.updateChild(Lb(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+aw(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?Z_(this.value_):this.value_,this.lazyHash_=D_(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===dw.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof dw.__childrenNodeConstructor?-1:(Pe(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=dw.VALUE_TYPE_ORDER.indexOf(t),i=dw.VALUE_TYPE_ORDER.indexOf(n);return Pe(r>=0,"Unknown leaf type: "+t),Pe(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}dw.VALUE_TYPE_ORDER=["object","boolean","number","string"];const fw=new class extends Jb{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?$_(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Yb.MIN}maxPost(){return new Yb(G_,new dw("[PRIORITY-POST]",hw))}makePost(e,t){const n=uw(e);return new Yb(t,new dw("[PRIORITY-POST]",n))}toString(){return".priority"}},pw=Math.log(2);class gw{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/pw,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const mw=function(e,t,n,r){e.sort(t);const i=function(t,r){const s=r-t;let o,a;if(0===s)return null;if(1===s)return o=e[t],a=n?n(o):o,new nw(a,o.node,nw.BLACK,null,null);{const l=parseInt(s/2,10)+t,c=i(t,l),u=i(l+1,r);return o=e[l],a=n?n(o):o,new nw(a,o.node,nw.BLACK,c,u)}},s=function(t){let r=null,s=null,o=e.length;const a=function(t,r){const s=o-t,a=o;o-=t;const c=i(s+1,a),u=e[s],h=n?n(u):u;l(new nw(h,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,nw.BLACK):(a(r,nw.BLACK),a(r,nw.RED))}return s}(new gw(e.length));return new rw(r||t,s)};let vw;const yw={};class _w{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Pe(yw&&fw,"ChildrenNode.ts has not been loaded"),vw=vw||new _w({".priority":yw},{".priority":fw}),vw}get(e){const t=ot(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof rw?t:null}hasIndex(e){return st(this.indexSet_,e.toString())}addIndex(e,t){Pe(e!==ew,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Yb.Wrap);let s,o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),n.push(o),o=i.getNext();s=r?mw(n,e.getCompare()):yw;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=s,new _w(c,l)}addToIndexes(e,t){const n=lt(this.indexes_,((n,r)=>{const i=ot(this.indexSet_,r);if(Pe(i,"Missing index implementation for "+r),n===yw){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Yb.Wrap);let s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),mw(n,i.getCompare())}return yw}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Yb(e.name,r))),i.insert(e,e.node)}}));return new _w(n,this.indexSet_)}removeFromIndexes(e,t){const n=lt(this.indexes_,(n=>{if(n===yw)return n;{const r=t.get(e.name);return r?n.remove(new Yb(e.name,r)):n}}));return new _w(n,this.indexSet_)}}let bw;class ww{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&lw(this.priorityNode_),this.children_.isEmpty()&&Pe(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return bw||(bw=new ww(new rw(sw),null,_w.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||bw}updatePriority(e){return this.children_.isEmpty()?this:new ww(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?bw:t}}getChild(e){const t=Ob(e);return null===t?this:this.getImmediateChild(t).getChild(Lb(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Pe(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Yb(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const s=r.isEmpty()?bw:this.priorityNode_;return new ww(r,s,i)}}updateChild(e,t){const n=Ob(e);if(null===n)return t;{Pe(".priority"!==Ob(e)||1===Db(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Lb(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(fw,((s,o)=>{t[s]=o.val(e),n++,i&&ww.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+aw(this.getPriority().val())+":"),this.forEachChild(fw,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":D_(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Yb(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Yb(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Yb(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Yb.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Yb.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===kw?-1:0}withIndex(e){if(e===ew||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new ww(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===ew||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(fw),n=t.getIterator(fw);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===ew?null:this.indexMap_.get(e.toString())}}ww.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const kw=new class extends ww{constructor(){super(new rw(sw),ww.EMPTY_NODE,_w.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ww.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Yb,{MIN:{value:new Yb(W_,ww.EMPTY_NODE)},MAX:{value:new Yb(G_,kw)}}),Zb.__EMPTY_NODE=ww.EMPTY_NODE,dw.__childrenNodeConstructor=ww,ow=kw,function(e){hw=e}(kw);const Sw=!0;function Ew(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e)return ww.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),Pe(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e){return new dw(e,Ew(t))}if(e instanceof Array||!Sw){let n=ww.EMPTY_NODE;return X_(e,((t,r)=>{if(st(e,t)&&"."!==t.substring(0,1)){const e=Ew(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(Ew(t))}{const n=[];let r=!1;if(X_(e,((e,t)=>{if("."!==e.substring(0,1)){const i=Ew(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Yb(e,i)))}})),0===n.length)return ww.EMPTY_NODE;const i=mw(n,iw,(e=>e.name),sw);if(r){const e=mw(n,fw.getCompare());return new ww(i,Ew(t),new _w({".priority":e},{".priority":fw}))}return new ww(i,Ew(t),_w.Default)}}!function(e){uw=e}(Ew);class Cw extends Jb{constructor(e){super(),this.indexPath_=e,Pe(!qb(e)&&".priority"!==Ob(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?$_(e.name,t.name):i}makePost(e,t){const n=Ew(e),r=ww.EMPTY_NODE.updateChild(this.indexPath_,n);return new Yb(t,r)}maxPost(){const e=ww.EMPTY_NODE.updateChild(this.indexPath_,kw);return new Yb(G_,e)}toString(){return Mb(this.indexPath_,0).join("/")}}const Tw=new class extends Jb{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?$_(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Yb.MIN}maxPost(){return Yb.MAX}makePost(e,t){const n=Ew(e);return new Yb(t,n)}toString(){return".value"}};function Iw(e){return{type:"value",snapshotNode:e}}function xw(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Rw(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Nw(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Pw{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=fw}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Pe(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Pe(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:W_}hasEnd(){return this.endSet_}getIndexEndValue(){return Pe(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Pe(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:G_}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Pe(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===fw}copy(){const e=new Pw;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Aw(e){const t={};if(e.isDefault())return t;let n;if(e.index_===fw?n="$priority":e.index_===Tw?n="$value":e.index_===ew?n="$key":(Pe(e.index_ instanceof Cw,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=rt(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=rt(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+rt(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=rt(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+rt(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Ow(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==fw&&(t.i=e.index_.toString()),t}class Dw extends Tb{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=q_("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Pe(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const s=Dw.getListenId_(e,n),o={};this.listens_[s]=o;const a=Aw(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),ot(this.listens_,s)===o){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=Dw.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Aw(e._queryParams),n=e._path.toString(),r=new Ge;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((r=>{let[i,s]=r;i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ht(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=nt(a.responseText)}catch(AE){B_("Failed to parse JSON response for "+o+": "+a.responseText)}n(null,e)}else 401!==a.status&&404!==a.status&&B_("Got unsuccessful REST response for "+o+" Status: "+a.status),n(a.status);n=null}},a.open("GET",o,!0),a.send()}))}}class Lw{constructor(){this.rootNode_=ww.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function Fw(){return{value:null,children:new Map}}function Mw(e,t,n){if(qb(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Ob(t);e.children.has(r)||e.children.set(r,Fw());Mw(e.children.get(r),t=Lb(t),n)}}function jw(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{jw(r,new Pb(t.toString()+"/"+e),n)}))}class Uw{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&X_(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class qw{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Uw(e);const n=1e4+2e4*Math.random();rb(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;X_(e,((e,r)=>{r>0&&st(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),rb(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Vw;function zw(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Vw||(Vw={}));class Bw{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Vw.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(qb(this.path)){if(null!=this.affectedTree.value)return Pe(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Pb(e));return new Bw(Ab(),t,this.revert)}}return Pe(Ob(this.path)===e,"operationForChild called for unrelated child."),new Bw(Lb(this.path),this.affectedTree,this.revert)}}class Hw{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Vw.OVERWRITE}operationForChild(e){return qb(this.path)?new Hw(this.source,Ab(),this.snap.getImmediateChild(e)):new Hw(this.source,Lb(this.path),this.snap)}}class Ww{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Vw.MERGE}operationForChild(e){if(qb(this.path)){const t=this.children.subtree(new Pb(e));return t.isEmpty()?null:t.value?new Hw(this.source,Ab(),t.value):new Ww(this.source,Ab(),t)}return Pe(Ob(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Ww(this.source,Lb(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Gw{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(qb(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ob(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function $w(e,t,n,r,i,s){const o=r.filter((e=>e.type===n));o.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Ae("Should only compare child_ events.");const r=new Yb(t.childName,t.snapshotNode),i=new Yb(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),o.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,s);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Kw(e,t){return{eventCache:e,serverCache:t}}function Qw(e,t,n,r){return Kw(new Gw(t,n,r),e.serverCache)}function Yw(e,t,n,r){return Kw(e.eventCache,new Gw(t,n,r))}function Jw(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Xw(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let Zw;class ek{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(Zw||(Zw=new rw(K_)),Zw);this.value=e,this.children=t}static fromObject(e){let t=new ek(null);return X_(e,((e,n)=>{t=t.set(new Pb(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Ab(),value:this.value};if(qb(e))return null;{const n=Ob(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Lb(e),t);if(null!=i){return{path:Ub(new Pb(n),i.path),value:i.value}}return null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(qb(e))return this;{const t=Ob(e),n=this.children.get(t);return null!==n?n.subtree(Lb(e)):new ek(null)}}set(e,t){if(qb(e))return new ek(t,this.children);{const n=Ob(e),r=(this.children.get(n)||new ek(null)).set(Lb(e),t),i=this.children.insert(n,r);return new ek(this.value,i)}}remove(e){if(qb(e))return this.children.isEmpty()?new ek(null):new ek(null,this.children);{const t=Ob(e),n=this.children.get(t);if(n){const r=n.remove(Lb(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new ek(null):new ek(this.value,i)}return this}}get(e){if(qb(e))return this.value;{const t=Ob(e),n=this.children.get(t);return n?n.get(Lb(e)):null}}setTree(e,t){if(qb(e))return t;{const n=Ob(e),r=(this.children.get(n)||new ek(null)).setTree(Lb(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new ek(this.value,i)}}fold(e){return this.fold_(Ab(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_(Ub(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Ab(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(qb(e))return null;{const r=Ob(e),i=this.children.get(r);return i?i.findOnPath_(Lb(e),Ub(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Ab(),t)}foreachOnPath_(e,t,n){if(qb(e))return this;{this.value&&n(t,this.value);const r=Ob(e),i=this.children.get(r);return i?i.foreachOnPath_(Lb(e),Ub(t,r),n):new ek(null)}}foreach(e){this.foreach_(Ab(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_(Ub(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class tk{constructor(e){this.writeTree_=e}static empty(){return new tk(new ek(null))}}function nk(e,t,n){if(qb(t))return new tk(new ek(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let s=r.value;const o=Vb(i,t);return s=s.updateChild(o,n),new tk(e.writeTree_.set(i,s))}{const r=new ek(n),i=e.writeTree_.setTree(t,r);return new tk(i)}}}function rk(e,t,n){let r=e;return X_(n,((e,n)=>{r=nk(r,Ub(t,e),n)})),r}function ik(e,t){if(qb(t))return tk.empty();{const n=e.writeTree_.setTree(t,new ek(null));return new tk(n)}}function sk(e,t){return null!=ok(e,t)}function ok(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Vb(n.path,t)):null}function ak(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(fw,((e,n)=>{t.push(new Yb(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Yb(e,n.value))})),t}function lk(e,t){if(qb(t))return e;{const n=ok(e,t);return new tk(null!=n?new ek(n):e.writeTree_.subtree(t))}}function ck(e){return e.writeTree_.isEmpty()}function uk(e,t){return hk(Ab(),e.writeTree_,t)}function hk(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(Pe(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=hk(Ub(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Ub(e,".priority"),r)),n}}function dk(e,t){return Ck(t,e)}function fk(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));Pe(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){const t=e.allWrites[o];t.visible&&(o>=n&&pk(t,r.path)?i=!1:Bb(r.path,t.path)&&(s=!0)),o--}if(i){if(s)return function(e){e.visibleWrites=mk(e.allWrites,gk,Ab()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;if(r.snap)e.visibleWrites=ik(e.visibleWrites,r.path);else{X_(r.children,(t=>{e.visibleWrites=ik(e.visibleWrites,Ub(r.path,t))}))}return!0}return!1}function pk(e,t){if(e.snap)return Bb(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Bb(Ub(e.path,n),t))return!0;return!1}function gk(e){return e.visible}function mk(e,t,n){let r=tk.empty();for(let i=0;i<e.length;++i){const s=e[i];if(t(s)){const e=s.path;let t;if(s.snap)Bb(n,e)?(t=Vb(n,e),r=nk(r,t,s.snap)):Bb(e,n)&&(t=Vb(e,n),r=nk(r,Ab(),s.snap.getChild(t)));else{if(!s.children)throw Ae("WriteRecord should have .snap or .children");if(Bb(n,e))t=Vb(n,e),r=rk(r,t,s.children);else if(Bb(e,n))if(t=Vb(e,n),qb(t))r=rk(r,Ab(),s.children);else{const e=ot(s.children,Ob(t));if(e){const n=e.getChild(Lb(t));r=nk(r,Ab(),n)}}}}}return r}function vk(e,t,n,r,i){if(r||i){const s=lk(e.visibleWrites,t);if(!i&&ck(s))return n;if(i||null!=n||sk(s,Ab())){const s=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Bb(e.path,t)||Bb(t,e.path))};return uk(mk(e.allWrites,s,t),n||ww.EMPTY_NODE)}return null}{const r=ok(e.visibleWrites,t);if(null!=r)return r;{const r=lk(e.visibleWrites,t);if(ck(r))return n;if(null!=n||sk(r,Ab())){return uk(r,n||ww.EMPTY_NODE)}return null}}}function yk(e,t,n,r){return vk(e.writeTree,e.treePath,t,n,r)}function _k(e,t){return function(e,t,n){let r=ww.EMPTY_NODE;const i=ok(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(fw,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=lk(e.visibleWrites,t);return n.forEachChild(fw,((e,t)=>{const n=uk(lk(i,new Pb(e)),t);r=r.updateImmediateChild(e,n)})),ak(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return ak(lk(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function bk(e,t,n,r){return function(e,t,n,r,i){Pe(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Ub(t,n);if(sk(e.visibleWrites,s))return null;{const t=lk(e.visibleWrites,s);return ck(t)?i.getChild(n):uk(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function wk(e,t){return function(e,t){return ok(e.visibleWrites,t)}(e.writeTree,Ub(e.treePath,t))}function kk(e,t,n,r,i,s){return function(e,t,n,r,i,s,o){let a;const l=lk(e.visibleWrites,t),c=ok(l,Ab());if(null!=c)a=c;else{if(null==n)return[];a=uk(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,s)}function Sk(e,t,n){return function(e,t,n,r){const i=Ub(t,n),s=ok(e.visibleWrites,i);if(null!=s)return s;if(r.isCompleteForChild(n))return uk(lk(e.visibleWrites,i),r.getNode().getImmediateChild(n));return null}(e.writeTree,e.treePath,t,n)}function Ek(e,t){return Ck(Ub(e.treePath,t),e.writeTree)}function Ck(e,t){return{treePath:e,writeTree:t}}class Tk{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Pe("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Pe(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Nw(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Rw(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,xw(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Ae("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Nw(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Ik=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class xk{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Gw(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Sk(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Xw(this.viewCache_),i=kk(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function Rk(e,t,n,r,i){const s=new Tk;let o,a;if(n.type===Vw.OVERWRITE){const l=n;l.source.fromUser?o=Ak(e,t,l.path,l.snap,r,i,s):(Pe(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!qb(l.path),o=Pk(e,t,l.path,l.snap,r,i,a,s))}else if(n.type===Vw.MERGE){const l=n;l.source.fromUser?o=function(e,t,n,r,i,s,o){let a=t;return r.foreach(((r,l)=>{const c=Ub(n,r);Ok(t,Ob(c))&&(a=Ak(e,a,c,l,i,s,o))})),r.foreach(((r,l)=>{const c=Ub(n,r);Ok(t,Ob(c))||(a=Ak(e,a,c,l,i,s,o))})),a}(e,t,l.path,l.children,r,i,s):(Pe(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),o=Lk(e,t,l.path,l.children,r,i,a,s))}else if(n.type===Vw.ACK_USER_WRITE){const a=n;o=a.revert?function(e,t,n,r,i,s){let o;if(null!=wk(r,n))return t;{const a=new xk(r,t,i),l=t.eventCache.getNode();let c;if(qb(n)||".priority"===Ob(n)){let n;if(t.serverCache.isFullyInitialized())n=yk(r,Xw(t));else{const e=t.serverCache.getNode();Pe(e instanceof ww,"serverChildren would be complete if leaf node"),n=_k(r,e)}c=e.filter.updateFullNode(l,n,s)}else{const i=Ob(n);let u=Sk(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=l.getImmediateChild(i)),c=null!=u?e.filter.updateChild(l,i,u,Lb(n),a,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,ww.EMPTY_NODE,Lb(n),a,s):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(o=yk(r,Xw(t)),o.isLeafNode()&&(c=e.filter.updateFullNode(c,o,s)))}return o=t.serverCache.isFullyInitialized()||null!=wk(r,Ab()),Qw(t,c,o,e.filter.filtersNodes())}}(e,t,a.path,r,i,s):function(e,t,n,r,i,s,o){if(null!=wk(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(qb(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Pk(e,t,n,l.getNode().getChild(n),i,s,a,o);if(qb(n)){let r=new ek(null);return l.getNode().forEachChild(ew,((e,t)=>{r=r.set(new Pb(e),t)})),Lk(e,t,n,r,i,s,a,o)}return t}{let c=new ek(null);return r.foreach(((e,t)=>{const r=Ub(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))})),Lk(e,t,n,c,i,s,a,o)}}(e,t,a.path,a.affectedTree,r,i,s)}else{if(n.type!==Vw.LISTEN_COMPLETE)throw Ae("Unknown operation type: "+n.type);o=function(e,t,n,r,i){const s=t.serverCache,o=Yw(t,s.getNode(),s.isFullyInitialized()||qb(n),s.isFiltered());return Nk(e,o,n,r,Ik,i)}(e,t,n.path,r,s)}const l=s.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Jw(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(Iw(Jw(t)))}}(t,o,l),{viewCache:o,changes:l}}function Nk(e,t,n,r,i,s){const o=t.eventCache;if(null!=wk(r,n))return t;{let a,l;if(qb(n))if(Pe(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=Xw(t),i=_k(r,n instanceof ww?n:ww.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,s)}else{const n=yk(r,Xw(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}else{const c=Ob(n);if(".priority"===c){Pe(1===Db(n),"Can't have a priority with additional path components");const i=o.getNode();l=t.serverCache.getNode();const s=bk(r,n,i,l);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{const u=Lb(n);let h;if(o.isCompleteForChild(c)){l=t.serverCache.getNode();const e=bk(r,n,o.getNode(),l);h=null!=e?o.getNode().getImmediateChild(c).updateChild(u,e):o.getNode().getImmediateChild(c)}else h=Sk(r,c,t.serverCache);a=null!=h?e.filter.updateChild(o.getNode(),c,h,u,i,s):o.getNode()}}return Qw(t,a,o.isFullyInitialized()||qb(n),e.filter.filtersNodes())}}function Pk(e,t,n,r,i,s,o,a){const l=t.serverCache;let c;const u=o?e.filter:e.filter.getIndexedFilter();if(qb(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=Ob(n);if(!l.isCompleteForPath(n)&&Db(n)>1)return t;const i=Lb(n),s=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),s):u.updateChild(l.getNode(),e,s,i,Ik,null)}const h=Yw(t,c,l.isFullyInitialized()||qb(n),u.filtersNodes());return Nk(e,h,n,i,new xk(i,h,s),a)}function Ak(e,t,n,r,i,s,o){const a=t.eventCache;let l,c;const u=new xk(i,t,s);if(qb(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,o),l=Qw(t,c,!0,e.filter.filtersNodes());else{const i=Ob(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=Qw(t,c,a.isFullyInitialized(),a.isFiltered());else{const s=Lb(n),c=a.getNode().getImmediateChild(i);let h;if(qb(s))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Fb(s)&&e.getChild(jb(s)).isEmpty()?e:e.updateChild(s,r):ww.EMPTY_NODE}if(c.equals(h))l=t;else{l=Qw(t,e.filter.updateChild(a.getNode(),i,h,s,u,o),a.isFullyInitialized(),e.filter.filtersNodes())}}}return l}function Ok(e,t){return e.eventCache.isCompleteForChild(t)}function Dk(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function Lk(e,t,n,r,i,s,o,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=qb(n)?r:new ek(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const l=Dk(0,t.serverCache.getNode().getImmediateChild(n),r);c=Pk(e,c,new Pb(n),l,i,s,o,a)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!l){const l=Dk(0,t.serverCache.getNode().getImmediateChild(n),r);c=Pk(e,c,new Pb(n),l,i,s,o,a)}})),c}function Fk(e,t){const n=Xw(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!qb(t)&&!n.getImmediateChild(Ob(t)).isEmpty())?n.getChild(t):null}function Mk(e,t,n,r){t.type===Vw.MERGE&&null!==t.source.queryId&&(Pe(Xw(e.viewCache_),"We should always have a full cache before handling merges"),Pe(Jw(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,s=Rk(e.processor_,i,t,n,r);var o,a;return o=e.processor_,a=s.viewCache,Pe(a.eventCache.getNode().isIndexed(o.filter.getIndex()),"Event snap not indexed"),Pe(a.serverCache.getNode().isIndexed(o.filter.getIndex()),"Server snap not indexed"),Pe(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=s.viewCache,jk(e,s.changes,s.viewCache.eventCache.getNode(),null)}function jk(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],s=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),$w(e,i,"child_removed",t,r,n),$w(e,i,"child_added",t,r,n),$w(e,i,"child_moved",s,r,n),$w(e,i,"child_changed",t,r,n),$w(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Uk,qk;function Vk(e,t,n,r){const i=t.source.queryId;if(null!==i){const s=e.views.get(i);return Pe(null!=s,"SyncTree gave us an op for an invalid query."),Mk(s,t,n,r)}{let i=[];for(const s of e.views.values())i=i.concat(Mk(s,t,n,r));return i}}function zk(e,t){let n=null;for(const r of e.views.values())n=n||Fk(r,t);return n}class Bk{constructor(e){this.listenProvider_=e,this.syncPointTree_=new ek(null),this.pendingWriteTree_={visibleWrites:tk.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function Hk(e,t,n,r,i){return function(e,t,n,r,i){Pe(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=nk(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?Qk(e,new Hw({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function Wk(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(fk(e.pendingWriteTree_,t)){let t=new ek(null);return null!=r.snap?t=t.set(Ab(),!0):X_(r.children,(e=>{t=t.set(new Pb(e),!0)})),Qk(e,new Bw(r.path,t,n))}return[]}function Gk(e,t,n){return Qk(e,new Hw({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function $k(e,t,n,r){const i=Xk(e,r);if(null!=i){const r=Zk(i),s=r.path,o=r.queryId,a=Vb(s,t);return eS(e,s,new Hw(zw(o),a,n))}return[]}function Kk(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=zk(n,Vb(e,t));if(r)return r}));return vk(r,t,i,n,!0)}function Qk(e,t){return Yk(t,e.syncPointTree_,null,dk(e.pendingWriteTree_,Ab()))}function Yk(e,t,n,r){if(qb(e.path))return Jk(e,t,n,r);{const i=t.get(Ab());null==n&&null!=i&&(n=zk(i,Ab()));let s=[];const o=Ob(e.path),a=e.operationForChild(o),l=t.children.get(o);if(l&&a){const e=n?n.getImmediateChild(o):null,t=Ek(r,o);s=s.concat(Yk(a,l,e,t))}return i&&(s=s.concat(Vk(i,e,r,n))),s}}function Jk(e,t,n,r){const i=t.get(Ab());null==n&&null!=i&&(n=zk(i,Ab()));let s=[];return t.children.inorderTraversal(((t,i)=>{const o=n?n.getImmediateChild(t):null,a=Ek(r,t),l=e.operationForChild(t);l&&(s=s.concat(Jk(l,i,o,a)))})),i&&(s=s.concat(Vk(i,e,r,n))),s}function Xk(e,t){return e.tagToQueryMap.get(t)}function Zk(e){const t=e.indexOf("$");return Pe(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Pb(e.substr(0,t))}}function eS(e,t,n){const r=e.syncPointTree_.get(t);Pe(r,"Missing sync point for query tag that we're tracking");return Vk(r,n,dk(e.pendingWriteTree_,t),null)}class tS{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new tS(t)}node(){return this.node_}}class nS{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Ub(this.path_,e);return new nS(this.syncTree_,t)}node(){return Kk(this.syncTree_,this.path_)}}const rS=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},iS=function(e,t,n){return e&&"object"===typeof e?(Pe(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?sS(e[".sv"],t,n):"object"===typeof e[".sv"]?oS(e[".sv"],t):void Pe(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},sS=function(e,t,n){if("timestamp"===e)return n.timestamp;Pe(!1,"Unexpected server value: "+e)},oS=function(e,t,n){e.hasOwnProperty("increment")||Pe(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!==typeof r&&Pe(!1,"Unexpected increment value: "+r);const i=t.node();if(Pe(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const s=i.getValue();return"number"!==typeof s?r:s+r},aS=function(e,t,n,r){return cS(t,new nS(n,e),r)},lS=function(e,t,n){return cS(e,new tS(t),n)};function cS(e,t,n){const r=e.getPriority().val(),i=iS(r,t.getImmediateChild(".priority"),n);let s;if(e.isLeafNode()){const r=e,s=iS(r.getValue(),t,n);return s!==r.getValue()||i!==r.getPriority().val()?new dw(s,Ew(i)):e}{const r=e;return s=r,i!==r.getPriority().val()&&(s=s.updatePriority(new dw(i))),r.forEachChild(fw,((e,r)=>{const i=cS(r,t.getImmediateChild(e),n);i!==r&&(s=s.updateImmediateChild(e,i))})),s}}class uS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{children:{},childCount:0};this.name=e,this.parent=t,this.node=n}}function hS(e,t){let n=t instanceof Pb?t:new Pb(t),r=e,i=Ob(n);for(;null!==i;){const e=ot(r.node.children,i)||{children:{},childCount:0};r=new uS(i,r,e),n=Lb(n),i=Ob(n)}return r}function dS(e){return e.node.value}function fS(e,t){e.node.value=t,yS(e)}function pS(e){return e.node.childCount>0}function gS(e,t){X_(e.node.children,((n,r)=>{t(new uS(n,e,r))}))}function mS(e,t,n,r){n&&!r&&t(e),gS(e,(e=>{mS(e,t,!0,r)})),n&&r&&t(e)}function vS(e){return new Pb(null===e.parent?e.name:vS(e.parent)+"/"+e.name)}function yS(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===dS(e)&&!pS(e)}(n),i=st(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,yS(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,yS(e))}(e.parent,e.name,e)}const _S=/[\[\].#$\/\u0000-\u001F\u007F]/,bS=/[\[\].#$\u0000-\u001F\u007F]/,wS=10485760,kS=function(e){return"string"===typeof e&&0!==e.length&&!_S.test(e)},SS=function(e){return"string"===typeof e&&0!==e.length&&!bS.test(e)},ES=function(e,t,n){const r=n instanceof Pb?new Hb(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Gb(r));if("function"===typeof t)throw new Error(e+"contains a function "+Gb(r)+" with contents = "+t.toString());if(H_(t))throw new Error(e+"contains "+t.toString()+" "+Gb(r));if("string"===typeof t&&t.length>wS/3&&yt(t)>wS)throw new Error(e+"contains a string greater than "+wS+" utf8 bytes "+Gb(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"===typeof t){let n=!1,i=!1;if(X_(t,((t,s)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!kS(t)))throw new Error(e+" contains an invalid key ("+t+") "+Gb(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=yt(t),Wb(e)}(r,t),ES(e,s,r),function(e){const t=e.parts_.pop();e.byteLength_-=yt(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Gb(r)+" in addition to actual children.")}},CS=function(e,t){const n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!kS(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),SS(e)}(n))throw new Error(vt(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class TS{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function IS(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],s=i.getPath();null===n||zb(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function xS(e,t,n){IS(e,n),RS(e,(e=>Bb(e,t)||Bb(t,e)))}function RS(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];if(i){t(i.path)?(NS(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}function NS(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();F_&&U_("event: "+n.toString()),nb(r)}}}const PS="repo_interrupt",AS=25;class OS{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new TS,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Fw(),this.transactionQueueTree_=new uS,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function DS(e,t,n){if(e.stats_=vb(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new Dw(e.repoInfo_,((t,n,r,i)=>{MS(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>jS(e,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{rt(n)}catch(AE){throw new Error("Invalid authOverride provided: "+AE)}}e.persistentConnection_=new Qb(e.repoInfo_,t,((t,n,r,i)=>{MS(e,t,n,r,i)}),(t=>{jS(e,t)}),(t=>{!function(e,t){X_(t,((t,n)=>{US(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(e,t){const n=e.toString();return mb[n]||(mb[n]=t()),mb[n]}(e.repoInfo_,(()=>new qw(e.stats_,e.server_))),e.infoData_=new Lw,e.infoSyncTree_=new Bk({startListening:(t,n,r,i)=>{let s=[];const o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=Gk(e.infoSyncTree_,t._path,o),setTimeout((()=>{i("ok")}),0)),s},stopListening:()=>{}}),US(e,"connected",!1),e.serverSyncTree_=new Bk({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const s=i(n,r);xS(e.eventQueue_,t._path,s)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function LS(e){const t=e.infoData_.getNode(new Pb(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function FS(e){return rS({timestamp:LS(e)})}function MS(e,t,n,r,i){e.dataUpdateCount++;const s=new Pb(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i)if(r){const t=lt(n,(e=>Ew(e)));o=function(e,t,n,r){const i=Xk(e,r);if(i){const r=Zk(i),s=r.path,o=r.queryId,a=Vb(s,t),l=ek.fromObject(n);return eS(e,s,new Ww(zw(o),a,l))}return[]}(e.serverSyncTree_,s,t,i)}else{const t=Ew(n);o=$k(e.serverSyncTree_,s,t,i)}else if(r){const t=lt(n,(e=>Ew(e)));o=function(e,t,n){const r=ek.fromObject(n);return Qk(e,new Ww({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,s,t)}else{const t=Ew(n);o=Gk(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=WS(e,s)),xS(e.eventQueue_,a,o)}function jS(e,t){US(e,"connected",t),!1===t&&function(e){zS(e,"onDisconnectEvents");const t=FS(e),n=Fw();jw(e.onDisconnect_,Ab(),((r,i)=>{const s=aS(r,i,e.serverSyncTree_,t);Mw(n,r,s)}));let r=[];jw(n,Ab(),((t,n)=>{r=r.concat(Gk(e.serverSyncTree_,t,n));const i=YS(e,t);WS(e,i)})),e.onDisconnect_=Fw(),xS(e.eventQueue_,Ab(),r)}(e)}function US(e,t,n){const r=new Pb("/.info/"+t),i=Ew(n);e.infoData_.updateSnapshot(r,i);const s=Gk(e.infoSyncTree_,r,i);xS(e.eventQueue_,r,s)}function qS(e){return e.nextWriteId_++}function VS(e){e.persistentConnection_&&e.persistentConnection_.interrupt(PS)}function zS(e){let t="";e.persistentConnection_&&(t=e.persistentConnection_.id+":");for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];U_(t,...r)}function BS(e,t,n){return Kk(e.serverSyncTree_,t,n)||ww.EMPTY_NODE}function HS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.transactionQueueTree_;if(t||QS(e,t),dS(t)){const n=$S(e,t);Pe(n.length>0,"Sending zero length transaction queue");n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=BS(e,t,r);let s=i;const o=i.hash();for(let c=0;c<n.length;c++){const e=n[c];Pe(0===e.status,"tryToSendTransactionQueue_: items in queue should all be run."),e.status=1,e.retryCount++;const r=Vb(t,e.path);s=s.updateChild(r,e.currentOutputSnapshotRaw)}const a=s.val(!0),l=t;e.server_.put(l.toString(),a,(r=>{zS(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(Wk(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();QS(e,hS(e.transactionQueueTree_,t)),HS(e,e.transactionQueueTree_),xS(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)nb(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{B_("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}WS(e,t)}}),o)}(e,vS(t),n)}else pS(t)&&gS(t,(t=>{HS(e,t)}))}function WS(e,t){const n=GS(e,t),r=vS(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const s=t.filter((e=>0===e.status)),o=s.map((e=>e.currentWriteId));for(let l=0;l<t.length;l++){const s=t[l],c=Vb(n,s.path);let u,h=!1;if(Pe(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===s.status)h=!0,u=s.abortReason,i=i.concat(Wk(e.serverSyncTree_,s.currentWriteId,!0));else if(0===s.status)if(s.retryCount>=AS)h=!0,u="maxretry",i=i.concat(Wk(e.serverSyncTree_,s.currentWriteId,!0));else{const n=BS(e,s.path,o);s.currentInputSnapshot=n;const r=t[l].update(n.val());if(void 0!==r){ES("transaction failed: Data returned ",r,s.path);let t=Ew(r);"object"===typeof r&&null!=r&&st(r,".priority")||(t=t.updatePriority(n.getPriority()));const a=s.currentWriteId,l=FS(e),c=lS(t,n,l);s.currentOutputSnapshotRaw=t,s.currentOutputSnapshotResolved=c,s.currentWriteId=qS(e),o.splice(o.indexOf(a),1),i=i.concat(Hk(e.serverSyncTree_,s.path,c,s.currentWriteId,s.applyLocally)),i=i.concat(Wk(e.serverSyncTree_,a,!0))}else h=!0,u="nodata",i=i.concat(Wk(e.serverSyncTree_,s.currentWriteId,!0))}xS(e.eventQueue_,n,i),i=[],h&&(t[l].status=2,a=t[l].unwatcher,setTimeout(a,Math.floor(0)),t[l].onComplete&&("nodata"===u?r.push((()=>t[l].onComplete(null,!1,t[l].currentInputSnapshot))):r.push((()=>t[l].onComplete(new Error(u),!1,null)))))}var a;QS(e,e.transactionQueueTree_);for(let l=0;l<r.length;l++)nb(r[l]);HS(e,e.transactionQueueTree_)}(e,$S(e,n),r),r}function GS(e,t){let n,r=e.transactionQueueTree_;for(n=Ob(t);null!==n&&void 0===dS(r);)r=hS(r,n),n=Ob(t=Lb(t));return r}function $S(e,t){const n=[];return KS(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function KS(e,t,n){const r=dS(t);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);gS(t,(t=>{KS(e,t,n)}))}function QS(e,t){const n=dS(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,fS(t,n.length>0?n:void 0)}gS(t,(t=>{QS(e,t)}))}function YS(e,t){const n=vS(GS(e,t)),r=hS(e.transactionQueueTree_,t);return function(e,t,n){let r=n?e:e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{JS(e,t)})),JS(e,r),mS(r,(t=>{JS(e,t)})),n}function JS(e,t){const n=dS(t);if(n){const r=[];let i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(Pe(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):(Pe(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(Wk(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===s?fS(t,void 0):n.length=s+1,xS(e.eventQueue_,vS(t),i);for(let e=0;e<r.length;e++)nb(r[e])}}const XS=function(e,t){const n=ZS(e),r=n.namespace;"firebase.com"===n.domain&&z_(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||z_("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&B_("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new db(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Pb(n.pathString)}},ZS=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if("string"===typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let e=n[r];try{e=decodeURIComponent(e.replace(/\+/g," "))}catch(AE){}t+="/"+e}return t}(e.substring(u,h)));const d=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):B_("Invalid query segment '".concat(n,"' in query '").concat(e,"'"))}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const f=t.slice(0,c);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},eE="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let e=0;const t=[]}();class tE{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return qb(this._path)?null:Fb(this._path)}get ref(){return new nE(this._repo,this._path)}get _queryIdentifier(){const e=Ow(this._queryParams),t=Y_(e);return"{}"===t?"default":t}get _queryObject(){return Ow(this._queryParams)}isEqual(e){if(!((e=_t(e))instanceof tE))return!1;const t=this._repo===e._repo,n=zb(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class nE extends tE{constructor(e,t){super(e,t,new Pw,!1)}get parent(){const e=jb(this._path);return null===e?null:new nE(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}!function(e){Pe(!Uk,"__referenceConstructor has already been defined"),Uk=e}(nE),function(e){Pe(!qk,"__referenceConstructor has already been defined"),qk=e}(nE);const rE="FIREBASE_DATABASE_EMULATOR_HOST",iE={};let sE=!1;function oE(e,t,n,r,i){let s=r||e.options.databaseURL;void 0===s&&(e.options.projectId||z_("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),U_("Using default host for project ",e.options.projectId),s="".concat(e.options.projectId,"-default-rtdb.firebaseio.com"));let o,a,l=XS(s,i),c=l.repoInfo;"undefined"!==typeof process&&(a={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}[rE]),a?(o=!0,s="http://".concat(a,"?ns=").concat(c.namespace),l=XS(s,i),c=l.repoInfo):o=!l.repoInfo.secure;const u=i&&o?new ob(ob.OWNER):new sb(e.name,e.options,t);CS("Invalid Firebase Database URL",l),qb(l.path)||z_("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=iE[t.name];i||(i={},iE[t.name]=i);let s=i[e.toURLString()];s&&z_("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new OS(e,sE,n,r),i[e.toURLString()]=s,s}(c,e,u,new ib(e.name,n));return new aE(h,e)}class aE{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(DS(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new nE(this._repo,Ab())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(e,t){const n=iE[t];n&&n[e.key]===e||z_("Database ".concat(t,"(").concat(e.repoInfo_,") has already been deleted.")),VS(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&z_("Cannot call "+e+" on a deleted database.")}}Qb.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Qb.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};!function(e){T_(Dn),Rn(new bt("database",((e,t)=>{let{instanceIdentifier:n}=t;return oE(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),n)}),"PUBLIC").setMultipleInstances(!0)),Mn(S_,E_,e),Mn(S_,E_,"esm2017")}();const lE=function(){var e;const n=Z(),{state:r}=m_(),{user:i}=u_(),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(""),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)(!0),[f,p]=(0,t.useState)(!0),[g,m]=(0,t.useState)({street1:"",street2:"",zip:""}),[v,y]=(0,t.useState)(""),[_,b]=(0,t.useState)(""),w=J(),k=null!==(e=w.state)&&void 0!==e&&e.recipeId?w.state.recipeId:r.recipeId,[S,E]=(0,t.useState)(!1);return(0,t.useEffect)((()=>{if(r.rawRecipe&&Object.keys(r.rawRecipe).length>0)o({name:r.recipeName,ingredients:r.rawRecipe});else if(k){(async()=>{const e=Rp(Ky,"formulations",k),t=await Tg(e);t.exists()?o(t.data()):console.log("No such document!")})()}}),[k]),s?(0,e_.jsx)(n_,{title:"Request Your Order",buttonText:"Place Your Order",handleSubmit:()=>{(async()=>{console.log(k),E(!1);try{const e=(new Date).getTime()+"-"+k,t={name:a,recipeId:k,phoneNumber:c,pickup:f,address:f?null:g,createdAt:new Date,devilveredAt:null,waitlist:!h,location:_,note:v,variationRequest:r.variationRequest,status:"Pending"};i&&i.uid&&(t.creatorId=i.uid),await Rg(Rp(Ky,"orders",e),t),console.log("Order submitted"),await Zy({orderId:e}),n("/order-success",{state:{orderId:e}})}catch(e){console.error("Error submitting order: ",e),E(!0)}})()},children:(0,e_.jsxs)("div",{className:"card summary-content",children:[(0,e_.jsxs)("div",{className:"recipe",children:[(0,e_.jsx)("strong",{children:"Recipe Name"}),": ",r.recipeName,Object.keys(s.ingredients).map(((e,t)=>(0,e_.jsxs)("div",{children:[(0,e_.jsx)("strong",{children:e}),": ",s.ingredients[e]]},t)))]}),(0,e_.jsx)("p",{children:"While this service is in development, we are requesting that you donate to the Palestinian Children's Relief Fund in lieu of payment!"}),(0,e_.jsxs)("form",{className:"contact-us-form",children:[(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{children:"Your Name:"}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"text",value:a,onChange:e=>l(e.target.value)})]}),(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{children:"Mobile phone number (We'll text with you to coordinate delivery):"}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"tel",value:c,onChange:e=>u(e.target.value)})]}),(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{children:"Do you want to pick it up from Chris Koss's house (South Beacon Hill in Seattle)?"}),(0,e_.jsx)("br",{}),(0,e_.jsxs)("select",{value:f,onChange:e=>p("true"===e.target.value),children:[(0,e_.jsx)("option",{value:"true",children:"Yes"}),(0,e_.jsx)("option",{value:"false",children:"No"})]}),!f&&(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{children:"Delivery Address:"}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"text",placeholder:"Street 1",value:g.street1,onChange:e=>m({...g,street1:e.target.value})}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"text",placeholder:"Street 2",value:g.street2,onChange:e=>m({...g,street2:e.target.value})}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"text",value:"Seattle",readOnly:!0}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"text",value:"WA",readOnly:!0}),(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{type:"text",placeholder:"Zip Code",value:g.zip,onChange:e=>m({...g,zip:e.target.value})})]})]}),(0,e_.jsx)("label",{children:"Note:"}),(0,e_.jsx)("br",{}),(0,e_.jsx)("textarea",{placeholder:"Enter your note here",value:v,onChange:e=>y(e.target.value)})]}),S&&(0,e_.jsx)("p",{className:"why-disabled",children:"Something went wrong submitting... please try again"})]})}):(0,e_.jsx)("div",{children:"Loading..."})},cE=()=>{const{user:e,loading:n,logout:r}=u_(),{dispatch:i}=m_(),[s,o]=(0,t.useState)(null),[a,l]=(0,t.useState)(!1),c=Z();return(0,t.useEffect)((()=>{console.log("Login: Current user state",e)}),[e]),n?(0,e_.jsx)("div",{children:"Loading..."}):e?(0,e_.jsxs)("div",{children:[(0,e_.jsxs)("p",{children:["Signed in as ",e.displayName]}),(0,e_.jsx)("p",{children:(0,e_.jsx)(Ce,{className:"modern-link",to:"/dashboard",children:"View My Recipes"})}),"chris@mckoss.com"===e.email&&(0,e_.jsx)("p",{children:(0,e_.jsx)(Ce,{className:"modern-link",to:"/admin",children:"Go to Admin Page"})}),(0,e_.jsx)("button",{onClick:r,disabled:a,children:a?"Logging out...":"Logout"})]}):(0,e_.jsxs)("div",{children:[s&&(0,e_.jsx)("p",{style:{color:"red"},children:s}),(0,e_.jsx)("button",{onClick:async()=>{o(null),l(!0);try{console.log("Login: Attempting sign-in with popup");const e=await async function(e,t,n){if(Pn(e.app))return Promise.reject(Vg(e,"operation-not-supported-in-this-environment"));const r=Qm(e);Hg(e,t,mv);const i=Zv(r,n);return new oy(r,"signInViaPopup",t,i).executeNotNull()}(Qy,Yy);await(async e=>{if(!e)return;const{uid:t,email:n,displayName:r,photoURL:i}=e,s={uid:t,displayName:r,photoURL:i,createdAt:new Date,lastLogin:new Date};await Rg(Rp(Ky,"users",t),s,{merge:!0}),await Rg(Rp(Ky,"usersPII",t),{email:n},{merge:!0})})(e.user),e.user&&i({type:"SET_CREATOR_ID",payload:e.user.uid}),c("/dashboard")}catch(s){console.error("Login: Error logging in",s),o("Failed to log in. Please try again.")}finally{l(!1)}},disabled:a,children:a?"Logging in...":"Login with Google"})]})};const uE=function(){const e=J(),{orderId:t}=e.state||{},{user:n}=u_(),r=Z();return(0,e_.jsxs)("div",{className:"order-success body-container",style:{textAlign:"center"},children:[(0,e_.jsx)("h2",{children:"Order Submitted Successfully!"}),(0,e_.jsxs)("div",{className:"card",children:[(0,e_.jsxs)("p",{children:["Your order ID is: ",t]}),(0,e_.jsx)("p",{children:"Please watch for a text message from Chris. We will coordinate the mixing time with you, ensuring that your formulation is mixed within 24 hours of when you receive it for maximum freshness."}),(0,e_.jsxs)("p",{children:["While this service is in development, we are requesting that you donate to the ",(0,e_.jsx)("br",{}),(0,e_.jsx)("a",{href:"https://www.pcrf.net/",children:"Palestinian Children's Relief Fund"})," ",(0,e_.jsx)("br",{}),"in lieu of payment!",(0,e_.jsx)("br",{}),"Suggested donation is $30, but any amount is wonderful!"]}),!n&&(0,e_.jsxs)("div",{children:[(0,e_.jsx)("h3",{children:"Create an Account to Track Your Order"}),(0,e_.jsx)("p",{children:"Sign up now to easily check your order status, reorder your favorite recipes, and get personalized skincare recommendations!"}),(0,e_.jsx)(cE,{})]}),(0,e_.jsx)("p",{children:"Thank you for using our service!"})]}),(0,e_.jsx)("button",{className:"footer-button",onClick:()=>r("/"),children:"Back to Home"})]})},hE=()=>{const[e,n]=(0,t.useState)(""),[r,i]=(0,t.useState)(""),[s,o]=(0,t.useState)(!1);return s?(0,e_.jsxs)("div",{children:[(0,e_.jsxs)("h1",{children:["Thanks for contacting us! ",(0,e_.jsx)("br",{})," We'll get back to you soon!"]}),(0,e_.jsx)("a",{href:"/",children:"Back to home"})]}):(0,e_.jsx)("div",{className:"content-container",children:(0,e_.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{await Pg(xp(Ky,"contact-form-submissions"),{phoneNumber:e,message:r,createdAt:new Date}),o(!0)}catch(V_){console.error("Error adding document: ",V_)}},className:"contact-us-form",children:[(0,e_.jsx)("h2",{children:"Contact Us"}),(0,e_.jsxs)("label",{children:[(0,e_.jsx)("strong",{children:"Phone number"})," (if you'd like us to text you a response): ",(0,e_.jsx)("br",{}),(0,e_.jsx)("input",{className:"input",type:"text",value:e,onChange:e=>n(e.target.value)})]}),(0,e_.jsx)("br",{}),(0,e_.jsxs)("label",{children:[(0,e_.jsx)("strong",{children:"Message:"}),(0,e_.jsx)("br",{}),(0,e_.jsx)("textarea",{className:"big-text-area input",value:r,onChange:e=>i(e.target.value)})]}),(0,e_.jsx)("button",{type:"submit",children:"Submit"})]})})};const dE=function(){const e=J(),[n,r]=(0,t.useState)(null),[i,s]=(0,t.useState)(60),[o,a]=(0,t.useState)([]),[l,c]=(0,t.useState)(""),[u,h]=(0,t.useState)(null),d=o.reduce(((e,t)=>e+t.grams),0),f=o.reduce(((e,t)=>e+t.cost),0),p=n?Object.values(n).reduce(((e,t)=>e+t),0):0;(0,t.useEffect)((()=>{const t=new URLSearchParams(e.search).get("recipeId");(async()=>{if(t)try{const e=await Tg(Rp(Ky,"recipes",t));if(e.exists()){const t=e.data();return console.log("Recipe data:",t),void r(t.rawRecipe)}const n=await Tg(Rp(Ky,"formulations",t));if(n.exists()){const e=n.data().rawRecipe;return console.log("Formulation data:",e),void r(e)}h("Cannot find recipe by ID")}catch(e){console.error("Error fetching recipe:",e),h("Error fetching recipe")}})()}),[e.search]),(0,t.useEffect)((()=>{if(n&&p>0){const e=Object.entries(n).sort(((e,t)=>t[1]-e[1])).map((e=>{let[t,n]=e;const r=n/p*100;return"".concat(t," (").concat(r.toFixed(2),"%)")})).join(", ");c("Base Recipe Ingredients: ".concat(e))}}),[n,p]);const g=(0,t.useCallback)((()=>{if(n){const e=Object.values(n).reduce(((e,t)=>e+t),0),t=Object.entries(n).map((t=>{var n,r;let[s,o]=t;const a=i/e*o;return{name:s,parts:o,grams:a,cost:null!==(n=i_[s])&&void 0!==n&&n.cost_per_g?i_[s].cost_per_g*a:"N/A",type:(null===(r=i_[s])||void 0===r?void 0:r.type)||"Unknown"}}));a(t)}}),[n,i]);return(0,t.useEffect)((()=>{n&&i>0&&g()}),[n,i,g]),u?(0,e_.jsx)("div",{className:"error",children:u}):n?(0,e_.jsxs)("div",{className:"order-pricing",children:[(0,e_.jsx)("h1",{children:"Order Pricing"}),(0,e_.jsx)("input",{type:"number",value:i,onChange:e=>s(Number(e.target.value)),placeholder:"Target Grams"}),(0,e_.jsxs)("table",{children:[(0,e_.jsx)("thead",{children:(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("th",{children:"Parts"}),(0,e_.jsx)("th",{children:"Ingredient"}),(0,e_.jsx)("th",{children:"Type"}),(0,e_.jsx)("th",{children:"Grams"}),(0,e_.jsx)("th",{children:"Cost"})]})}),(0,e_.jsxs)("tbody",{children:[o.sort(((e,t)=>e.type.localeCompare(t.type))).map(((e,t)=>(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("td",{children:e.parts.toFixed(2)}),(0,e_.jsx)("td",{children:e.name}),(0,e_.jsx)("td",{children:e.type}),(0,e_.jsx)("td",{children:e.grams.toFixed(3)}),(0,e_.jsxs)("td",{children:["$","number"===typeof e.cost?e.cost.toFixed(2):"NaN"]})]},t))),(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("td",{children:(0,e_.jsx)("strong",{children:"Total"})}),(0,e_.jsx)("td",{}),(0,e_.jsx)("td",{children:p}),(0,e_.jsx)("td",{children:d.toFixed(3)}),(0,e_.jsxs)("td",{children:["$","number"===typeof f?f.toFixed(2):"NaN"]})]})]})]}),(0,e_.jsx)("p",{children:l})]}):(0,e_.jsx)("div",{children:"Loading..."})},fE=JSON.parse('[{"section":"Introduction","content":"Thank you trying Skincremental! Your feedback is crucial for us to improve and tailor our products more closely to your needs. Please take a few moments to share your thoughts with us.","type":"text"},{"section":"Product Usage","questions":[{"id":"product_frequency","question":"Roughly how many times have you used the product since you recieved it?","type":"open_text"},{"id":"overall_satisfaction_rating","question":"On a scale of 1-5, how satisfied are you with the products you received?","type":"rating","scale":5}]},{"section":"Product Experience Feedback","questions":[{"id":"can_tell_difference","question":"How easily were you able to tell the difference between the two variations?","type":"choice","options":["Very easily","Somewhat","Not much"]},{"id":"variation_preference","question":"Which product variation did you prefer, A or B?","type":"choice","options":["A","B"]},{"id":"variation_preference_why","question":"Why did you prefer that variation?","type":"open_text","optional":true}]},{"section":"Product Consistency","questions":[{"id":"consistency","question":"What do you think about your product\'s consistency/texture?  ","type":"choice","options":["Too thick","Too thin","Just right"]},{"id":"consistency_issues","question":"Have you noticed any signs of the product splitting or going bad?","type":"choice","options":["Yes","No"]},{"id":"consistency_comments","question":"Please share any thoughts about the product consistency","type":"open_text","optional":true}]},{"section":"AI Effectiveness","questions":[{"id":"ai_effectiveness_rating","question":"On a scale of 1-5, how effectively did our AI understand and address your skin concerns?","type":"rating","scale":5},{"id":"ai_effectiveness_comments","question":"Do you have any specific feedback or suggestions for our AI\'s functionality?  What would you like to see improved?","type":"open_text","optional":true}]},{"section":"Web Interface Feedback","questions":[{"id":"web_interface_improvement","question":"We\'re always looking to improve our website\'s usability. Do you have any suggestions for making our web interface more user-friendly?","type":"open_text"}]},{"section":"Pricing Feedback","questions":[{"id":"expected_price","question":"If we were to charge for our personalized skincare service, what price would you expect to pay for the experience and products you recieved?","type":"open_text"}]},{"section":"Future Orders","questions":[{"id":"repeat_order_interest","question":"Would you be interested in placing another order?","type":"choice","options":["Yes, I\'d like to evolve this recipe","Yes, but I\'d like to try a different recipe","Ask me later","No, I\'m not interested in ordering again"],"shouldAddLineBreak":true}]},{"section":"Next Order Recipe Request","content":"We are still working some kinks out of the AI integration for order variation.  We\'ll be in touch with you soon to build your next recipe.","questions":[{"id":"repeat_order_variation_amount","question":"How much do you want your variation to differ from your current preferred recipe?","type":"choice","options":["Subtle tweak","Moderate change","Significant change"],"shouldAddLineBreak":true},{"id":"repeat_order_interest_comments","question":"What are your goals for the next variations?  What qualities of your formula would you like to improve upon?","type":"open_text","optional":true}]},{"section":"General Comments","questions":[{"id":"z_closing_comments","question":"Is there anything else you\'d like to share about your experience with us?","type":"open_text","optional":true}]},{"section":"Submission","content":"Thank you for your feedback.  If you\'ve selected that you\'re interested in placing another order, we\'ll be in touch with you soon to build your next recipe, or you can build a new recipe from scratch using the homepage at your convenience.","type":"text"}]'),pE=()=>{const e=Z(),[n,r]=(0,t.useState)(0),i=fE[n],[s,o]=(0,t.useState)({}),a=J(),l=new URLSearchParams(a.search).get("orderId"),[c,u]=(0,t.useState)(""),[h,d]=(0,t.useState)({}),[f,p]=(0,t.useState)(!1),[g,m]=(0,t.useState)(!1);(0,t.useEffect)((()=>{if(l){var e=new Date;u(e.getTime()+"-"+l)}}),[l]),(0,t.useEffect)((()=>{!1===f&&(async e=>{const t=Rp(Ky,"orders",e),n=await Tg(t);n.exists()&&!f?(d(n.data()),p(!0)):console.log("No such document!")})(l)}),[l,f]),(0,t.useEffect)((()=>{!g&&f&&c&&(async()=>{if(c){const e=Rp(Ky,"survey",c);await Rg(e,{orderId:l,startTime:new Date,responses:{}}),m(!0)}})()}),[c,l,g,f]);const v=(e,t)=>{o({...s,[e]:t})},y=e=>{const t=s[e.id]||"";switch(e.type){case"choice":return(0,e_.jsx)("div",{children:e.options.map(((n,r)=>(0,e_.jsxs)("label",{children:[(0,e_.jsx)("input",{type:"radio",name:e.id,value:n,checked:t===n,onChange:t=>v(e.id,t.target.value)}),n,e.shouldAddLineBreak&&r!==e.options.length-1?(0,e_.jsx)("br",{}):null]},r)))});case"rating":return(0,e_.jsx)("div",{children:[...Array(e.scale).keys()].map((n=>(0,e_.jsxs)("label",{children:[(0,e_.jsx)("input",{type:"radio",name:e.id,value:n+1,checked:parseInt(t)===n+1,onChange:t=>v(e.id,t.target.value)}),n+1]},n)))});case"open_text":return(0,e_.jsx)("textarea",{name:e.id,value:t,onChange:t=>v(e.id,t.target.value),placeholder:"Your answer..."});case"yes_no":return(0,e_.jsxs)("div",{children:[(0,e_.jsxs)("label",{children:[(0,e_.jsx)("input",{type:"radio",name:e.id,value:"Yes",checked:"Yes"===t,onChange:t=>v(e.id,t.target.value)}),"Yes"]}),(0,e_.jsxs)("label",{children:[(0,e_.jsx)("input",{type:"radio",name:e.id,value:"No",checked:"No"===t,onChange:t=>v(e.id,t.target.value)}),"No"]})]});default:return null}};return(0,e_.jsx)("div",{className:"body-container survey",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:(0,e_.jsxs)("div",{style:{margin:"0 auto",textAlign:"center"},children:[(0,e_.jsx)("h2",{children:i.section}),(_=i,_.questions?_.questions.map(((e,t)=>(0,e_.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,e_.jsx)("p",{children:e.question}),y(e)]},t))):_.content?(0,e_.jsx)("p",{children:_.content}):void 0),(0,e_.jsx)("button",{onClick:async()=>{await(async()=>{const e=Rp(Ky,"survey",c);await Ng(e,{responses:{...s},lastTime:new Date})})(),console.log([fE[n].section,h]),"Future Orders"===fE[n].section?"Yes, I'd like to evolve this recipe"===s.repeat_order_interest?r(n+1):r(n+2):"Product Experience Feedback"===fE[n].section&&"oil"===h.type?r(n+2):n<fE.length-1?r(n+1):e("/")},style:{marginTop:"20px"},children:n===fE.length-1?"Complete and Return Home":"Next"})]})});var _},gE=e=>{let{score:t}=e;const n=e=>{const n=Math.abs(e-5);let r="";return 5===t?5===e&&(r="highlighted"):t<5?e>=t&&e<=5&&(r="highlighted intensity-".concat(n)):t>5&&e<=t&&e>=5&&(r="highlighted intensity-".concat(n)),"segment ".concat(r)};return(0,e_.jsx)("div",{className:"score-bar",children:[...Array(9)].map(((e,t)=>(0,e_.jsx)("div",{className:n(t+1)},t)))})},mE=Object.keys(r_).filter((e=>!0!==r_[e].deprecated)).reduce(((e,t)=>(e[t]=r_[t],e)),{}),vE=()=>{const[e,n]=(0,t.useState)({key:null,direction:"ascending"}),r=(0,t.useMemo)((()=>{const t=Object.entries(mE).map((e=>{let[t,n]=e;return{name:t,...n}}));return null!==e.key&&t.sort(((t,n)=>t[e.key]<n[e.key]?"ascending"===e.direction?-1:1:t[e.key]>n[e.key]?"ascending"===e.direction?1:-1:0)),t}),[e]),i=t=>{let r="ascending";e.key===t&&"ascending"===e.direction&&(r="descending"),n({key:t,direction:r})};return(0,e_.jsx)("div",{children:(0,e_.jsxs)("table",{children:[(0,e_.jsx)("thead",{children:(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("th",{onClick:()=>i("name"),children:"Ingredient Name"}),(0,e_.jsx)("th",{onClick:()=>i("phase"),children:"Phase"}),(0,e_.jsx)("th",{onClick:()=>i("cost_per_g"),children:"Cost per g"}),(0,e_.jsx)("th",{onClick:()=>i("light_heavy"),children:"Light/Heavy"}),(0,e_.jsx)("th",{onClick:()=>i("penetrating_occlusive"),children:"Penetrating/Occlusive"}),(0,e_.jsx)("th",{onClick:()=>i("soothing_stimulating"),children:"Soothing/Stimulating"}),(0,e_.jsx)("th",{onClick:()=>i("gentle_active"),children:"Gentle/Active"})]})}),(0,e_.jsx)("tbody",{children:r.map((e=>(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("td",{children:e.name}),(0,e_.jsx)("td",{children:e.phase}),(0,e_.jsx)("td",{children:e.cost_per_g}),(0,e_.jsxs)("td",{children:[e.light_heavy," ",(0,e_.jsx)(gE,{score:e.light_heavy})]}),(0,e_.jsxs)("td",{children:[e.penetrating_occlusive,(0,e_.jsx)(gE,{score:e.penetrating_occlusive})]}),(0,e_.jsxs)("td",{children:[e.soothing_stimulating,(0,e_.jsx)(gE,{score:e.soothing_stimulating})]}),(0,e_.jsxs)("td",{children:[e.gentle_active,(0,e_.jsx)(gE,{score:e.gentle_active})]})]},e.name)))})]})})},yE={carrier:[{title:"Gentle Moisturizing",ingredients:{"Argan Oil":10,"Jojoba Oil":10,"Sunflower Oil":5},description:"Offers a light, non-greasy feel ideal for daily use and suitable for most skin types, providing balanced hydration without clogging pores."},{title:"Soothing",ingredients:{"Jojoba Oil":10,"Sweet Almond Oil":5,"Shea Butter":8},description:"Focuses on calming sensitive skin and reducing irritation, featuring a higher content of Shea Butter for enhanced soothing effects."},{title:"Anti Aging Nourishment",ingredients:{"Argan Oil":10,"Rosehip Seed Oil":5,"Vitamin E":2},description:"Targets mature skin with active ingredients for regeneration and antioxidant protection, more potent in anti-aging properties compared to other options."}],aqueous:[{title:"Hydrating",ingredients:{"Hyaluronic Acid Serum (2%)":2},description:"Provides intense hydration with a high concentration of Hyaluronic Acid, perfect for dry skin or as a boost of moisture in any skincare routine."},{title:"Skin Soothing",ingredients:{"Aloe Vera Gel":5,"Distilled Water":5,"Oat Milk":5},description:"Focuses on calming and soothing irritated skin with Aloe Vera and Oat Milk, offering a gentle and hydrating formula suitable for sensitive skin types."},{title:"Cooling",ingredients:{"Aloe Vera Gel":4,Glycerin:2,"Cucumber Juice":4},description:"Delivers a refreshing and cooling sensation with Cucumber Juice and Aloe Vera, perfect for hot weather or as a post-sun exposure treatment."}],fragrance:[{title:"No Fragrance",description:"Opt for a fragrance-free formulation to minimize the risk of irritation and maintain a neutral scent, suitable for sensitive skin or those preferring a natural product."},{title:"Floral Elegance",ingredients:{"Jasmine Oil":1,"Geranium Oil":2},description:"Offers a luxurious floral scent with Jasmine and Geranium essential oils, providing a sophisticated and elegant fragrance profile with skin balancing properties."},{title:"Forest Harmony",ingredients:{"Rosemary Oil":2,"Cedar Oil":2,"Pine Oil":1},description:"Creates a grounding and calming aroma reminiscent of a forest setting, combining Rosemary, Cedarwood, and Pine essential oils for a refreshing and earthy scent."},{title:"Soothing Lavender",ingredients:{"Lavender Oil":3},description:"Focuses on relaxation and stress relief with Lavender essential oil, known for its calming and soothing effects on both the skin and mind."},{title:"Refreshing and Invigorating",ingredients:{"Peppermint Oil":2,"Eucalyptus Oil":2,"Pine Oil":1},description:"Provides a cooling and refreshing sensation with Peppermint and Eucalyptus essential oils, perfect for revitalizing the senses and awakening the skin."}],preservative:[{title:"Phenoxyethanol",ingredients:{Phenoxyethanol:.5},description:"A widely used synthetic preservative effective against a broad spectrum of bacteria and fungi, providing reliable protection and extending product shelf life. Approximate shelf life: 24 months."},{title:"AntiMicro Root Blend",ingredients:{"AntiMicro Root Blend":1},description:"A natural plant-based preservative blend derived from root extracts, offering antimicrobial properties while being gentle on the skin, suitable for organic and natural formulations. Approximate shelf life: 6 months."},{title:"AntiMicro Banana",ingredients:{"AntiMicro Banana":2},description:"A natural plant-based, banana-derived antimicrobial blend, providing effective preservation with a mild sweet scent, ideal for those looking for natural preservation options with added sensory appeal. Approximate shelf life: 6 months."},{title:"No Preservative",description:"Ideal for people with specific skin sensitivities who plan to use the product rapidly.  Approximate shelf life: 2-8 weeks."}],active:[{title:"No Active Ingredients",description:"Embrace simplicity with a plant-based formula that harnesses the natural benefits of oils and extracts, free from added active ingredients."},{title:"Ultimate Sun Protection",ingredients:{"Zinc Oxide":10,"Vitamin E":.5},description:"Provides broad-spectrum UV protection with Zinc Oxide, enhanced with Vitamin E for its antioxidant properties, perfect for daily sun protection and skin health."},{title:"Anti-Aging Night Treatment",ingredients:{"Retinyl Palmitate":1,"Vitamin E":.5,"Niacinamide (Vitamin B3)":2},description:"A powerful night treatment combining Retinyl Palmitate, Vitamin E, and Niacinamide to target fine lines, wrinkles, and uneven skin tone, promoting smoother and younger-looking skin."},{title:"Calming and Protective",ingredients:{"Niacinamide (Vitamin B3)":2,"Zinc Oxide":5,"Vitamin E":.5},description:"A soothing formulation with Niacinamide to reduce redness and irritation, Zinc Oxide for soothing and protection, and Vitamin E for its moisturizing and healing properties, suitable for sensitive skin."}]},_E={fragrance:"Focus on the skin benefits over the aromatic profile of the fragrance phase, highlighting the sensory experience and therapeutic properties of essential oils to enhance the overall product appeal."},bE=(e,t)=>{if(!e.currentPhase||!e.productData||!e.goalsData)return console.error("Invalid state data provided."),Promise.reject("Invalid state data provided.");if("preservative"===e.currentPhase)return Promise.resolve(yE.preservative);let n=e.currentPhase;console.log("Phase and state: ",n,e);var r;const i={systemPrompt:"You are an award winning cosmetic chemist helping the user formulate a \n  new skincare product customized to the particulars of their skin. This recipe is being written \n  one phase at a time, and you are currently working on the ".concat(n," phase of the formulation. \n  Please provide three examples of ").concat(n," formulations with ingredients and proportions. ").concat(_E[n]||"","\n  \n  Here are examples of ").concat(n," formulations: ").concat(JSON.stringify(yE[n]),".  con\n  The units after each ingredient represent the number of 'parts' of that ingredient to include in the formulation, and may be integers between 1-10.\n\n  You may only use the ingredients found in this object: ").concat(JSON.stringify((r=n,Object.keys(r_).filter((e=>r_[e].type===r)).filter((e=>!0!==r_[e].deprecated)).filter((e=>!0!==r_[e].advanced)).reduce(((e,t)=>(e[t]=r_[t],e)),{}))),". \n  \n  Output your examples as an array\n  of JSON formated including a title and 1-sentence description of the phase to help the user understand the \n  contrasting benefits of each phase option.  Do not include any commentary outside of array of JSON objects."),userPrompt:"Hello please assist me in the formulation of a customized skincare product for my individual skin type and concerns.\n  My skincare concerns are ".concat(e.goalsData.join(", "),". The product I would like to make is a ").concat(e.productData,".\n\n  ").concat(t?"The user is specifically asking for: ".concat(t,"."):"","\n\n  What are three possible phase formulations for the ").concat(n," phase of my skincare product?  Please include the ingredients and proportions for each formulation\n  ")};return console.log("Sending OpenAI request: ",i.systemPrompt,i.userPrompt),fetch("https://us-central1-skincare-recipe-tool.cloudfunctions.net/getPhaseSuggestions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>e.json())).then((e=>{console.log("Success:",e),console.log("response: "+e.reply.choices[0].message.content);const t=e.reply.choices[0].message.content,r=JSON.parse(t);if("active"===n||"fragrance"===n){const e=yE[n].find((e=>e.title.startsWith("No ")));e&&r.push(e)}return console.log(r),r})).catch((e=>{console.error("Error:",e)}))},wE=e=>{let{message:t,description:n}=e;return(0,e_.jsxs)("div",{className:"loading-container",children:[(0,e_.jsx)("div",{className:"loader"}),(0,e_.jsx)("p",{className:"loading-text",children:t}),n&&(0,e_.jsx)("p",{className:"phase-description",children:n})]})},kE={carrier:"The oil phase provides a base for the formulation, delivering hydration and nourishment to the skin while helping to dilute and spread active ingredients evenly.",aqueous:"The aqueous phase is responsible for hydrating the skin and delivering water-soluble ingredients, forming the foundation of emulsions and adding moisture to the formulation.",active:"The active phase contains potent ingredients that target specific skin concerns, such as anti-aging, brightening, or soothing, providing the primary therapeutic benefits of the product.",fragrance:"The fragrance phase enhances the sensory experience of the product by adding pleasant scents, which can also have therapeutic properties, contributing to the overall appeal and enjoyment of the skincare routine.",preservative:"The preservative phase ensures the stability and safety of the product by preventing the growth of bacteria, mold, and other microorganisms, thereby extending the shelf life of the formulation."};const SE=function(){const e=Z(),[n,r]=(0,t.useState)(!1),[i,s]=(0,t.useState)(!1),{state:o,dispatch:a}=m_(),[l,c]=(0,t.useState)([]),[u,h]=(0,t.useState)(null),d=(0,t.useRef)([]),[f,p]=(0,t.useState)(""),g=[{title:"Lotion",ingredients:{aqueous:"60%",oil:"34%","Cetearyl Alcohol":"6%"},description:"A lightweight formulation ideal for normal to oily skin types."},{title:"Cream",ingredients:{aqueous:"35%",oil:"57%",Lecithin:"4%","Cetearyl Alcohol":"4%"},description:"A rich formulation suitable for dry and aging skin."}],m=async()=>{let e="dummy";try{e=await bE(o,f),c(e)}catch(V_){console.error("Error fetching phase suggestions:",V_)}finally{r(!1),console.log("Phase suggestions:",e)}};(0,t.useEffect)((()=>{l&&0===l.length&&!1===n&&"emulsifier"!==o.currentPhase&&(r(!0),m())}),[o]);const v=(e,t)=>{h(e.title),a({type:"UPDATE_RECIPE",payload:{phase:o.currentPhase,data:e}}),d.current[t]&&d.current[t].scrollIntoView({behavior:"smooth",inline:"center"}),console.log(o)};if(n){const e={carrier:"Crafting the perfect base for your skincare...",aqueous:"Infusing hydration into your formula...",active:"Selecting potent ingredients for your skin goals...",fragrance:"Designing a delightful sensory experience...",preservative:"Ensuring your product stays fresh and effective...",emulsifier:"Perfecting the texture of your skincare..."}[o.currentPhase]||"Personalizing your skincare formula...";return(0,e_.jsx)(wE,{message:e,description:kE[o.currentPhase]})}return(0,e_.jsx)(n_,{title:"emulsifier"===o.currentPhase?"Choose Formula Consistency":"Choose Your ".concat((y=o.currentPhase,y?y.charAt(0).toUpperCase()+y.slice(1):y)),handleSubmit:()=>{h(null);const t=(()=>{const t=o.phaseOrder.indexOf(o.currentPhase);return o.phaseOrder.length===t+1&&e("/confirm-recipe"),o.phaseOrder[t+1]||null})();t&&a({type:"SET_CURRENT_PHASE",payload:t}),c([])},isSubmitDisabled:null===u,whyDisabled:"emulsifier"===o.currentPhase?"Choose Consistency":"Choose an option",children:i?(0,e_.jsxs)(n_,{title:"Request Something Else",handleSubmit:()=>{s(!1),r(!0),m()},buttonText:"Get New Suggestions",isSubmitDisabled:!1,whyDisabled:"Choose Consistency",children:[(0,e_.jsx)("p",{children:"Tell the AI what you're looking for and we'll generate new options closer to what you want!"}),(0,e_.jsx)("textarea",{className:"big-text-area",placeholder:"Enter your request.  Are there specific ingredients you want to use?  Are there specific skin concerns you want to address?  The more detail you provide, the better the AI can help you!",onChange:e=>p(e.target.value),value:f})]}):(0,e_.jsxs)(e_.Fragment,{children:[(()=>{const e="emulsifier"===o.currentPhase?g:l;return(0,e_.jsx)("div",{className:"scroll-container",children:(0,e_.jsx)(s_,{items:e,handleSelection:v,selectedItem:u,itemRefs:d})})})(),(0,e_.jsx)("p",{className:"something-else",children:(0,e_.jsx)("a",{onClick:()=>s(!0),children:"Looking for something else?"})})]})});var y};const EE=function(){const{state:e,dispatch:n}=m_(),r=Z(),[i,s]=(0,t.useState)(e.recipeName||""),o=(()=>{const t={};let n=0,r=0;if(e.recipe&&e.recipe.emulsifier&&e.recipe.emulsifier.ingredients){const n=e.recipe.emulsifier.ingredients;Object.keys(n).forEach((e=>{if("oil"===e||"aqueous"===e)return;const i=parseFloat(n[e]);t[e]?t[e]+=i:t[e]=i,r+=i}))}Object.keys(e.recipe).forEach((r=>{if("emulsifier"!==r&&e.recipe[r].ingredients&&Object.keys(e.recipe[r].ingredients).length>0){const i=e.recipe[r].ingredients,s=Object.values(i).reduce(((e,t)=>e+t),0);Object.keys(i).forEach((r=>{var o,a;const l=null===(o=i_[r])||void 0===o?void 0:o.phase;if("additive"===l&&null!==(a=i_[r])&&void 0!==a&&a.default_percent){const e=i_[r].default_percent;t[r]=e,n+=e}else if(l&&e.recipe.emulsifier&&e.recipe.emulsifier.ingredients&&e.recipe.emulsifier.ingredients[l]){const n=parseFloat(e.recipe.emulsifier.ingredients[l]),o=i[r]/s*n;t[r]?t[r]+=o:t[r]=o}else{const e=i[r]/s*100;t[r]?t[r]+=e:t[r]=e}}))}}));const i=100-n-r,s=Object.keys(t).reduce(((n,r)=>{var i;return"additive"===(null===(i=i_[r])||void 0===i?void 0:i.phase)||e.recipe.emulsifier&&e.recipe.emulsifier.ingredients&&e.recipe.emulsifier.ingredients[r]?n:n+t[r]}),0);return Object.keys(t).forEach((n=>{var r;"additive"===(null===(r=i_[n])||void 0===r?void 0:r.phase)||e.recipe.emulsifier&&e.recipe.emulsifier.ingredients&&e.recipe.emulsifier.ingredients[n]||(t[n]=t[n]/s*i)})),t})();return Object.values(o).reduce(((e,t)=>e+t),0),(0,e_.jsx)(n_,{title:"Confirm Your Recipe",buttonText:"Confirm Recipe",handleSubmit:()=>{n({type:"SET_RECIPE_NAME",payload:i}),n({type:"SET_BASE_NAME",payload:i}),n({type:"SET_RAW_RECIPE",payload:o}),n({type:"SET_STATUS",payload:"Complete"}),r("/variation-request")},children:(0,e_.jsxs)("div",{className:"card",children:[(0,e_.jsxs)("label",{children:["Recipe Name:",(0,e_.jsx)("input",{className:"input",type:"text",value:i,onChange:e=>s(e.target.value),placeholder:"Enter recipe name"})]}),(0,e_.jsx)("h3",{children:"Overall Percentages"}),Object.keys(o).length>0?(0,e_.jsx)("ul",{children:Object.entries(o).sort(((e,t)=>{let[,n]=e,[,r]=t;return r-n})).map(((e,t)=>{let[n,r]=e;return(0,e_.jsxs)("li",{children:[n,": ",r.toFixed(2),"%"]},t)}))}):(0,e_.jsx)("p",{children:"No overall percentages available."})]})})},CE=["More Hydrating","More Moisturizing","Gentler","Different Fragrance","Longer Lasting","Faster Absorbing"];function TE(){const[e,n]=(0,t.useState)([]),[r,i]=(0,t.useState)(""),{dispatch:s}=m_(),o=Z(),a=0===e.length&&""===r.trim();return(0,e_.jsxs)(n_,{title:"Request a Recipe Variation",handleSubmit:()=>{s({type:"SET_VARIATION_REQUEST",payload:{selectedOptions:e,customRequest:r}}),o("/order-formulation")},isSubmitDisabled:a,whyDisabled:"Please select at least one option or enter a custom request",buttonText:"Submit Variation Request",children:[(0,e_.jsx)("p",{children:"Now that you've completed a base recipe, what kind of variation would you like?"}),(0,e_.jsx)("div",{className:"multiselect-container",children:CE.map((t=>(0,e_.jsx)("button",{type:"button",onClick:()=>(e=>{n((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))})(t),className:"multiselect-button ".concat(e.includes(t)?"selected":""),children:t},t)))}),(0,e_.jsx)("textarea",{className:"big-text-area",placeholder:"Enter your custom variation request here...",value:r,onChange:e=>i(e.target.value)})]})}const IE=()=>{const{user:e}=u_(),[n,r]=(0,t.useState)([]);return(0,t.useEffect)((()=>{e&&"chris@mckoss.com"===e.email&&(async()=>{const e=hg(xp(Ky,"orders"),gg("createdAt","desc")),t=await xg(e),n=await Promise.all(t.docs.map((async e=>{const t=e.data();let n="LEGACY",r="LEGACY";if(t.recipeId){const e=await Tg(Rp(Ky,"recipes",t.recipeId));if(e.exists()){const t=e.data();n=t.displayName||"LEGACY",r=t.recipeName||"LEGACY"}}return{id:e.id,...t,recipeDisplayName:n,recipeName:r}})));r(n)})()}),[e]),e&&"chris@mckoss.com"===e.email?(0,e_.jsxs)("div",{children:[(0,e_.jsx)("h1",{children:"Admin Console"}),(0,e_.jsxs)("h2",{children:["Orders (",n.length,")"]}),(0,e_.jsxs)("table",{children:[(0,e_.jsx)("thead",{children:(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("th",{children:"Name"}),(0,e_.jsx)("th",{children:"Date"}),(0,e_.jsx)("th",{children:"Status"}),(0,e_.jsx)("th",{children:"OldRecipeName"}),(0,e_.jsx)("th",{children:"Recipe"}),(0,e_.jsx)("th",{children:"Actions"}),(0,e_.jsx)("th",{children:"Delivered At"})]})}),(0,e_.jsx)("tbody",{children:n.map((e=>(0,e_.jsxs)("tr",{children:[(0,e_.jsx)("td",{children:e.name}),(0,e_.jsx)("td",{children:new Date(e.createdAt.toDate()).toLocaleString()}),(0,e_.jsx)("td",{children:e.status||"Pending"}),(0,e_.jsx)("td",{children:e.recipeName}),(0,e_.jsx)("td",{children:e.recipeDisplayName}),(0,e_.jsx)("td",{children:(0,e_.jsx)(Ce,{to:"/admin/order/".concat(e.id),children:(0,e_.jsx)("button",{children:"View Details"})})}),(0,e_.jsx)("td",{children:"Delivered"===e.status&&e.deliveredAt?new Date(e.deliveredAt).toLocaleString():"-"})]},e.id)))})]}),(0,e_.jsx)(Ce,{to:"/admin/recipe-copier",children:"Recipe Copier"})]}):(0,e_.jsx)(fe,{to:"/",replace:!0})},xE=()=>{const{orderId:e}=function(){let{matches:e}=t.useContext(K),n=e[e.length-1];return n?n.params:{}}(),[n,r]=(0,t.useState)(null),[i,s]=(0,t.useState)(null),[o,a]=(0,t.useState)(null),[l,c]=(0,t.useState)(""),[u,h]=(0,t.useState)(!1),[d,f]=(0,t.useState)(!0),[p,g]=(0,t.useState)(null),m=Z();(0,t.useEffect)((()=>{(async()=>{try{const n=await Tg(Rp(Ky,"orders",e));if(n.exists()){const e={id:n.id,...n.data()};if(r(e),c(e.status||"Pending"),e.recipeId)try{const t=await Tg(Rp(Ky,"recipes",e.recipeId));if(t.exists())s(t.data());else{const t=await Tg(Rp(Ky,"formulations",e.recipeId));t.exists()?a(t.data()):g("Recipe not found")}}catch(t){console.error("Error fetching recipe:",t),g("Error fetching recipe")}}else g("Order not found")}catch(n){console.error("Error fetching order:",n),g("Error fetching order")}finally{f(!1)}})()}),[e]);return d?(0,e_.jsx)("div",{children:"Loading..."}):(0,e_.jsxs)("div",{children:[(0,e_.jsx)("h1",{children:"Order Details"}),p&&(0,e_.jsx)("p",{className:"error",children:p}),n?(0,e_.jsxs)(e_.Fragment,{children:[(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Name:"})," ",n.name]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Date:"})," ",new Date(n.createdAt.toDate()).toLocaleString()]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Phone Number:"})," ",n.phoneNumber]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Pickup:"})," ",n.pickup?"Yes":"No"]}),!n.pickup&&(0,e_.jsxs)("div",{children:[(0,e_.jsx)("p",{children:(0,e_.jsx)("strong",{children:"Address:"})}),(0,e_.jsx)("p",{children:n.address.street1}),(0,e_.jsx)("p",{children:n.address.street2}),(0,e_.jsxs)("p",{children:["Seattle, WA ",n.address.zip]})]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Status:"}),(0,e_.jsxs)("select",{value:l,onChange:async t=>{const n=t.target.value;c(n);const r={status:n};"Delivered"===n&&(r.deliveredAt=(new Date).toISOString()),await Ng(Rp(Ky,"orders",e),r)},children:[(0,e_.jsx)("option",{value:"Pending",children:"Pending"}),(0,e_.jsx)("option",{value:"Processing",children:"Processing"}),(0,e_.jsx)("option",{value:"Shipped",children:"Shipped"}),(0,e_.jsx)("option",{value:"Delivered",children:"Delivered"})]})]}),i?(0,e_.jsxs)(e_.Fragment,{children:[(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Recipe:"})," ",i.displayName||i.baseName]}),(0,e_.jsxs)("div",{children:[(0,e_.jsx)("h2",{children:"Raw Recipe"}),i.rawRecipe?(0,e_.jsx)("ul",{children:Object.entries(i.rawRecipe).map((e=>{let[t,n]=e;return(0,e_.jsxs)("li",{children:[t,": ",parseFloat(n).toFixed(2),"%"]},t)}))}):(0,e_.jsx)("p",{children:"No raw recipe data available."})]})]}):o?(0,e_.jsxs)(e_.Fragment,{children:[(0,e_.jsx)("p",{children:(0,e_.jsx)("strong",{children:"Formulation:"})}),(0,e_.jsx)("pre",{children:JSON.stringify(o,null,2)})]}):(0,e_.jsx)("p",{children:"No recipe or formulation data available."}),(0,e_.jsx)(Ce,{to:"/order-pricing?recipeId=".concat(n.recipeId),children:(0,e_.jsx)("button",{children:"View Recipe Pricing"})}),(0,e_.jsx)("p",{children:u?(0,e_.jsxs)("div",{children:[(0,e_.jsx)("button",{onClick:()=>{h(!1)},children:"Cancel!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"}),(0,e_.jsx)("button",{onClick:async()=>{try{await function(e){return Ag(wp(e.firestore,Pp),[new Au(e._key,_u.none())])}(Rp(Ky,"orders",e)),m("/admin")}catch(p){console.error("Error deleting order: ",p),g("Error deleting order")}},className:"confirm-delete-button",children:"Confirm Delete"})]}):(0,e_.jsx)("button",{onClick:()=>{h(!0)},className:"delete-button",children:"Delete Order"})}),"Delivered"===l&&n.deliveredAt&&(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Delivered At:"})," ",new Date(n.deliveredAt).toLocaleString()]})]}):(0,e_.jsx)("p",{children:"Order not found"})]})},RE=e=>{let{recipeId:n}=e;const[r,i]=(0,t.useState)(null),[s,o]=(0,t.useState)(!0);return(0,t.useEffect)((()=>{(async()=>{try{const e=await Tg(Rp(Ky,"recipes",n));e.exists()?i({id:e.id,...e.data()}):console.log("No recipe found with id: ".concat(n))}catch(V_){console.error("Error fetching recipe:",V_)}finally{o(!1)}})()}),[n]),s?(0,e_.jsx)("p",{children:"Loading recipe..."}):r?(0,e_.jsx)(Ce,{to:"/saved-recipe?id=".concat(r.id),children:r.displayName||r.baseName||"Unnamed Recipe"}):(0,e_.jsx)("p",{children:"Recipe not found"})},NE=()=>{const{user:e}=u_(),[n,r]=(0,t.useState)([]),[i,s]=(0,t.useState)(!0);if((0,t.useEffect)((()=>{(async()=>{if(e&&e.uid){console.log("Fetching orders for user:",e.uid);const t=hg(xp(Ky,"orders"),function(e,t,n){const r=t,i=ag("where",e);return dg._create(i,r,n)}("creatorId","==",e.uid),gg("createdAt","desc")),n=await xg(t);console.log("Query snapshot size:",n.size);const i=[];n.forEach((e=>{console.log("Processing document:",e.id);const t=e.data();console.log("Document data:",t),i.push({id:e.id,...t})})),console.log("Processed order list:",i),r(i),s(!1)}})()}),[e]),i)return(0,e_.jsx)(wE,{message:"Getting your orders..."});const o=e&&"NMsFUVT3W1MRWRhuQ5PTVJF3IEK2"===e.uid;return(0,e_.jsxs)("div",{className:"dashboard",children:[(0,e_.jsx)("h1",{children:"My Orders"}),(0,e_.jsx)(Ce,{className:"modern-link",to:"/product",children:"+ Create a new recipe"}),0===n.length?(0,e_.jsx)("p",{children:"You haven't placed any orders yet."}):(0,e_.jsx)("div",{className:"order-list",children:n.map((e=>(0,e_.jsxs)("div",{className:"order-card",children:[(0,e_.jsxs)("div",{className:"order-header",children:[o&&(0,e_.jsxs)("p",{children:["Order ",e.id]}),(0,e_.jsxs)("p",{children:["Order Date: ",new Date(e.createdAt.toDate()).toLocaleDateString()]}),(0,e_.jsxs)("p",{children:["Status: ",e.status]})]}),(0,e_.jsxs)("div",{className:"recipe-info",children:[(0,e_.jsx)("h3",{children:"Recipe:"}),(0,e_.jsx)(RE,{recipeId:e.recipeId})]})]},e.id)))})]})},PE=()=>{const[e,n]=(0,t.useState)(""),[r,i]=(0,t.useState)(""),[s,o]=(0,t.useState)(""),[a,l]=(0,t.useState)("");return(0,e_.jsxs)("div",{children:[(0,e_.jsx)("h2",{children:"Recipe Copier"}),(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{htmlFor:"originalId",children:"Original Recipe ID:"}),(0,e_.jsx)("input",{type:"text",id:"originalId",value:e,onChange:e=>n(e.target.value)}),(0,e_.jsx)("button",{onClick:async()=>{l("Fetching recipe...");try{const t=Rp(Ky,"recipes",e),n=await Tg(t);n.exists()?(o(JSON.stringify(n.data(),null,2)),l("Recipe fetched successfully")):l("No recipe found with this ID")}catch(V_){console.error("Error fetching recipe:",V_),l("Error: ".concat(V_.message))}},children:"Get Recipe"})]}),(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{htmlFor:"recipeData",children:"Recipe Data:"}),(0,e_.jsx)("textarea",{id:"recipeData",value:s,onChange:e=>o(e.target.value),rows:"20",cols:"50"})]}),(0,e_.jsxs)("div",{children:[(0,e_.jsx)("label",{htmlFor:"newId",children:"New Recipe ID:"}),(0,e_.jsx)("input",{type:"text",id:"newId",value:r,onChange:e=>i(e.target.value)}),(0,e_.jsx)("button",{onClick:async()=>{l("Saving recipe...");try{const e=JSON.parse(s);await Rg(Rp(Ky,"recipes",r),e),l("Recipe saved successfully with new ID: ".concat(r))}catch(V_){console.error("Error saving recipe:",V_),l("Error: ".concat(V_.message))}},children:"Save Recipe"})]}),a&&(0,e_.jsx)("p",{children:a})]})};function AE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function OE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?AE(Object(n),!0).forEach((function(t){jE(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function DE(e){return DE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DE(e)}function LE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ME(e,t,n){return t&&FE(e.prototype,t),n&&FE(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function jE(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UE(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s=[],o=!0,a=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(s.push(r.value),!t||s.length!==t);o=!0);}catch(e){a=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(a)throw i}}return s}}(e,t)||VE(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qE(e){return function(e){if(Array.isArray(e))return zE(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||VE(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VE(e,t){if(e){if("string"==typeof e)return zE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?zE(e,t):void 0}}function zE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function BE(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=VE(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==n.return||n.return()}finally{if(a)throw s}}}}var HE={DEBUG:!1,LIB_VERSION:"1.130.2"},WE=Array.isArray,GE=Object.prototype,$E=GE.hasOwnProperty,KE=GE.toString,QE=WE||function(e){return"[object Array]"===KE.call(e)},YE=function(e){return"function"==typeof e},JE=function(e){return e===Object(e)&&!QE(e)},XE=function(e){if(JE(e)){for(var t in e)if($E.call(e,t))return!1;return!0}return!1},ZE=function(e){return void 0===e},eC=function(e){return"[object String]"==KE.call(e)},tC=function(e){return null===e},nC=function(e){return ZE(e)||tC(e)},rC=function(e){return"[object Number]"==KE.call(e)},iC=function(e){return"[object Boolean]"===KE.call(e)},sC=function(e){return e instanceof FormData},oC="undefined"!=typeof window?window:void 0,aC="undefined"!=typeof globalThis?globalThis:oC,lC=Array.prototype,cC=lC.forEach,uC=lC.indexOf,hC=null==aC?void 0:aC.navigator,dC=null==aC?void 0:aC.document,fC=null==aC?void 0:aC.location,pC=null==aC?void 0:aC.fetch,gC=null!=aC&&aC.XMLHttpRequest&&"withCredentials"in new aC.XMLHttpRequest?aC.XMLHttpRequest:void 0,mC=null==aC?void 0:aC.AbortController,vC=null==hC?void 0:hC.userAgent,yC=null!=oC?oC:{},_C="[PostHog.js]",bC={_log:function(e){if(oC&&(HE.DEBUG||yC.POSTHOG_DEBUG)&&!ZE(oC.console)&&oC.console){for(var t=("__rrweb_original__"in oC.console[e]?oC.console[e].__rrweb_original__:oC.console[e]),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.apply(void 0,[_C].concat(r))}},info:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];bC._log.apply(bC,["log"].concat(t))},warn:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];bC._log.apply(bC,["warn"].concat(t))},error:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];bC._log.apply(bC,["error"].concat(t))},critical:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).error.apply(e,[_C].concat(n))},uninitializedWarning:function(e){bC.error("You must initialize PostHog before calling ".concat(e))}},wC={},kC=function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function SC(e,t,n){if(QE(e))if(cC&&e.forEach===cC)e.forEach(t,n);else if("length"in e&&e.length===+e.length)for(var r=0,i=e.length;r<i;r++)if(r in e&&t.call(n,e[r],r)===wC)return}function EC(e,t,n){if(!nC(e)){if(QE(e))return SC(e,t,n);if(sC(e)){var r,i=BE(e.entries());try{for(i.s();!(r=i.n()).done;){var s=r.value;if(t.call(n,s[1],s[0])===wC)return}}catch(e){i.e(e)}finally{i.f()}}else for(var o in e)if($E.call(e,o)&&t.call(n,e[o],o)===wC)return}}var CC=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return SC(n,(function(t){for(var n in t)void 0!==t[n]&&(e[n]=t[n])})),e};function TC(e,t){return-1!==e.indexOf(t)}function IC(e){for(var t=Object.keys(e),n=t.length,r=new Array(n);n--;)r[n]=[t[n],e[t[n]]];return r}var xC=function(){return Date.now=Date.now||function(){return+new Date},Date.now()},RC=function(e){try{return e()}catch(e){return}},NC=function(e){return function(){try{for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(this,n)}catch(e){bC.critical("Implementation error. Please turn on debug mode and open a ticket on https://app.posthog.com/home#panel=support%3Asupport%3A."),bC.critical(e)}}},PC=function(e){var t={};return EC(e,(function(e,n){eC(e)&&e.length>0&&(t[n]=e)})),t};var AC,OC=function(){function e(t){return t&&(t.preventDefault=e.preventDefault,t.stopPropagation=e.stopPropagation),t}return e.preventDefault=function(){this.returnValue=!1},e.stopPropagation=function(){this.cancelBubble=!0},function(t,n,r,i,s){if(t)if(t.addEventListener&&!i)t.addEventListener(n,r,!!s);else{var o="on"+n,a=t[o];t[o]=function(t,n,r){return function(i){if(i=i||e(null==oC?void 0:oC.event)){var s,o=!0;YE(r)&&(s=r(i));var a=n.call(t,i);return!1!==s&&!1!==a||(o=!1),o}}}(t,r,a)}else bC.error("No valid element provided to register_event")}}();function DC(e,t){var n=function(){if(!dC)return t("document not found");var n=dC.createElement("script");n.type="text/javascript",n.src=e,n.onload=function(e){return t(void 0,e)},n.onerror=function(e){return t(e)};var r,i=dC.querySelectorAll("body > script");i.length>0?null===(r=i[0].parentNode)||void 0===r||r.insertBefore(n,i[0]):dC.body.appendChild(n)};null!=dC&&dC.body?n():null==dC||dC.addEventListener("DOMContentLoaded",n)}!function(e){e.GZipJS="gzip-js",e.Base64="base64"}(AC||(AC={}));var LC="$people_distinct_id",FC="__alias",MC="__timers",jC="$autocapture_disabled_server_side",UC="$heatmaps_enabled_server_side",qC="$session_recording_enabled_server_side",VC="$console_log_recording_enabled_server_side",zC="$session_recording_network_payload_capture",BC="$session_recording_canvas_recording",HC="$replay_sample_rate",WC="$replay_minimum_duration",GC="$sesid",$C="$session_is_sampled",KC="$enabled_feature_flags",QC="$early_access_features",YC="$stored_person_properties",JC="$stored_group_properties",XC="$surveys",ZC="$flag_call_reported",eT="$user_state",tT="$client_session_props",nT="$capture_rate_limit",rT="$initial_campaign_params",iT="$initial_referrer_info",sT="$epp",oT=[LC,FC,"__cmpns",MC,qC,UC,GC,KC,eT,QC,JC,YC,XC,ZC,tT,nT,rT,iT,sT],aT="$active_feature_flags",lT="$override_feature_flags",cT="$feature_flag_payloads",uT=function(e){var t,n={},r=BE(IC(e||{}));try{for(r.s();!(t=r.n()).done;){var i=UE(t.value,2),s=i[0],o=i[1];o&&(n[s]=o)}}catch(e){r.e(e)}finally{r.f()}return n},hT=function(){function e(t){LE(this,e),this.instance=t,this._override_warning=!1,this.featureFlagEventHandlers=[],this.reloadFeatureFlagsQueued=!1,this.reloadFeatureFlagsInAction=!1}return ME(e,[{key:"getFlags",value:function(){return Object.keys(this.getFlagVariants())}},{key:"getFlagVariants",value:function(){var e=this.instance.get_property(KC),t=this.instance.get_property(lT);if(!t)return e||{};for(var n=CC({},e),r=Object.keys(t),i=0;i<r.length;i++)n[r[i]]=t[r[i]];return this._override_warning||(bC.warn(" Overriding feature flags!",{enabledFlags:e,overriddenFlags:t,finalFlags:n}),this._override_warning=!0),n}},{key:"getFlagPayloads",value:function(){return this.instance.get_property(cT)||{}}},{key:"reloadFeatureFlags",value:function(){this.reloadFeatureFlagsQueued||(this.reloadFeatureFlagsQueued=!0,this._startReloadTimer())}},{key:"setAnonymousDistinctId",value:function(e){this.$anon_distinct_id=e}},{key:"setReloadingPaused",value:function(e){this.reloadFeatureFlagsInAction=e}},{key:"resetRequestQueue",value:function(){this.reloadFeatureFlagsQueued=!1}},{key:"_startReloadTimer",value:function(){var e=this;this.reloadFeatureFlagsQueued&&!this.reloadFeatureFlagsInAction&&setTimeout((function(){!e.reloadFeatureFlagsInAction&&e.reloadFeatureFlagsQueued&&(e.reloadFeatureFlagsQueued=!1,e._reloadFeatureFlagsRequest())}),5)}},{key:"_reloadFeatureFlagsRequest",value:function(){var e=this;if(!this.instance.config.advanced_disable_feature_flags){this.setReloadingPaused(!0);var t=this.instance.config.token,n=this.instance.get_property(YC),r=this.instance.get_property(JC),i={token:t,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),$anon_distinct_id:this.$anon_distinct_id,person_properties:n,group_properties:r,disable_flags:this.instance.config.advanced_disable_feature_flags||void 0};this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:i,compression:this.instance.config.disable_compression?void 0:AC.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:function(t){var n;e.setReloadingPaused(!1);var r=!0;200===t.statusCode&&(e.$anon_distinct_id=void 0,r=!1),e.receivedFeatureFlags(null!==(n=t.json)&&void 0!==n?n:{},r),e._startReloadTimer()}})}}},{key:"getFeatureFlag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0){var n,r=this.getFlagVariants()[e],i="".concat(r),s=this.instance.get_property(ZC)||{};return!t.send_event&&"send_event"in t||e in s&&s[e].includes(i)||(QE(s[e])?s[e].push(i):s[e]=[i],null===(n=this.instance.persistence)||void 0===n||n.register(jE({},ZC,s)),this.instance.capture("$feature_flag_called",{$feature_flag:e,$feature_flag_response:r})),r}bC.warn('getFeatureFlag for key "'+e+"\" failed. Feature flags didn't load in time.")}},{key:"getFeatureFlagPayload",value:function(e){return this.getFlagPayloads()[e]}},{key:"isFeatureEnabled",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.instance.decideEndpointWasHit||this.getFlags()&&this.getFlags().length>0)return!!this.getFeatureFlag(e,t);bC.warn('isFeatureEnabled for key "'+e+"\" failed. Feature flags didn't load in time.")}},{key:"addFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers.push(e)}},{key:"removeFeatureFlagsHandler",value:function(e){this.featureFlagEventHandlers=this.featureFlagEventHandlers.filter((function(t){return t!==e}))}},{key:"receivedFeatureFlags",value:function(e,t){if(this.instance.persistence){this.instance.decideEndpointWasHit=!0;var n=this.getFlagVariants(),r=this.getFlagPayloads();!function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=e.featureFlags,o=e.featureFlagPayloads;if(s)if(QE(s)){var a,l={};if(s)for(var c=0;c<s.length;c++)l[s[c]]=!0;t&&t.register((jE(a={},aT,s),jE(a,KC,l),a))}else{var u=s,h=o;e.errorsWhileComputingFlags&&(u=OE(OE({},r),u),h=OE(OE({},i),h)),t&&t.register((jE(n={},aT,Object.keys(uT(u))),jE(n,KC,u||{}),jE(n,cT,h||{}),n))}}(e,this.instance.persistence,n,r),this._fireFeatureFlagsCallbacks(t)}}},{key:"override",value:function(e){if(!this.instance.__loaded||!this.instance.persistence)return bC.uninitializedWarning("posthog.feature_flags.override");if(this._override_warning=!1,!1===e)this.instance.persistence.unregister(lT);else if(QE(e)){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;this.instance.persistence.register(jE({},lT,t))}else this.instance.persistence.register(jE({},lT,e))}},{key:"onFeatureFlags",value:function(e){var t=this;if(this.addFeatureFlagsHandler(e),this.instance.decideEndpointWasHit){var n=this._prepareFeatureFlagsForCallbacks(),r=n.flags,i=n.flagVariants;e(r,i)}return function(){return t.removeFeatureFlagsHandler(e)}}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,t){var n,r,i=jE({},"$feature_enrollment/".concat(e),t);this.instance.capture("$feature_enrollment_update",{$feature_flag:e,$feature_enrollment:t,$set:i}),this.setPersonPropertiesForFlags(i,!1);var s=OE(OE({},this.getFlagVariants()),{},jE({},e,t));null===(n=this.instance.persistence)||void 0===n||n.register((jE(r={},aT,Object.keys(uT(s))),jE(r,KC,s),r)),this._fireFeatureFlagsCallbacks()}},{key:"getEarlyAccessFeatures",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.instance.get_property(QC);if(r&&!n)return e(r);this.instance._send_request({transport:"XHR",url:this.instance.requestRouter.endpointFor("api","/api/early_access_features/?token=".concat(this.instance.config.token)),method:"GET",callback:function(n){var r;if(n.json){var i=n.json.earlyAccessFeatures;return null===(r=t.instance.persistence)||void 0===r||r.register(jE({},QC,i)),e(i)}}})}},{key:"_prepareFeatureFlagsForCallbacks",value:function(){var e=this.getFlags(),t=this.getFlagVariants();return{flags:e.filter((function(e){return t[e]})),flagVariants:Object.keys(t).filter((function(e){return t[e]})).reduce((function(e,n){return e[n]=t[n],e}),{})}}},{key:"_fireFeatureFlagsCallbacks",value:function(e){var t=this._prepareFeatureFlagsForCallbacks(),n=t.flags,r=t.flagVariants;this.featureFlagEventHandlers.forEach((function(t){return t(n,r,{errorsLoading:e})}))}},{key:"setPersonPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.instance.get_property(YC)||{};this.instance.register(jE({},YC,OE(OE({},n),e))),t&&this.instance.reloadFeatureFlags()}},{key:"resetPersonPropertiesForFlags",value:function(){this.instance.unregister(YC)}},{key:"setGroupPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.instance.get_property(JC)||{};0!==Object.keys(n).length&&Object.keys(n).forEach((function(t){n[t]=OE(OE({},n[t]),e[t]),delete e[t]})),this.instance.register(jE({},JC,OE(OE({},n),e))),t&&this.instance.reloadFeatureFlags()}},{key:"resetGroupPropertiesForFlags",value:function(e){if(e){var t=this.instance.get_property(JC)||{};this.instance.register(jE({},JC,OE(OE({},t),{},jE({},e,{}))))}else this.instance.unregister(JC)}}]),e}();Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Number.isInteger||(Number.isInteger=function(e){return rC(e)&&isFinite(e)&&Math.floor(e)===e});var dT="0123456789abcdef",fT=function(){function e(t){if(LE(this,e),this.bytes=t,16!==t.length)throw new TypeError("not 128-bit length")}return ME(e,[{key:"toString",value:function(){for(var e="",t=0;t<this.bytes.length;t++)e=e+dT.charAt(this.bytes[t]>>>4)+dT.charAt(15&this.bytes[t]),3!==t&&5!==t&&7!==t&&9!==t||(e+="-");if(36!==e.length)throw new Error("Invalid UUIDv7 was generated");return e}},{key:"clone",value:function(){return new e(this.bytes.slice(0))}},{key:"equals",value:function(e){return 0===this.compareTo(e)}},{key:"compareTo",value:function(e){for(var t=0;t<16;t++){var n=this.bytes[t]-e.bytes[t];if(0!==n)return Math.sign(n)}return 0}}],[{key:"fromFieldsV7",value:function(t,n,r,i){if(!Number.isInteger(t)||!Number.isInteger(n)||!Number.isInteger(r)||!Number.isInteger(i)||t<0||n<0||r<0||i<0||t>0xffffffffffff||n>4095||r>1073741823||i>4294967295)throw new RangeError("invalid field value");var s=new Uint8Array(16);return s[0]=t/Math.pow(2,40),s[1]=t/Math.pow(2,32),s[2]=t/Math.pow(2,24),s[3]=t/Math.pow(2,16),s[4]=t/Math.pow(2,8),s[5]=t,s[6]=112|n>>>8,s[7]=n,s[8]=128|r>>>24,s[9]=r>>>16,s[10]=r>>>8,s[11]=r,s[12]=i>>>24,s[13]=i>>>16,s[14]=i>>>8,s[15]=i,new e(s)}}]),e}(),pT=function(){function e(){LE(this,e),jE(this,"timestamp",0),jE(this,"counter",0),jE(this,"random",new vT)}return ME(e,[{key:"generate",value:function(){var e=this.generateOrAbort();if(ZE(e)){this.timestamp=0;var t=this.generateOrAbort();if(ZE(t))throw new Error("Could not generate UUID after timestamp reset");return t}return e}},{key:"generateOrAbort",value:function(){var e=Date.now();if(e>this.timestamp)this.timestamp=e,this.resetCounter();else{if(!(e+1e4>this.timestamp))return;this.counter++,this.counter>4398046511103&&(this.timestamp++,this.resetCounter())}return fT.fromFieldsV7(this.timestamp,Math.trunc(this.counter/Math.pow(2,30)),this.counter&Math.pow(2,30)-1,this.random.nextUint32())}},{key:"resetCounter",value:function(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}}]),e}(),gT=function(e){if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw new Error("no cryptographically strong RNG available");for(var t=0;t<e.length;t++)e[t]=65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random());return e};oC&&!ZE(oC.crypto)&&crypto.getRandomValues&&(gT=function(e){return crypto.getRandomValues(e)});var mT,vT=function(){function e(){LE(this,e),jE(this,"buffer",new Uint32Array(8)),jE(this,"cursor",1/0)}return ME(e,[{key:"nextUint32",value:function(){return this.cursor>=this.buffer.length&&(gT(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}]),e}(),yT=function(){return _T().toString()},_T=function(){return(mT||(mT=new pT)).generate()},bT="",wT=/[a-z0-9][a-z0-9-]+\.[a-z]{2,}$/i;var kT,ST={is_supported:function(){return!!dC},error:function(e){bC.error("cookieStore error: "+e)},get:function(e){if(dC){try{for(var t=e+"=",n=dC.cookie.split(";").filter((function(e){return e.length})),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}}catch(e){}return null}},parse:function(e){var t;try{t=JSON.parse(ST.get(e))||{}}catch(e){}return t},set:function(e,t,n,r,i){if(dC)try{var s="",o="",a=function(e,t){if(t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dC;if(bT)return bT;if(!t)return"";if(["localhost","127.0.0.1"].includes(e))return"";for(var n=e.split("."),r=Math.min(n.length,8),i="dmn_chk_"+yT(),s=new RegExp("(^|;)\\s*"+i+"=1");!bT&&r--;){var o=n.slice(r).join("."),a=i+"=1;domain=."+o;t.cookie=a,s.test(t.cookie)&&(t.cookie=a+";expires=Thu, 01 Jan 1970 00:00:00 GMT",bT=o)}return bT}(e);if(!n){var r=function(e){var t=e.match(wT);return t?t[0]:""}(e);r!==n&&bC.info("Warning: cookie subdomain discovery mismatch",r,n),n=r}return n?"; domain=."+n:""}return""}(dC.location.hostname,r);if(n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),s="; expires="+l.toUTCString()}i&&(o="; secure");var c=e+"="+encodeURIComponent(JSON.stringify(t))+s+"; SameSite=Lax; path=/"+a+o;return c.length>3686.4&&bC.warn("cookieStore warning: large cookie, len="+c.length),dC.cookie=c,c}catch(e){return}},remove:function(e,t){try{ST.set(e,"",-1,t)}catch(e){return}}},ET=null,CT={is_supported:function(){if(!tC(ET))return ET;var e=!0;if(ZE(oC))e=!1;else try{var t="__mplssupport__";CT.set(t,"xyz"),'"xyz"'!==CT.get(t)&&(e=!1),CT.remove(t)}catch(t){e=!1}return e||bC.error("localStorage unsupported; falling back to cookie store"),ET=e,e},error:function(e){bC.error("localStorage error: "+e)},get:function(e){try{return null==oC?void 0:oC.localStorage.getItem(e)}catch(e){CT.error(e)}return null},parse:function(e){try{return JSON.parse(CT.get(e))||{}}catch(e){}return null},set:function(e,t){try{null==oC||oC.localStorage.setItem(e,JSON.stringify(t))}catch(e){CT.error(e)}},remove:function(e){try{null==oC||oC.localStorage.removeItem(e)}catch(e){CT.error(e)}}},TT=["distinct_id",GC,$C,sT],IT=OE(OE({},CT),{},{parse:function(e){try{var t={};try{t=ST.parse(e)||{}}catch(e){}var n=CC(t,JSON.parse(CT.get(e)||"{}"));return CT.set(e,n),n}catch(e){}return null},set:function(e,t,n,r,i){try{CT.set(e,t);var s={};TT.forEach((function(e){t[e]&&(s[e]=t[e])})),Object.keys(s).length&&ST.set(e,s,n,r,i)}catch(e){CT.error(e)}},remove:function(e,t){try{null==oC||oC.localStorage.removeItem(e),ST.remove(e,t)}catch(e){CT.error(e)}}}),xT={},RT={is_supported:function(){return!0},error:function(e){bC.error("memoryStorage error: "+e)},get:function(e){return xT[e]||null},parse:function(e){return xT[e]||null},set:function(e,t){xT[e]=t},remove:function(e){delete xT[e]}},NT=null,PT={is_supported:function(){if(!tC(NT))return NT;if(NT=!0,ZE(oC))NT=!1;else try{var e="__support__";PT.set(e,"xyz"),'"xyz"'!==PT.get(e)&&(NT=!1),PT.remove(e)}catch(e){NT=!1}return NT},error:function(e){bC.error("sessionStorage error: ",e)},get:function(e){try{return null==oC?void 0:oC.sessionStorage.getItem(e)}catch(e){PT.error(e)}return null},parse:function(e){try{return JSON.parse(PT.get(e))||null}catch(e){}return null},set:function(e,t){try{null==oC||oC.sessionStorage.setItem(e,JSON.stringify(t))}catch(e){PT.error(e)}},remove:function(e){try{null==oC||oC.sessionStorage.removeItem(e)}catch(e){PT.error(e)}}},AT=["localhost","127.0.0.1"],OT=function(e){var t=null==dC?void 0:dC.createElement("a");return ZE(t)?null:(t.href=e,t)},DT=function(e,t){for(var n,r=((e.split("#")[0]||"").split("?")[1]||"").split("&"),i=0;i<r.length;i++){var s=r[i].split("=");if(s[0]===t){n=s;break}}if(!QE(n)||n.length<2)return"";var o=n[1];try{o=decodeURIComponent(o)}catch(e){bC.error("Skipping decoding for malformed query param: "+o)}return o.replace(/\+/g," ")},LT=function(e,t){var n=e.match(new RegExp(t+"=([^&]*)"));return n?n[1]:null},FT="Mobile",MT="iOS",jT="Android",UT="Tablet",qT=jT+" "+UT,VT="iPad",zT="Apple",BT=zT+" Watch",HT="Safari",WT="BlackBerry",GT="Samsung",$T=GT+"Browser",KT=GT+" Internet",QT="Chrome",YT=QT+" OS",JT=QT+" "+MT,XT="Internet Explorer",ZT=XT+" "+FT,eI="Opera",tI=eI+" Mini",nI="Edge",rI="Microsoft "+nI,iI="Firefox",sI=iI+" "+MT,oI="Nintendo",aI="PlayStation",lI="Xbox",cI=jT+" "+FT,uI=FT+" "+HT,hI="Windows",dI=hI+" Phone",fI="Nokia",pI="Ouya",gI="Generic",mI=gI+" "+FT.toLowerCase(),vI=gI+" "+UT.toLowerCase(),yI="Konqueror",_I="(\\d+(\\.\\d+)?)",bI=new RegExp("Version/"+_I),wI=new RegExp(lI,"i"),kI=new RegExp(aI+" \\w+","i"),SI=new RegExp(oI+" \\w+","i"),EI=new RegExp(WT+"|PlayBook|BB10","i"),CI={"NT3.51":"NT 3.11","NT4.0":"NT 4.0","5.0":"2000",5.1:"XP",5.2:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1",6.4:"10","10.0":"10"},TI=function(e,t){return t=t||"",TC(e," OPR/")&&TC(e,"Mini")?tI:TC(e," OPR/")?eI:EI.test(e)?WT:TC(e,"IE"+FT)||TC(e,"WPDesktop")?ZT:TC(e,$T)?KT:TC(e,nI)||TC(e,"Edg/")?rI:TC(e,"FBIOS")?"Facebook "+FT:TC(e,QT)?QT:TC(e,"CriOS")?JT:TC(e,"UCWEB")||TC(e,"UCBrowser")?"UC Browser":TC(e,"FxiOS")?sI:TC(e,jT)?cI:TC(e.toLowerCase(),yI.toLowerCase())?yI:function(e,t){return t&&TC(t,zT)||function(e){return TC(e,HT)&&!TC(e,QT)&&!TC(e,jT)}(e)}(e,t)?TC(e,FT)?uI:HT:TC(e,iI)?iI:TC(e,"MSIE")||TC(e,"Trident/")?XT:TC(e,"Gecko")?iI:""},II=(jE(kT={},ZT,[new RegExp("rv:"+_I)]),jE(kT,rI,[new RegExp(nI+"?\\/"+_I)]),jE(kT,QT,[new RegExp(QT+"/"+_I)]),jE(kT,JT,[new RegExp("CriOS\\/"+_I)]),jE(kT,"UC Browser",[new RegExp("(UCBrowser|UCWEB)\\/"+_I)]),jE(kT,HT,[bI]),jE(kT,uI,[bI]),jE(kT,eI,[new RegExp("(Opera|OPR)\\/"+_I)]),jE(kT,iI,[new RegExp(iI+"\\/"+_I)]),jE(kT,sI,[new RegExp("FxiOS\\/"+_I)]),jE(kT,yI,[new RegExp("Konqueror[:/]?"+_I,"i")]),jE(kT,WT,[new RegExp(WT+" "+_I),bI]),jE(kT,cI,[new RegExp("android\\s"+_I)]),jE(kT,KT,[new RegExp($T+"\\/"+_I)]),jE(kT,XT,[new RegExp("(rv:|MSIE )"+_I)]),jE(kT,"Mozilla",[new RegExp("rv:"+_I)]),kT),xI=[[new RegExp(lI+"; "+lI+" (.*?)[);]","i"),function(e){return[lI,e&&e[1]||""]}],[new RegExp(oI,"i"),[oI,""]],[new RegExp(aI,"i"),[aI,""]],[EI,[WT,""]],[new RegExp(hI,"i"),function(e,t){if(/Phone/.test(t)||/WPDesktop/.test(t))return[dI,""];if(new RegExp(FT).test(t)&&!/IEMobile\b/.test(t))return[hI+" "+FT,""];var n=/Windows NT ([0-9.]+)/i.exec(t);if(n&&n[1]){var r=n[1],i=CI[r]||"";return/arm/i.test(t)&&(i="RT"),[hI,i]}return[hI,""]}],[/((iPhone|iPad|iPod).*?OS (\d+)_(\d+)_?(\d+)?|iPhone)/,function(e){if(e&&e[3]){var t=[e[3],e[4],e[5]||"0"];return[MT,t.join(".")]}return[MT,""]}],[/(watch.*\/(\d+\.\d+\.\d+)|watch os,(\d+\.\d+),)/i,function(e){var t="";return e&&e.length>=3&&(t=ZE(e[2])?e[3]:e[2]),["watchOS",t]}],[new RegExp("("+jT+" (\\d+)\\.(\\d+)\\.?(\\d+)?|"+jT+")","i"),function(e){if(e&&e[2]){var t=[e[2],e[3],e[4]||"0"];return[jT,t.join(".")]}return[jT,""]}],[/Mac OS X (\d+)[_.](\d+)[_.]?(\d+)?/i,function(e){var t=["Mac OS X",""];if(e&&e[1]){var n=[e[1],e[2],e[3]||"0"];t[1]=n.join(".")}return t}],[/Mac/i,["Mac OS X",""]],[/CrOS/,[YT,""]],[/Linux|debian/i,["Linux",""]]],RI=function(e){return SI.test(e)?oI:kI.test(e)?aI:wI.test(e)?lI:new RegExp(pI,"i").test(e)?pI:new RegExp("("+dI+"|WPDesktop)","i").test(e)?dI:/iPad/.test(e)?VT:/iPod/.test(e)?"iPod Touch":/iPhone/.test(e)?"iPhone":/(watch)(?: ?os[,/]|\d,\d\/)[\d.]+/i.test(e)?BT:EI.test(e)?WT:/(kobo)\s(ereader|touch)/i.test(e)?"Kobo":new RegExp(fI,"i").test(e)?fI:/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i.test(e)||/(kf[a-z]+)( bui|\)).+silk\//i.test(e)?"Kindle Fire":/(Android|ZTE)/i.test(e)?!new RegExp(FT).test(e)||/(9138B|TB782B|Nexus [97]|pixel c|HUAWEISHT|BTV|noble nook|smart ultra 6)/i.test(e)?/pixel[\daxl ]{1,6}/i.test(e)&&!/pixel c/i.test(e)||/(huaweimed-al00|tah-|APA|SM-G92|i980|zte|U304AA)/i.test(e)||/lmy47v/i.test(e)&&!/QTAQZ3/i.test(e)?jT:qT:jT:new RegExp("(pda|"+FT+")","i").test(e)?mI:new RegExp(UT,"i").test(e)&&!new RegExp(UT+" pc","i").test(e)?vI:""},NI="https?://(.*)",PI=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","gclid","gad_source","gclsrc","dclid","gbraid","wbraid","fbclid","msclkid","twclid","li_fat_id","mc_cid","igshid","ttclid"],AI={campaignParams:function(e){var t=PI.concat(e||[]),n={};return EC(t,(function(e){var t=dC?DT(dC.URL,e):"";t.length&&(n[e]=t)})),n},searchEngine:function(){var e=null==dC?void 0:dC.referrer;return e?0===e.search(NI+"google.([^/?]*)")?"google":0===e.search(NI+"bing.com")?"bing":0===e.search(NI+"yahoo.com")?"yahoo":0===e.search(NI+"duckduckgo.com")?"duckduckgo":null:null},searchInfo:function(){var e=AI.searchEngine(),t="yahoo"!=e?"q":"p",n={};if(!tC(e)){n.$search_engine=e;var r=dC?DT(dC.referrer,t):"";r.length&&(n.ph_keyword=r)}return n},browser:TI,browserVersion:function(e,t){var n=TI(e,t),r=II[n];if(ZE(r))return null;for(var i=0;i<r.length;i++){var s=r[i],o=e.match(s);if(o)return parseFloat(o[o.length-2])}return null},browserLanguage:function(){return navigator.language||navigator.userLanguage},os:function(e){for(var t=0;t<xI.length;t++){var n=UE(xI[t],2),r=n[0],i=n[1],s=r.exec(e),o=s&&(YE(i)?i(s,e):i);if(o)return o}return["",""]},device:RI,deviceType:function(e){var t=RI(e);return t===VT||t===qT||"Kobo"===t||"Kindle Fire"===t||t===vI?UT:t===oI||t===lI||t===aI||t===pI?"Console":t===BT?"Wearable":t?FT:"Desktop"},referrer:function(){return(null==dC?void 0:dC.referrer)||"$direct"},referringDomain:function(){var e;return null!=dC&&dC.referrer&&(null===(e=OT(dC.referrer))||void 0===e?void 0:e.host)||"$direct"},referrerInfo:function(){return{$referrer:this.referrer(),$referring_domain:this.referringDomain()}},properties:function(){if(!vC)return{};var e=UE(AI.os(vC),2),t=e[0],n=e[1];return CC(PC({$os:t,$os_version:n,$browser:AI.browser(vC,navigator.vendor),$device:AI.device(vC),$device_type:AI.deviceType(vC)}),{$current_url:null==fC?void 0:fC.href,$host:null==fC?void 0:fC.host,$pathname:null==fC?void 0:fC.pathname,$raw_user_agent:vC.length>1e3?vC.substring(0,997)+"...":vC,$browser_version:AI.browserVersion(vC,navigator.vendor),$browser_language:AI.browserLanguage(),$screen_height:null==oC?void 0:oC.screen.height,$screen_width:null==oC?void 0:oC.screen.width,$viewport_height:null==oC?void 0:oC.innerHeight,$viewport_width:null==oC?void 0:oC.innerWidth,$lib:"web",$lib_version:HE.LIB_VERSION,$insert_id:Math.random().toString(36).substring(2,10)+Math.random().toString(36).substring(2,10),$time:xC()/1e3})},people_properties:function(){if(!vC)return{};var e=UE(AI.os(vC),2),t=e[0],n=e[1];return CC(PC({$os:t,$os_version:n,$browser:AI.browser(vC,navigator.vendor)}),{$browser_version:AI.browserVersion(vC,navigator.vendor)})}},OI=["cookie","localstorage","localstorage+cookie","sessionstorage","memory"],DI=function(){function e(t){LE(this,e),this.config=t,this.props={},this.campaign_params_saved=!1,this.name=function(e){var t="";return e.token&&(t=e.token.replace(/\+/g,"PL").replace(/\//g,"SL").replace(/=/g,"EQ")),e.persistence_name?"ph_"+e.persistence_name:"ph_"+t+"_posthog"}(t),this.storage=this.buildStorage(t),this.load(),this.update_config(t,t),this.save()}return ME(e,[{key:"buildStorage",value:function(e){-1===OI.indexOf(e.persistence.toLowerCase())&&(bC.critical("Unknown persistence type "+e.persistence+"; falling back to localStorage+cookie"),e.persistence="localStorage+cookie");var t=e.persistence.toLowerCase();return"localstorage"===t&&CT.is_supported()?CT:"localstorage+cookie"===t&&IT.is_supported()?IT:"sessionstorage"===t&&PT.is_supported()?PT:"memory"===t?RT:"cookie"===t?ST:IT.is_supported()?IT:ST}},{key:"properties",value:function(){var e={};return EC(this.props,(function(t,n){if(n===KC&&JE(t))for(var r=Object.keys(t),i=0;i<r.length;i++)e["$feature/".concat(r[i])]=t[r[i]];else o=n,a=!1,(tC(s=oT)?a:uC&&s.indexOf===uC?-1!=s.indexOf(o):(EC(s,(function(e){if(a||(a=e===o))return wC})),a))||(e[n]=t);var s,o,a})),e}},{key:"load",value:function(){if(!this.disabled){var e=this.storage.parse(this.name);e&&(this.props=CC({},e))}}},{key:"save",value:function(){this.disabled||this.storage.set(this.name,this.props,this.expire_days,this.cross_subdomain,this.secure)}},{key:"remove",value:function(){this.storage.remove(this.name,!1),this.storage.remove(this.name,!0)}},{key:"clear",value:function(){this.remove(),this.props={}}},{key:"register_once",value:function(e,t,n){var r=this;if(JE(e)){ZE(t)&&(t="None"),this.expire_days=ZE(n)?this.default_expiry:n;var i=!1;if(EC(e,(function(e,n){r.props.hasOwnProperty(n)&&r.props[n]!==t||(r.props[n]=e,i=!0)})),i)return this.save(),!0}return!1}},{key:"register",value:function(e,t){var n=this;if(JE(e)){this.expire_days=ZE(t)?this.default_expiry:t;var r=!1;if(EC(e,(function(t,i){e.hasOwnProperty(i)&&n.props[i]!==t&&(n.props[i]=t,r=!0)})),r)return this.save(),!0}return!1}},{key:"unregister",value:function(e){e in this.props&&(delete this.props[e],this.save())}},{key:"update_campaign_params",value:function(){this.campaign_params_saved||(this.register(AI.campaignParams(this.config.custom_campaign_params)),this.campaign_params_saved=!0)}},{key:"set_initial_campaign_params",value:function(){this.register_once(jE({},rT,AI.campaignParams(this.config.custom_campaign_params)),void 0)}},{key:"update_search_keyword",value:function(){this.register(AI.searchInfo())}},{key:"update_referrer_info",value:function(){this.register(AI.referrerInfo())}},{key:"set_initial_referrer_info",value:function(){this.register_once(jE({},iT,AI.referrerInfo()),void 0)}},{key:"get_referrer_info",value:function(){return PC({$referrer:this.props.$referrer,$referring_domain:this.props.$referring_domain})}},{key:"get_initial_props",value:function(){var e=this,t={};return EC([iT,rT],(function(n){var r=e.props[n];r&&EC(r,(function(e,n){var r;t["$initial_"+(r=n,r.replace(/^\$/,""))]=e}))})),t}},{key:"safe_merge",value:function(e){return EC(this.props,(function(t,n){n in e||(e[n]=t)})),e}},{key:"update_config",value:function(e,t){if(this.default_expiry=this.expire_days=e.cookie_expiration,this.set_disabled(e.disable_persistence),this.set_cross_subdomain(e.cross_subdomain_cookie),this.set_secure(e.secure_cookie),e.persistence!==t.persistence){var n=this.buildStorage(e),r=this.props;this.clear(),this.storage=n,this.props=r,this.save()}}},{key:"set_disabled",value:function(e){this.disabled=e,this.disabled?this.remove():this.save()}},{key:"set_cross_subdomain",value:function(e){e!==this.cross_subdomain&&(this.cross_subdomain=e,this.remove(),this.save())}},{key:"get_cross_subdomain",value:function(){return!!this.cross_subdomain}},{key:"set_secure",value:function(e){e!==this.secure&&(this.secure=e,this.remove(),this.save())}},{key:"set_event_timer",value:function(e,t){var n=this.props[MC]||{};n[e]=t,this.props[MC]=n,this.save()}},{key:"remove_event_timer",value:function(e){var t=(this.props[MC]||{})[e];return ZE(t)||(delete this.props[MC][e],this.save()),t}},{key:"get_property",value:function(e){return this.props[e]}},{key:"set_property",value:function(e,t){this.props[e]=t,this.save()}}]),e}(),LI=2,FI=4,MI=ME((function e(t){var n,r,i=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};LE(this,e),jE(this,"bucketSize",100),jE(this,"refillRate",10),jE(this,"mutationBuckets",{}),jE(this,"loggedTracker",{}),jE(this,"refillBuckets",(function(){Object.keys(i.mutationBuckets).forEach((function(e){i.mutationBuckets[e]=i.mutationBuckets[e]+i.refillRate,i.mutationBuckets[e]>=i.bucketSize&&delete i.mutationBuckets[e]}))})),jE(this,"getNodeOrRelevantParent",(function(e){var t=i.rrweb.mirror.getNode(e);if("svg"!==(null==t?void 0:t.nodeName)&&t instanceof Element){var n=t.closest("svg");if(n)return[i.rrweb.mirror.getId(n),n]}return[e,t]})),jE(this,"numberOfChanges",(function(e){var t,n,r,i,s,o,a,l;return(null!==(t=null===(n=e.removes)||void 0===n?void 0:n.length)&&void 0!==t?t:0)+(null!==(r=null===(i=e.attributes)||void 0===i?void 0:i.length)&&void 0!==r?r:0)+(null!==(s=null===(o=e.texts)||void 0===o?void 0:o.length)&&void 0!==s?s:0)+(null!==(a=null===(l=e.adds)||void 0===l?void 0:l.length)&&void 0!==a?a:0)})),jE(this,"throttleMutations",(function(e){if(3!==e.type||0!==e.data.source)return e;var t=e.data,n=i.numberOfChanges(t);t.attributes&&(t.attributes=t.attributes.filter((function(e){var t,n,r,s=UE(i.getNodeOrRelevantParent(e.id),2),o=s[0],a=s[1];return 0!==i.mutationBuckets[o]&&(i.mutationBuckets[o]=null!==(t=i.mutationBuckets[o])&&void 0!==t?t:i.bucketSize,i.mutationBuckets[o]=Math.max(i.mutationBuckets[o]-1,0),0===i.mutationBuckets[o]&&(i.loggedTracker[o]||(i.loggedTracker[o]=!0,null===(n=(r=i.options).onBlockedNode)||void 0===n||n.call(r,o,a))),e)})));var r=i.numberOfChanges(t);return 0!==r||n===r?e:void 0})),this.rrweb=t,this.options=s,this.refillRate=null!==(n=this.options.refillRate)&&void 0!==n?n:this.refillRate,this.bucketSize=null!==(r=this.options.bucketSize)&&void 0!==r?r:this.bucketSize,setInterval((function(){i.refillBuckets()}),1e3)})),jI=function(e){return e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e}(jI||{});function UI(e){return e?kC(e).split(/\s+/):[]}function qI(e){var t="";switch(DE(e.className)){case"string":t=e.className;break;case"object":t=("baseVal"in e.className?e.className.baseVal:null)||e.getAttribute("class")||"";break;default:t=""}return UI(t)}function VI(e){return nC(e)?null:kC(e).split(/(\s+)/).filter((function(e){return ix(e)})).join("").replace(/[\r\n]/g," ").replace(/[ ]+/g," ").substring(0,255)}function zI(e){var t="";return YI(e)&&!JI(e)&&e.childNodes&&e.childNodes.length&&EC(e.childNodes,(function(e){var n;WI(e)&&e.textContent&&(t+=null!==(n=VI(e.textContent))&&void 0!==n?n:"")})),kC(t)}function BI(e){return!!e&&1===e.nodeType}function HI(e,t){return!!e&&!!e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function WI(e){return!!e&&3===e.nodeType}function GI(e){return!!e&&11===e.nodeType}var $I=["a","button","form","input","select","textarea","label"];function KI(e){var t=e.parentNode;return!(!t||!BI(t))&&t}function QI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!oC||!e||HI(e,"html")||!BI(e))return!1;if(null!=n&&n.url_allowlist){var s=oC.location.href,o=n.url_allowlist;if(o&&!o.some((function(e){return s.match(e)})))return!1}if(null!=n&&n.dom_event_allowlist){var a=n.dom_event_allowlist;if(a&&!a.some((function(e){return t.type===e})))return!1}for(var l=!1,c=[e],u=!0,h=e;h.parentNode&&!HI(h,"body");)if(GI(h.parentNode))c.push(h.parentNode.host),h=h.parentNode.host;else{if(!(u=KI(h)))break;if(r||$I.indexOf(u.tagName.toLowerCase())>-1)l=!0;else{var d=oC.getComputedStyle(u);d&&"pointer"===d.getPropertyValue("cursor")&&(l=!0)}c.push(u),h=u}if(!function(e,t){var n=null==t?void 0:t.element_allowlist;if(ZE(n))return!0;var r,i=BE(e);try{var s=function(){var e=r.value;if(n.some((function(t){return e.tagName.toLowerCase()===t})))return{v:!0}};for(i.s();!(r=i.n()).done;){var o=s();if("object"===DE(o))return o.v}}catch(e){i.e(e)}finally{i.f()}return!1}(c,n))return!1;if(!function(e,t){var n=null==t?void 0:t.css_selector_allowlist;if(ZE(n))return!0;var r,i=BE(e);try{var s=function(){var e=r.value;if(n.some((function(t){return e.matches(t)})))return{v:!0}};for(i.s();!(r=i.n()).done;){var o=s();if("object"===DE(o))return o.v}}catch(e){i.e(e)}finally{i.f()}return!1}(c,n))return!1;var f=oC.getComputedStyle(e);if(f&&"pointer"===f.getPropertyValue("cursor")&&"click"===t.type)return!0;var p=e.tagName.toLowerCase();switch(p){case"html":return!1;case"form":return(i||["submit"]).indexOf(t.type)>=0;case"input":case"select":case"textarea":return(i||["change","click"]).indexOf(t.type)>=0;default:return l?(i||["click"]).indexOf(t.type)>=0:(i||["click"]).indexOf(t.type)>=0&&($I.indexOf(p)>-1||"true"===e.getAttribute("contenteditable"))}}function YI(e){for(var t=e;t.parentNode&&!HI(t,"body");t=t.parentNode){var n=qI(t);if(TC(n,"ph-sensitive")||TC(n,"ph-no-capture"))return!1}if(TC(qI(e),"ph-include"))return!0;var r=e.type||"";if(eC(r))switch(r.toLowerCase()){case"hidden":case"password":return!1}var i=e.name||e.id||"";return!eC(i)||!/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(i.replace(/[^a-zA-Z0-9]/g,""))}function JI(e){return!!(HI(e,"input")&&!["button","checkbox","submit","reset"].includes(e.type)||HI(e,"select")||HI(e,"textarea")||"true"===e.getAttribute("contenteditable"))}var XI="(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11})",ZI=new RegExp("^(?:".concat(XI,")$")),ex=new RegExp(XI),tx="\\d{3}-?\\d{2}-?\\d{4}",nx=new RegExp("^(".concat(tx,")$")),rx=new RegExp("(".concat(tx,")"));function ix(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(nC(e))return!1;if(eC(e)){if(e=kC(e),(t?ZI:ex).test((e||"").replace(/[- ]/g,"")))return!1;if((t?nx:rx).test(e))return!1}return!0}function sx(e){var t=zI(e);return ix(t="".concat(t," ").concat(ox(e)).trim())?t:""}function ox(e){var t="";return e&&e.childNodes&&e.childNodes.length&&EC(e.childNodes,(function(e){var n;if(e&&"span"===(null===(n=e.tagName)||void 0===n?void 0:n.toLowerCase()))try{var r=zI(e);t="".concat(t," ").concat(r).trim(),e.childNodes&&e.childNodes.length&&(t="".concat(t," ").concat(ox(e)).trim())}catch(e){bC.error(e)}})),t}function ax(e){return function(e){var t=e.map((function(e){var t,n,r="";if(e.tag_name&&(r+=e.tag_name),e.attr_class){e.attr_class.sort();var i,s=BE(e.attr_class);try{for(s.s();!(i=s.n()).done;){var o=i.value;r+=".".concat(o.replace(/"/g,""))}}catch(e){s.e(e)}finally{s.f()}}var a=OE(OE(OE(OE({},e.text?{text:e.text}:{}),{},{"nth-child":null!==(t=e.nth_child)&&void 0!==t?t:0,"nth-of-type":null!==(n=e.nth_of_type)&&void 0!==n?n:0},e.href?{href:e.href}:{}),e.attr_id?{attr_id:e.attr_id}:{}),e.attributes),l={};return IC(a).sort((function(e,t){var n=UE(e,1)[0],r=UE(t,1)[0];return n.localeCompare(r)})).forEach((function(e){var t=UE(e,2),n=t[0],r=t[1];return l[lx(n.toString())]=lx(r.toString())})),(r+=":")+IC(a).map((function(e){var t=UE(e,2),n=t[0],r=t[1];return"".concat(n,'="').concat(r,'"')})).join("")}));return t.join(";")}(function(e){return e.map((function(e){var t,n,r={text:null===(t=e.$el_text)||void 0===t?void 0:t.slice(0,400),tag_name:e.tag_name,href:null===(n=e.attr__href)||void 0===n?void 0:n.slice(0,2048),attr_class:cx(e),attr_id:e.attr__id,nth_child:e.nth_child,nth_of_type:e.nth_of_type,attributes:{}};return IC(e).filter((function(e){return 0===UE(e,1)[0].indexOf("attr__")})).forEach((function(e){var t=UE(e,2),n=t[0],i=t[1];return r.attributes[n]=i})),r}))}(e))}function lx(e){return e.replace(/"|\\"/g,'\\"')}function cx(e){var t=e.attr__class;return t?QE(t)?t:UI(t):void 0}var ux="[SessionRecording]",hx={initiatorTypes:["audio","beacon","body","css","early-hint","embed","fetch","frame","iframe","icon","image","img","input","link","navigation","object","ping","script","track","video","xmlhttprequest"],maskRequestFn:function(e){return e},recordHeaders:!1,recordBody:!1,recordInitialRequests:!1,recordPerformance:!1,performanceEntryTypeToObserve:["first-input","navigation","paint","resource"],payloadSizeLimitBytes:1e6},dx=["authorization","x-forwarded-for","authorization","cookie","set-cookie","x-api-key","x-real-ip","remote-addr","forwarded","proxy-authorization","x-csrf-token","x-csrftoken","x-xsrf-token"],fx=["password","secret","passwd","api_key","apikey","auth","credentials","mysql_pwd","privatekey","private_key","token"],px=["/s/","/e/","/i/"];function gx(e,t,n,r){if(nC(e))return e;var i=(null==t?void 0:t["content-length"])||function(e){return new Blob([e]).size}(e);return eC(i)&&(i=parseInt(i)),i>n?ux+" ".concat(r," body too large to record (").concat(i," bytes)"):e}function mx(e,t){if(nC(e))return e;var n=e;return ix(n,!1)||(n=ux+" "+t+" body redacted"),EC(fx,(function(e){var r,i;null!==(r=n)&&void 0!==r&&r.length&&-1!==(null===(i=n)||void 0===i?void 0:i.indexOf(e))&&(n=ux+" "+t+" body redacted as might contain: "+e)})),n}var vx="__ph_opt_in_out_";function yx(e,t){Tx(!0,e,t)}function _x(e,t){Tx(!1,e,t)}function bx(e,t){return"1"===Cx(e,t)}function wx(e,t){return!!function(e){if(e&&e.respectDnt){var t=e&&e.window||oC,n=null==t?void 0:t.navigator,r=!1;return EC([null==n?void 0:n.doNotTrack,n.msDoNotTrack,t.doNotTrack],(function(e){TC([!0,1,"1","yes"],e)&&(r=!0)})),r}return!1}(t)||"0"===Cx(e,t)}function kx(e,t){Sx(t=t||{}).remove(Ex(e,t),!!t.crossSubdomainCookie)}function Sx(e){return"localStorage"===(e=e||{}).persistenceType?CT:"localStorage+cookie"===e.persistenceType?IT:ST}function Ex(e,t){return((t=t||{}).persistencePrefix||vx)+e}function Cx(e,t){return Sx(t).get(Ex(e,t))}function Tx(e,t,n){eC(t)&&t.length?(Sx(n=n||{}).set(Ex(t,n),e?1:0,rC(n.cookieExpiration)?n.cookieExpiration:null,n.crossSubdomainCookie,n.secureCookie),n.capture&&e&&n.capture(n.captureEventName||"$opt_in",n.captureProperties||{},{send_instantly:!0})):bC.error("gdpr."+(e?"optIn":"optOut")+" called with an invalid token")}function Ix(e){var t=!1;try{var n=e.config.token,r=e.config.respect_dnt,i=e.config.opt_out_capturing_persistence_type,s=e.config.opt_out_capturing_cookie_prefix||void 0,o=e.config.window;n&&(t=wx(n,{respectDnt:r,persistenceType:i,persistencePrefix:s,window:o}))}catch(e){bC.error("Unexpected error when checking capturing opt-out status: "+e)}return t}var xx,Rx=3e5,Nx=Rx;!function(e){e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet"}(xx||(xx={}));var Px=[xx.MouseMove,xx.MouseInteraction,xx.Scroll,xx.ViewportResize,xx.Input,xx.TouchMove,xx.MediaInteraction,xx.Drag],Ax=function(e){return{rrwebMethod:e,enqueuedAt:Date.now(),attempt:1}},Ox="[SessionRecording]",Dx=function(){function e(t){var n=this;if(LE(this,e),jE(this,"queuedRRWebEvents",[]),jE(this,"isIdle",!1),jE(this,"_linkedFlagSeen",!1),jE(this,"_lastActivityTimestamp",Date.now()),jE(this,"windowId",null),jE(this,"sessionId",null),jE(this,"_linkedFlag",null),jE(this,"_forceAllowLocalhostNetworkCapture",!1),jE(this,"_samplingSessionListener",null),this.instance=t,this._captureStarted=!1,this._endpoint="/s/",this.stopRrweb=void 0,this.receivedDecide=!1,null==oC||oC.addEventListener("beforeunload",(function(){n._flushBuffer()})),null==oC||oC.addEventListener("offline",(function(){n._tryAddCustomEvent("browser offline",{})})),null==oC||oC.addEventListener("online",(function(){n._tryAddCustomEvent("browser online",{})})),null==oC||oC.addEventListener("visibilitychange",(function(){if(null!=dC&&dC.visibilityState){var e="window "+dC.visibilityState;n._tryAddCustomEvent(e,{})}})),!this.instance.sessionManager)throw bC.error(Ox+" started without valid sessionManager"),new Error(Ox+" started without valid sessionManager. This is a bug.");this.buffer=this.clearBuffer(),this._setupSampling()}return ME(e,[{key:"rrwebRecord",get:function(){var e;return null==yC||null===(e=yC.rrweb)||void 0===e?void 0:e.record}},{key:"started",get:function(){return this._captureStarted}},{key:"sessionManager",get:function(){if(!this.instance.sessionManager)throw bC.error(Ox+" started without valid sessionManager"),new Error(Ox+" started without valid sessionManager. This is a bug.");return this.instance.sessionManager}},{key:"isSampled",get:function(){var e=this.instance.get_property($C);return iC(e)?e:null}},{key:"sessionDuration",get:function(){var e,t,n=null===(e=this.buffer)||void 0===e?void 0:e.data[(null===(t=this.buffer)||void 0===t?void 0:t.data.length)-1],r=this.sessionManager.checkAndGetSessionAndWindowId(!0).sessionStartTimestamp;return n?n.timestamp-r:null}},{key:"isRecordingEnabled",get:function(){var e=!!this.instance.get_property(qC),t=!this.instance.config.disable_session_recording;return oC&&e&&t}},{key:"isConsoleLogCaptureEnabled",get:function(){var e=!!this.instance.get_property(VC),t=this.instance.config.enable_recording_console_log;return null!=t?t:e}},{key:"canvasRecording",get:function(){var e=this.instance.get_property(BC);return e&&e.fps&&e.quality?{enabled:e.enabled,fps:e.fps,quality:e.quality}:void 0}},{key:"networkPayloadCapture",get:function(){var e,t,n=this.instance.get_property(zC),r={recordHeaders:null===(e=this.instance.config.session_recording)||void 0===e?void 0:e.recordHeaders,recordBody:null===(t=this.instance.config.session_recording)||void 0===t?void 0:t.recordBody},i=(null==r?void 0:r.recordHeaders)||(null==n?void 0:n.recordHeaders),s=(null==r?void 0:r.recordBody)||(null==n?void 0:n.recordBody),o=this.instance.config.capture_performance||(null==n?void 0:n.capturePerformance);return i||s||o?{recordHeaders:i,recordBody:s,recordPerformance:o}:void 0}},{key:"sampleRate",get:function(){var e=this.instance.get_property(HC);return rC(e)?e:null}},{key:"minimumDuration",get:function(){var e=this.instance.get_property(WC);return rC(e)?e:null}},{key:"status",get:function(){return this.receivedDecide?this.isRecordingEnabled?nC(this._linkedFlag)||this._linkedFlagSeen?iC(this.isSampled)?this.isSampled?"sampled":"disabled":"active":"buffering":"disabled":"buffering"}},{key:"startIfEnabledOrStop",value:function(){this.isRecordingEnabled?(this._startCapture(),bC.info(Ox+" started")):(this.stopRecording(),this.clearBuffer())}},{key:"stopRecording",value:function(){this._captureStarted&&this.stopRrweb&&(this.stopRrweb(),this.stopRrweb=void 0,this._captureStarted=!1,bC.info(Ox+" stopped"))}},{key:"makeSamplingDecision",value:function(e){var t,n=this.sessionId!==e,r=this.sampleRate;if(rC(r)){var i,s=this.isSampled,o=n||!iC(s);!(i=o?Math.random()<r:s)&&o&&bC.warn(Ox+" Sample rate (".concat(r,") has determined that this sessionId (").concat(e,") will not be sent to the server.")),this._tryAddCustomEvent("samplingDecisionMade",{sampleRate:r}),null===(t=this.instance.persistence)||void 0===t||t.register(jE({},$C,i))}else{var a;null===(a=this.instance.persistence)||void 0===a||a.register(jE({},$C,null))}}},{key:"afterDecideResponse",value:function(e){var t,n,r,i=this;if(this._persistDecideResponse(e),this._linkedFlag=(null===(t=e.sessionRecording)||void 0===t?void 0:t.linkedFlag)||null,null!==(n=e.sessionRecording)&&void 0!==n&&n.endpoint&&(this._endpoint=null===(r=e.sessionRecording)||void 0===r?void 0:r.endpoint),this._setupSampling(),!nC(this._linkedFlag)){var s=eC(this._linkedFlag)?this._linkedFlag:this._linkedFlag.flag,o=eC(this._linkedFlag)?null:this._linkedFlag.variant;this.instance.onFeatureFlags((function(e,t){var n=JE(t)&&s in t,r=o?t[s]===o:n;if(r){var a={linkedFlag:s,linkedVariant:o},l="linked flag matched";bC.info(Ox+" "+l,a),i._tryAddCustomEvent(l,a)}i._linkedFlagSeen=r}))}this.receivedDecide=!0,this.startIfEnabledOrStop()}},{key:"_setupSampling",value:function(){var e=this;rC(this.sampleRate)&&tC(this._samplingSessionListener)&&(this._samplingSessionListener=this.sessionManager.onSessionId((function(t){e.makeSamplingDecision(t)})))}},{key:"_persistDecideResponse",value:function(e){if(this.instance.persistence){var t=this.instance.persistence,n=function(){var n,r,i,s,o,a,l,c,u=null===(n=e.sessionRecording)||void 0===n?void 0:n.sampleRate,h=nC(u)?null:parseFloat(u),d=null===(r=e.sessionRecording)||void 0===r?void 0:r.minimumDurationMilliseconds;t.register((jE(c={},qC,!!e.sessionRecording),jE(c,VC,null===(i=e.sessionRecording)||void 0===i?void 0:i.consoleLogRecordingEnabled),jE(c,zC,OE({capturePerformance:e.capturePerformance},null===(s=e.sessionRecording)||void 0===s?void 0:s.networkPayloadCapture)),jE(c,BC,{enabled:null===(o=e.sessionRecording)||void 0===o?void 0:o.recordCanvas,fps:null===(a=e.sessionRecording)||void 0===a?void 0:a.canvasFps,quality:null===(l=e.sessionRecording)||void 0===l?void 0:l.canvasQuality}),jE(c,HC,h),jE(c,WC,ZE(d)?null:d),c))};n(),this.sessionManager.onSessionId(n)}}},{key:"log",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";null===(t=this.instance.sessionRecording)||void 0===t||t.onRRwebEmit({type:6,data:{plugin:"rrweb/console@1",payload:{level:n,trace:[],payload:[JSON.stringify(e)]}},timestamp:xC()})}},{key:"_startCapture",value:function(){var e=this;ZE(Object.assign)||this._captureStarted||this.instance.config.disable_session_recording||Ix(this.instance)||(this._captureStarted=!0,this.sessionManager.checkAndGetSessionAndWindowId(),this.rrwebRecord?this._onScriptLoaded():DC(this.instance.requestRouter.endpointFor("assets","/static/recorder.js?v=".concat(HE.LIB_VERSION)),(function(t){if(t)return bC.error(Ox+" could not load recorder.js",t);e._onScriptLoaded()})))}},{key:"isInteractiveEvent",value:function(e){var t;return 3===e.type&&-1!==Px.indexOf(null===(t=e.data)||void 0===t?void 0:t.source)}},{key:"_updateWindowAndSessionIds",value:function(e){var t=this.isInteractiveEvent(e);t||this.isIdle||e.timestamp-this._lastActivityTimestamp>Nx&&(this.isIdle=!0,this._tryAddCustomEvent("sessionIdle",{reason:"user inactivity",timeSinceLastActive:e.timestamp-this._lastActivityTimestamp,threshold:Nx}));var n=!1;if(t&&(this._lastActivityTimestamp=e.timestamp,this.isIdle&&(this.isIdle=!1,this._tryAddCustomEvent("sessionNoLongerIdle",{reason:"user activity",type:e.type}),n=!0)),!this.isIdle){var r=this.sessionManager.checkAndGetSessionAndWindowId(!t,e.timestamp),i=r.windowId,s=r.sessionId,o=this.sessionId!==s,a=this.windowId!==i;this.windowId=i,this.sessionId=s,(n||-1===[LI,FI].indexOf(e.type)&&(a||o))&&this._tryTakeFullSnapshot()}}},{key:"_tryRRWebMethod",value:function(e){try{return e.rrwebMethod(),!0}catch(OE){return this.queuedRRWebEvents.length<10?this.queuedRRWebEvents.push({enqueuedAt:e.enqueuedAt||Date.now(),attempt:e.attempt++,rrwebMethod:e.rrwebMethod}):bC.warn(Ox+" could not emit queued rrweb event.",OE,e),!1}}},{key:"_tryAddCustomEvent",value:function(e,t){var n=this;return this._tryRRWebMethod(Ax((function(){return n.rrwebRecord.addCustomEvent(e,t)})))}},{key:"_tryTakeFullSnapshot",value:function(){var e=this;return this._tryRRWebMethod(Ax((function(){return e.rrwebRecord.takeFullSnapshot()})))}},{key:"_onScriptLoaded",value:function(){for(var e,t=this,n={blockClass:"ph-no-capture",blockSelector:void 0,ignoreClass:"ph-ignore-input",maskTextClass:"ph-mask",maskTextSelector:void 0,maskTextFn:void 0,maskAllInputs:!0,maskInputOptions:{},maskInputFn:void 0,slimDOMOptions:{},collectFonts:!1,inlineStylesheet:!0,recordCrossOriginIframes:!1},r=this.instance.config.session_recording,i=0,s=Object.entries(r||{});i<s.length;i++){var o=UE(s[i],2),a=o[0],l=o[1];a in n&&(n[a]=l)}if(this.canvasRecording&&this.canvasRecording.enabled&&(n.recordCanvas=!0,n.sampling={canvas:this.canvasRecording.fps},n.dataURLOptions={type:"image/webp",quality:this.canvasRecording.quality}),this.rrwebRecord){this.mutationRateLimiter=null!==(e=this.mutationRateLimiter)&&void 0!==e?e:new MI(this.rrwebRecord,{onBlockedNode:function(e,n){var r="Too many mutations on node '".concat(e,"'. Rate limiting. This could be due to SVG animations or something similar");bC.info(r,{node:n}),t.log(Ox+" "+r,"warn")}}),this._scheduleFullSnapshot();var c=this._gatherRRWebPlugins();this.stopRrweb=this.rrwebRecord(OE({emit:function(e){t.onRRwebEmit(e)},plugins:c},n)),this.instance._addCaptureHook((function(e){try{if("$pageview"===e){var n=oC?t._maskUrl(oC.location.href):"";if(!n)return;t._tryAddCustomEvent("$pageview",{href:n}),t._tryTakeFullSnapshot()}}catch(e){bC.error("Could not add $pageview to rrweb session",e)}})),this._lastActivityTimestamp=Date.now(),this.isIdle=!1,this._tryAddCustomEvent("$session_options",{sessionRecordingOptions:n,activePlugins:c.map((function(e){return null==e?void 0:e.name}))}),this._tryAddCustomEvent("$posthog_config",{config:this.instance.config})}else bC.error(Ox+"onScriptLoaded was called but rrwebRecord is not available. This indicates something has gone wrong.")}},{key:"_scheduleFullSnapshot",value:function(){var e=this;this._fullSnapshotTimer&&clearInterval(this._fullSnapshotTimer),this._fullSnapshotTimer=setInterval((function(){e._tryTakeFullSnapshot()}),Rx)}},{key:"_gatherRRWebPlugins",value:function(){var e=[];return yC.rrwebConsoleRecord&&this.isConsoleLogCaptureEnabled&&e.push(yC.rrwebConsoleRecord.getRecordConsolePlugin()),this.networkPayloadCapture&&YE(yC.getRecordNetworkPlugin)&&(!AT.includes(location.hostname)||this._forceAllowLocalhostNetworkCapture?e.push(yC.getRecordNetworkPlugin(function(e,t){var n,r,i,s={payloadSizeLimitBytes:hx.payloadSizeLimitBytes,performanceEntryTypeToObserve:qE(hx.performanceEntryTypeToObserve)},o=!1!==e.session_recording.recordHeaders&&t.recordHeaders,a=!1!==e.session_recording.recordBody&&t.recordBody,l=!1!==e.capture_performance&&t.recordPerformance,c=(n=s,i=Math.min(1e6,null!==(r=n.payloadSizeLimitBytes)&&void 0!==r?r:1e6),function(e){return null!=e&&e.requestBody&&(e.requestBody=gx(e.requestBody,e.requestHeaders,i,"Request")),null!=e&&e.responseBody&&(e.responseBody=gx(e.responseBody,e.responseHeaders,i,"Response")),e}),u=function(e){return c(function(e){var t=OT(e.name);if(!(t&&t.pathname&&px.some((function(e){return 0===t.pathname.indexOf(e)}))))return e}((t=e,EC(Object.keys(null!==(n=t.requestHeaders)&&void 0!==n?n:{}),(function(e){var n;dx.includes(e.toLowerCase())&&(null===(n=t.requestHeaders)||void 0===n||delete n[e])})),t)));var t,n},h=YE(e.session_recording.maskNetworkRequestFn);return h&&YE(e.session_recording.maskCapturedNetworkRequestFn)&&bC.warn("Both `maskNetworkRequestFn` and `maskCapturedNetworkRequestFn` are defined. `maskNetworkRequestFn` will be ignored."),h&&(e.session_recording.maskCapturedNetworkRequestFn=function(t){var n=e.session_recording.maskNetworkRequestFn({url:t.name});return OE(OE({},t),{},{name:null==n?void 0:n.url})}),s.maskRequestFn=YE(e.session_recording.maskCapturedNetworkRequestFn)?function(t){var n,r,i,s=u(t);return s&&null!==(n=null===(r=(i=e.session_recording).maskCapturedNetworkRequestFn)||void 0===r?void 0:r.call(i,s))&&void 0!==n?n:void 0}:function(e){return function(e){if(!ZE(e))return e.requestBody=mx(e.requestBody,"Request"),e.responseBody=mx(e.responseBody,"Response"),e}(u(e))},OE(OE(OE({},hx),s),{},{recordHeaders:o,recordBody:a,recordPerformance:l,recordInitialRequests:l})}(this.instance.config,this.networkPayloadCapture))):bC.info(Ox+" NetworkCapture not started because we are on localhost.")),e}},{key:"onRRwebEmit",value:function(e){if(this._processQueuedEvents(),e&&JE(e)){if(e.type===jI.Meta){var t=this._maskUrl(e.data.href);if(this._lastHref=t,!t)return;e.data.href=t}else this._pageViewFallBack();e.type===jI.FullSnapshot&&this._scheduleFullSnapshot();var n=this.mutationRateLimiter?this.mutationRateLimiter.throttleMutations(e):e;if(n){var r=function(e){var t=e;if(t&&JE(t)&&6===t.type&&JE(t.data)&&"rrweb/console@1"===t.data.plugin){t.data.payload.payload.length>10&&(t.data.payload.payload=t.data.payload.payload.slice(0,10),t.data.payload.payload.push("...[truncated]"));for(var n=[],r=0;r<t.data.payload.payload.length;r++)t.data.payload.payload[r]&&t.data.payload.payload[r].length>2e3?n.push(t.data.payload.payload[r].slice(0,2e3)+"...[truncated]"):n.push(t.data.payload.payload[r]);return t.data.payload.payload=n,e}return e}(n),i=JSON.stringify(r).length;if(this._updateWindowAndSessionIds(r),!this.isIdle||r.type===jI.Custom){var s={$snapshot_bytes:i,$snapshot_data:r,$session_id:this.sessionId,$window_id:this.windowId};"disabled"!==this.status?this._captureSnapshotBuffered(s):this.clearBuffer()}}}}},{key:"_pageViewFallBack",value:function(){if(!this.instance.config.capture_pageview&&oC){var e=this._maskUrl(oC.location.href);this._lastHref!==e&&(this._tryAddCustomEvent("$url_changed",{href:e}),this._lastHref=e)}}},{key:"_processQueuedEvents",value:function(){var e=this;if(this.queuedRRWebEvents.length){var t=qE(this.queuedRRWebEvents);this.queuedRRWebEvents=[],t.forEach((function(n){Date.now()-n.enqueuedAt>2e3?e._tryAddCustomEvent("rrwebQueueTimeout",{enqueuedAt:n.enqueuedAt,attempt:n.attempt,queueLength:t.length}):e._tryRRWebMethod(n)&&e._tryAddCustomEvent("rrwebQueueSuccess",{enqueuedAt:n.enqueuedAt,attempt:n.attempt,queueLength:t.length})}))}}},{key:"_maskUrl",value:function(e){var t=this.instance.config.session_recording;if(t.maskNetworkRequestFn){var n,r={url:e};return null===(n=r=t.maskNetworkRequestFn(r))||void 0===n?void 0:n.url}return e}},{key:"clearBuffer",value:function(){return this.buffer=void 0,{size:0,data:[],sessionId:this.sessionId,windowId:this.windowId}}},{key:"_flushBuffer",value:function(){var e=this;this.flushBufferTimer&&(clearTimeout(this.flushBufferTimer),this.flushBufferTimer=void 0);var t=this.minimumDuration,n=this.sessionDuration,r=rC(n)&&n>=0,i=rC(t)&&r&&n<t;return"buffering"===this.status||i?(this.flushBufferTimer=setTimeout((function(){e._flushBuffer()}),2e3),this.buffer||this.clearBuffer()):this.buffer&&0!==this.buffer.data.length?(this._captureSnapshot({$snapshot_bytes:this.buffer.size,$snapshot_data:this.buffer.data,$session_id:this.buffer.sessionId,$window_id:this.buffer.windowId}),this.clearBuffer()):this.buffer||this.clearBuffer()}},{key:"_captureSnapshotBuffered",value:function(e){var t,n=this,r=2+((null===(t=this.buffer)||void 0===t?void 0:t.data.length)||0);(!this.buffer||this.buffer.size+e.$snapshot_bytes+r>943718.4||this.buffer.sessionId&&this.buffer.sessionId!==this.sessionId)&&(this.buffer=this._flushBuffer()),tC(this.buffer.sessionId)&&!tC(this.sessionId)&&(this.buffer.sessionId=this.sessionId,this.buffer.windowId=this.windowId),this.buffer.size+=e.$snapshot_bytes,this.buffer.data.push(e.$snapshot_data),this.flushBufferTimer||(this.flushBufferTimer=setTimeout((function(){n._flushBuffer()}),2e3))}},{key:"_captureSnapshot",value:function(e){this.instance.capture("$snapshot",e,{_url:this.instance.requestRouter.endpointFor("api",this._endpoint),_noTruncate:!0,_batchKey:"recordings",_noHeatmaps:!0})}}]),e}(),Lx=function(){function e(t){LE(this,e),this.instance=t,this.instance.decideEndpointWasHit=this.instance._hasBootstrappedFeatureFlags()}return ME(e,[{key:"call",value:function(){var e=this,t={token:this.instance.config.token,distinct_id:this.instance.get_distinct_id(),groups:this.instance.getGroups(),person_properties:this.instance.get_property(YC),group_properties:this.instance.get_property(JC),disable_flags:this.instance.config.advanced_disable_feature_flags||this.instance.config.advanced_disable_feature_flags_on_first_load||void 0};this.instance._send_request({method:"POST",url:this.instance.requestRouter.endpointFor("api","/decide/?v=3"),data:t,compression:this.instance.config.disable_compression?void 0:AC.Base64,timeout:this.instance.config.feature_flag_request_timeout_ms,callback:function(t){return e.parseDecideResponse(t.json)}})}},{key:"parseDecideResponse",value:function(e){var t=this;this.instance.featureFlags.setReloadingPaused(!1),this.instance.featureFlags._startReloadTimer();var n=!e;if(this.instance.config.advanced_disable_feature_flags_on_first_load||this.instance.config.advanced_disable_feature_flags||this.instance.featureFlags.receivedFeatureFlags(null!=e?e:{},n),n)bC.error("Failed to fetch feature flags from PostHog.");else{if(!dC||!dC.body)return bC.info("document not ready yet, trying again in 500 milliseconds..."),void setTimeout((function(){t.parseDecideResponse(e)}),500);this.instance._afterDecideResponse(e);var r=null==oC?void 0:oC.extendPostHogWithExceptionAutoCapture;if(e.autocaptureExceptions&&e.autocaptureExceptions&&ZE(r)&&DC(this.instance.requestRouter.endpointFor("assets","/static/exception-autocapture.js"),(function(n){if(n)return bC.error("Could not load exception autocapture script",n);oC.extendPostHogWithExceptionAutocapture(t.instance,e)})),e.siteApps)if(this.instance.config.opt_in_site_apps){var i,s=BE(e.siteApps);try{var o=function(){var e=i.value,n=e.id,r=e.url,s=t.instance.requestRouter.endpointFor("api",r);yC["__$$ph_site_app_".concat(n)]=t.instance,DC(s,(function(e){e&&bC.error("Error while initializing PostHog app with config id ".concat(n),e)}))};for(s.s();!(i=s.n()).done;)o()}catch(e){s.e(e)}finally{s.f()}}else e.siteApps.length>0&&bC.error('PostHog site apps are disabled. Enable the "opt_in_site_apps" config to proceed.')}}}]),e}(),Fx=null!=oC&&oC.location?LT(oC.location.hash,"__posthog")||LT(location.hash,"state"):null,Mx="_postHogToolbarParams",jx=function(){function e(t){LE(this,e),jE(this,"_toolbarScriptLoaded",!1),this.instance=t}return ME(e,[{key:"maybeLoadToolbar",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;if(!oC||!dC)return!1;n=null!==(e=n)&&void 0!==e?e:oC.location,i=null!==(t=i)&&void 0!==t?t:oC.history;try{if(!r){try{oC.localStorage.setItem("test","test"),oC.localStorage.removeItem("test")}catch(e){return!1}r=null==oC?void 0:oC.localStorage}var s,o=Fx||LT(n.hash,"__posthog")||LT(n.hash,"state"),a=o?RC((function(){return JSON.parse(atob(decodeURIComponent(o)))}))||RC((function(){return JSON.parse(decodeURIComponent(o))})):null;return a&&"ph_authorize"===a.action?((s=a).source="url",s&&Object.keys(s).length>0&&(a.desiredHash?n.hash=a.desiredHash:i?i.replaceState("",dC.title,n.pathname+n.search):n.hash="")):((s=JSON.parse(r.getItem(Mx)||"{}")).source="localstorage",delete s.userIntent),!(!s.token||this.instance.config.token!==s.token)&&(this.loadToolbar(s),!0)}catch(e){return!1}}},{key:"_callLoadToolbar",value:function(e){(yC.ph_load_toolbar||yC.ph_load_editor)(e,this.instance)}},{key:"loadToolbar",value:function(e){var t=this;if(!oC||oC.localStorage.getItem(Mx)&&this._toolbarScriptLoaded)return!1;var n="custom"===this.instance.requestRouter.region&&this.instance.config.advanced_disable_toolbar_metrics,r=OE(OE({token:this.instance.config.token},e),{},{apiURL:this.instance.requestRouter.endpointFor("ui")},n?{instrument:!1}:{});if(oC.localStorage.setItem(Mx,JSON.stringify(OE(OE({},r),{},{source:void 0}))),this._toolbarScriptLoaded)this._callLoadToolbar(r);else{this._toolbarScriptLoaded=!0;var i=3e5,s=Math.floor(Date.now()/i)*i;DC(this.instance.requestRouter.endpointFor("assets","/static/toolbar.js?t=".concat(s)),(function(e){if(e)return bC.error("Failed to load toolbar",e),void(t._toolbarScriptLoaded=!1);t._callLoadToolbar(r)})),OC(oC,"turbolinks:load",(function(){t._toolbarScriptLoaded=!1,t.loadToolbar(r)}))}return!0}},{key:"_loadEditor",value:function(e){return this.loadToolbar(e)}},{key:"maybeLoadEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return this.maybeLoadToolbar(e,t,n)}}]),e}(),Ux=function(){function e(t){LE(this,e),jE(this,"isPaused",!0),jE(this,"queue",[]),jE(this,"flushTimeoutMs",3e3),this.sendRequest=t}return ME(e,[{key:"enqueue",value:function(e){this.queue.push(e),this.flushTimeout||this.setFlushTimeout()}},{key:"unload",value:function(){var e=this;this.clearFlushTimeout();var t=this.queue.length>0?this.formatQueue():{},n=Object.values(t);[].concat(qE(n.filter((function(e){return 0===e.url.indexOf("/e")}))),qE(n.filter((function(e){return 0!==e.url.indexOf("/e")})))).map((function(t){e.sendRequest(OE(OE({},t),{},{transport:"sendBeacon"}))}))}},{key:"enable",value:function(){this.isPaused=!1,this.setFlushTimeout()}},{key:"setFlushTimeout",value:function(){var e=this;this.isPaused||(this.flushTimeout=setTimeout((function(){if(e.clearFlushTimeout(),e.queue.length>0){var t=e.formatQueue(),n=function(n){var r=t[n],i=(new Date).getTime();r.data&&QE(r.data)&&EC(r.data,(function(e){e.offset=Math.abs(e.timestamp-i),delete e.timestamp})),e.sendRequest(r)};for(var r in t)n(r)}}),this.flushTimeoutMs))}},{key:"clearFlushTimeout",value:function(){clearTimeout(this.flushTimeout),this.flushTimeout=void 0}},{key:"formatQueue",value:function(){var e={};return EC(this.queue,(function(t){var n,r=t,i=(r?r.batchKey:null)||r.url;ZE(e[i])&&(e[i]=OE(OE({},r),{},{data:[]})),null===(n=e[i].data)||void 0===n||n.push(r.data)})),this.queue=[],e}}]),e}(),qx=Uint8Array,Vx=Uint16Array,zx=Uint32Array,Bx=new qx([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Hx=new qx([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Wx=new qx([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Gx=function(e,t){for(var n=new Vx(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];var i=new zx(n[30]);for(r=1;r<30;++r)for(var s=n[r];s<n[r+1];++s)i[s]=s-n[r]<<5|r;return[n,i]},$x=Gx(Bx,2),Kx=$x[0],Qx=$x[1];Kx[28]=258,Qx[258]=28;for(var Yx=Gx(Hx,0)[1],Jx=new Vx(32768),Xx=0;Xx<32768;++Xx){var Zx=(43690&Xx)>>>1|(21845&Xx)<<1;Zx=(61680&(Zx=(52428&Zx)>>>2|(13107&Zx)<<2))>>>4|(3855&Zx)<<4,Jx[Xx]=((65280&Zx)>>>8|(255&Zx)<<8)>>>1}var eR=function(e,t,n){for(var r=e.length,i=0,s=new Vx(t);i<r;++i)++s[e[i]-1];var o,a=new Vx(t);for(i=0;i<t;++i)a[i]=a[i-1]+s[i-1]<<1;if(n){o=new Vx(1<<t);var l=15-t;for(i=0;i<r;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=a[e[i]-1]++<<u,d=h|(1<<u)-1;h<=d;++h)o[Jx[h]>>>l]=c}else for(o=new Vx(r),i=0;i<r;++i)o[i]=Jx[a[e[i]-1]++]>>>15-e[i];return o},tR=new qx(288);for(Xx=0;Xx<144;++Xx)tR[Xx]=8;for(Xx=144;Xx<256;++Xx)tR[Xx]=9;for(Xx=256;Xx<280;++Xx)tR[Xx]=7;for(Xx=280;Xx<288;++Xx)tR[Xx]=8;var nR=new qx(32);for(Xx=0;Xx<32;++Xx)nR[Xx]=5;var rR=eR(tR,9,0),iR=eR(nR,5,0),sR=function(e){return(e/8|0)+(7&e&&1)},oR=function(e,t,n){(null==t||t<0)&&(t=0),(null==n||n>e.length)&&(n=e.length);var r=new(e instanceof Vx?Vx:e instanceof zx?zx:qx)(n-t);return r.set(e.subarray(t,n)),r},aR=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8},lR=function(e,t,n){n<<=7&t;var r=t/8|0;e[r]|=n,e[r+1]|=n>>>8,e[r+2]|=n>>>16},cR=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var i=n.length,s=n.slice();if(!i)return[new qx(0),0];if(1==i){var o=new qx(n[0].s+1);return o[n[0].s]=1,[o,1]}n.sort((function(e,t){return e.f-t.f})),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,h=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=i-1;)a=n[n[c].f<n[h].f?c++:h++],l=n[c!=u&&n[c].f<n[h].f?c++:h++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};var d=s[0].s;for(r=1;r<i;++r)s[r].s>d&&(d=s[r].s);var f=new Vx(d+1),p=uR(n[u-1],f,0);if(p>t){r=0;var g=0,m=p-t,v=1<<m;for(s.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));r<i;++r){var y=s[r].s;if(!(f[y]>t))break;g+=v-(1<<p-f[y]),f[y]=t}for(g>>>=m;g>0;){var _=s[r].s;f[_]<t?g-=1<<t-f[_]++-1:++r}for(;r>=0&&g;--r){var b=s[r].s;f[b]==t&&(--f[b],++g)}p=t}return[new qx(f),p]},uR=function e(t,n,r){return-1==t.s?Math.max(e(t.l,n,r+1),e(t.r,n,r+1)):n[t.s]=r},hR=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new Vx(++t),r=0,i=e[0],s=1,o=function(e){n[r++]=e},a=1;a<=t;++a)if(e[a]==i&&a!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[a]}return[n.subarray(0,r),t]},dR=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},fR=function(e,t,n){var r=n.length,i=sR(t+2);e[i]=255&r,e[i+1]=r>>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<r;++s)e[i+s+4]=n[s];return 8*(i+4+r)},pR=function(e,t,n,r,i,s,o,a,l,c,u){aR(t,u++,n),++i[256];for(var h=cR(i,15),d=h[0],f=h[1],p=cR(s,15),g=p[0],m=p[1],v=hR(d),y=v[0],_=v[1],b=hR(g),w=b[0],k=b[1],S=new Vx(19),E=0;E<y.length;++E)S[31&y[E]]++;for(E=0;E<w.length;++E)S[31&w[E]]++;for(var C=cR(S,7),T=C[0],I=C[1],x=19;x>4&&!T[Wx[x-1]];--x);var R,N,P,A,O=c+5<<3,D=dR(i,tR)+dR(s,nR)+o,L=dR(i,d)+dR(s,g)+o+14+3*x+dR(S,T)+(2*S[16]+3*S[17]+7*S[18]);if(O<=D&&O<=L)return fR(t,u,e.subarray(l,l+c));if(aR(t,u,1+(L<D)),u+=2,L<D){R=eR(d,f,0),N=d,P=eR(g,m,0),A=g;var F=eR(T,I,0);for(aR(t,u,_-257),aR(t,u+5,k-1),aR(t,u+10,x-4),u+=14,E=0;E<x;++E)aR(t,u+3*E,T[Wx[E]]);u+=3*x;for(var M=[y,w],j=0;j<2;++j){var U=M[j];for(E=0;E<U.length;++E){var q=31&U[E];aR(t,u,F[q]),u+=T[q],q>15&&(aR(t,u,U[E]>>>5&127),u+=U[E]>>>12)}}}else R=rR,N=tR,P=iR,A=nR;for(E=0;E<a;++E)if(r[E]>255){q=r[E]>>>18&31,lR(t,u,R[q+257]),u+=N[q+257],q>7&&(aR(t,u,r[E]>>>23&31),u+=Bx[q]);var V=31&r[E];lR(t,u,P[V]),u+=A[V],V>3&&(lR(t,u,r[E]>>>5&8191),u+=Hx[V])}else lR(t,u,R[r[E]]),u+=N[r[E]];return lR(t,u,R[256]),u+N[256]},gR=new zx([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),mR=new qx(0),vR=function(){for(var e=new zx(256),t=0;t<256;++t){for(var n=t,r=9;--r;)n=(1&n&&3988292384)^n>>>1;e[t]=n}return e}(),yR=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8};function _R(e,t){void 0===t&&(t={});var n=function(){var e=4294967295;return{p:function(t){for(var n=e,r=0;r<t.length;++r)n=vR[255&n^t[r]]^n>>>8;e=n},d:function(){return 4294967295^e}}}(),r=e.length;n.p(e);var i,s=function(e,t,n,r,i){return function(e,t,n,r,i,s){var o=e.length,a=new qx(r+o+5*(1+Math.floor(o/7e3))+i),l=a.subarray(r,a.length-i),c=0;if(!t||o<8)for(var u=0;u<=o;u+=65535){var h=u+65535;h<o?c=fR(l,c,e.subarray(u,h)):(l[u]=s,c=fR(l,c,e.subarray(u,o)))}else{for(var d=gR[t-1],f=d>>>13,p=8191&d,g=(1<<n)-1,m=new Vx(32768),v=new Vx(g+1),y=Math.ceil(n/3),_=2*y,b=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<_)&g},w=new zx(25e3),k=new Vx(288),S=new Vx(32),E=0,C=0,T=(u=0,0),I=0,x=0;u<o;++u){var R=b(u),N=32767&u,P=v[R];if(m[N]=P,v[R]=N,I<=u){var A=o-u;if((E>7e3||T>24576)&&A>423){c=pR(e,l,0,w,k,S,C,T,x,u-x,c),T=E=C=0,x=u;for(var O=0;O<286;++O)k[O]=0;for(O=0;O<30;++O)S[O]=0}var D=2,L=0,F=p,M=N-P&32767;if(A>2&&R==b(u-M))for(var j=Math.min(f,A)-1,U=Math.min(32767,u),q=Math.min(258,A);M<=U&&--F&&N!=P;){if(e[u+D]==e[u+D-M]){for(var V=0;V<q&&e[u+V]==e[u+V-M];++V);if(V>D){if(D=V,L=M,V>j)break;var z=Math.min(M,V-2),B=0;for(O=0;O<z;++O){var H=u-M+O+32768&32767,W=H-m[H]+32768&32767;W>B&&(B=W,P=H)}}}M+=(N=P)-(P=m[N])+32768&32767}if(L){w[T++]=268435456|Qx[D]<<18|Yx[L];var G=31&Qx[D],$=31&Yx[L];C+=Bx[G]+Hx[$],++k[257+G],++S[$],I=u+D,++E}else w[T++]=e[u],++k[e[u]]}}c=pR(e,l,s,w,k,S,C,T,x,u-x,c),s||(c=fR(l,c,mR))}return oR(a,0,r+sR(c)+i)}(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,n,r,!i)}(e,t,10+((i=t).filename&&i.filename.length+1||0),8),o=s.length;return function(e,t){var n=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&yR(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),n){e[3]=8;for(var r=0;r<=n.length;++r)e[r+10]=n.charCodeAt(r)}}(s,t),yR(s,o-8,n.d()),yR(s,o-4,r),s}var bR,wR=!!gC||!!pC,kR="text/plain",SR=function(e,t){var n=UE(e.split("?"),2),r=n[0],i=n[1],s=OE({},t);null==i||i.split("&").forEach((function(e){var t=UE(e.split("="),1)[0];delete s[t]}));var o=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",i=[];return EC(e,(function(e,r){ZE(e)||ZE(r)||"undefined"===r||(t=encodeURIComponent(function(e){return e instanceof File}(e)?e.name:e.toString()),n=encodeURIComponent(r),i[i.length]=n+"="+t)})),i.join(r)}(s);return o=o?(i?i+"&":"")+o:i,"".concat(r,"?").concat(o)},ER=function(e){return"data="+encodeURIComponent("string"==typeof e?e:JSON.stringify(e))},CR=function(e){var t=e.data,n=e.compression;if(t){if(n===AC.GZipJS){var r=_R(function(e,t){var n=e.length;if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);for(var r=new qx(e.length+(e.length>>>1)),i=0,s=function(e){r[i++]=e},o=0;o<n;++o){if(i+5>r.length){var a=new qx(i+8+(n-o<<1));a.set(r),r=a}var l=e.charCodeAt(o);l<128?s(l):l<2048?(s(192|l>>>6),s(128|63&l)):l>55295&&l<57344?(s(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++o))>>>18),s(128|l>>>12&63),s(128|l>>>6&63),s(128|63&l)):(s(224|l>>>12),s(128|l>>>6&63),s(128|63&l))}return oR(r,0,i)}(JSON.stringify(t)),{mtime:0});return{contentType:kR,body:new Blob([r],{type:kR})}}if(n===AC.Base64){var i=function(e){var t,n,r,i,s,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",a=0,l=0,c="",u=[];if(!e)return e;e=function(e){var t,n,r,i,s="";for(t=n=0,r=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length,i=0;i<r;i++){var o=e.charCodeAt(i),a=null;o<128?n++:a=o>127&&o<2048?String.fromCharCode(o>>6|192,63&o|128):String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128),tC(a)||(n>t&&(s+=e.substring(t,n)),s+=a,t=n=i+1)}return n>t&&(s+=e.substring(t,e.length)),s}(e);do{t=(s=e.charCodeAt(a++)<<16|e.charCodeAt(a++)<<8|e.charCodeAt(a++))>>18&63,n=s>>12&63,r=s>>6&63,i=63&s,u[l++]=o.charAt(t)+o.charAt(n)+o.charAt(r)+o.charAt(i)}while(a<e.length);switch(c=u.join(""),e.length%3){case 1:c=c.slice(0,-2)+"==";break;case 2:c=c.slice(0,-1)+"="}return c}(JSON.stringify(t));return{contentType:"application/x-www-form-urlencoded",body:ER(i)}}return{contentType:"application/json",body:JSON.stringify(t)}}},TR=["retriesPerformedSoFar"],IR=function(){function e(t){var n=this;LE(this,e),jE(this,"isPolling",!1),jE(this,"pollIntervalMs",3e3),jE(this,"queue",[]),this.instance=t,this.queue=[],this.areWeOnline=!0,!ZE(oC)&&"onLine"in oC.navigator&&(this.areWeOnline=oC.navigator.onLine,oC.addEventListener("online",(function(){n.areWeOnline=!0,n.flush()})),oC.addEventListener("offline",(function(){n.areWeOnline=!1})))}return ME(e,[{key:"retriableRequest",value:function(e){var t=this,n=e.retriesPerformedSoFar,r=function(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(e,TR);rC(n)&&n>0&&(r.url=SR(r.url,{retry_count:n})),this.instance._send_request(OE(OE({},r),{},{callback:function(e){var i;200!==e.statusCode&&(e.statusCode<400||e.statusCode>=500)&&(null!=n?n:0)<10?t.enqueue(OE({},r)):null===(i=r.callback)||void 0===i||i.call(r,e)}}))}},{key:"enqueue",value:function(e){var t=e.retriesPerformedSoFar||0;e.retriesPerformedSoFar=t+1;var n=function(e){var t=3e3*Math.pow(2,e),n=t/2,r=Math.min(18e5,t),i=(Math.random()-.5)*(r-n);return Math.ceil(r+i)}(t),r=Date.now()+n;this.queue.push({retryAt:r,requestOptions:e});var i="Enqueued failed request for retry in ".concat(n);navigator.onLine||(i+=" (Browser is offline)"),bC.warn(i),this.isPolling||(this.isPolling=!0,this.poll())}},{key:"poll",value:function(){var e=this;this.poller&&clearTimeout(this.poller),this.poller=setTimeout((function(){e.areWeOnline&&e.queue.length>0&&e.flush(),e.poll()}),this.pollIntervalMs)}},{key:"flush",value:function(){var e=Date.now(),t=[],n=this.queue.filter((function(n){return n.retryAt<e||(t.push(n),!1)}));if(this.queue=t,n.length>0){var r,i=BE(n);try{for(i.s();!(r=i.n()).done;){var s=r.value.requestOptions;this.retriableRequest(s)}}catch(e){i.e(e)}finally{i.f()}}}},{key:"unload",value:function(){this.poller&&(clearTimeout(this.poller),this.poller=void 0);var e,t=BE(this.queue);try{for(t.s();!(e=t.n()).done;){var n=e.value.requestOptions;try{this.instance._send_request(OE(OE({},n),{},{transport:"sendBeacon"}))}catch(e){bC.error(e)}}}catch(e){t.e(e)}finally{t.f()}this.queue=[]}}]),e}(),xR=1800,RR=function(){function e(t,n,r,i){LE(this,e),jE(this,"_sessionIdChangedHandlers",[]),this.config=t,this.persistence=n,this._windowId=void 0,this._sessionId=void 0,this._sessionStartTimestamp=null,this._sessionActivityTimestamp=null,this._sessionIdGenerator=r||yT,this._windowIdGenerator=i||yT;var s=t.persistence_name||t.token,o=t.session_idle_timeout_seconds||xR;if(rC(o)?o>xR?bC.warn("session_idle_timeout_seconds cannot be  greater than 30 minutes. Using 30 minutes instead."):o<60&&bC.warn("session_idle_timeout_seconds cannot be less than 60 seconds. Using 60 seconds instead."):(bC.warn("session_idle_timeout_seconds must be a number. Defaulting to 30 minutes."),o=xR),this._sessionTimeoutMs=1e3*Math.min(Math.max(o,60),xR),this._window_id_storage_key="ph_"+s+"_window_id",this._primary_window_exists_storage_key="ph_"+s+"_primary_window_exists",this._canUseSessionStorage()){var a=PT.parse(this._window_id_storage_key),l=PT.parse(this._primary_window_exists_storage_key);a&&!l?this._windowId=a:PT.remove(this._window_id_storage_key),PT.set(this._primary_window_exists_storage_key,!0)}this._listenToReloadWindow()}return ME(e,[{key:"onSessionId",value:function(e){var t=this;return ZE(this._sessionIdChangedHandlers)&&(this._sessionIdChangedHandlers=[]),this._sessionIdChangedHandlers.push(e),this._sessionId&&e(this._sessionId,this._windowId),function(){t._sessionIdChangedHandlers=t._sessionIdChangedHandlers.filter((function(t){return t!==e}))}}},{key:"_canUseSessionStorage",value:function(){return"memory"!==this.config.persistence&&!this.persistence.disabled&&PT.is_supported()}},{key:"_setWindowId",value:function(e){e!==this._windowId&&(this._windowId=e,this._canUseSessionStorage()&&PT.set(this._window_id_storage_key,e))}},{key:"_getWindowId",value:function(){return this._windowId?this._windowId:this._canUseSessionStorage()?PT.parse(this._window_id_storage_key):null}},{key:"_setSessionId",value:function(e,t,n){e===this._sessionId&&t===this._sessionActivityTimestamp&&n===this._sessionStartTimestamp||(this._sessionStartTimestamp=n,this._sessionActivityTimestamp=t,this._sessionId=e,this.persistence.register(jE({},GC,[t,e,n])))}},{key:"_getSessionId",value:function(){if(this._sessionId&&this._sessionActivityTimestamp&&this._sessionStartTimestamp)return[this._sessionActivityTimestamp,this._sessionId,this._sessionStartTimestamp];var e=this.persistence.props[GC];return QE(e)&&2===e.length&&e.push(e[0]),e||[0,null,0]}},{key:"resetSessionId",value:function(){this._setSessionId(null,null,null)}},{key:"_listenToReloadWindow",value:function(){var e=this;null==oC||oC.addEventListener("beforeunload",(function(){e._canUseSessionStorage()&&PT.remove(e._primary_window_exists_storage_key)}))}},{key:"checkAndGetSessionAndWindowId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||(new Date).getTime(),n=UE(this._getSessionId(),3),r=n[0],i=n[1],s=n[2],o=this._getWindowId(),a=s&&s>0&&Math.abs(t-s)>864e5,l=!1,c=!i,u=!e&&Math.abs(t-r)>this._sessionTimeoutMs;c||u||a?(i=this._sessionIdGenerator(),o=this._windowIdGenerator(),bC.info("[SessionId] new session ID generated",{sessionId:i,windowId:o,changeReason:{noSessionId:c,activityTimeout:u,sessionPastMaximumLength:a}}),s=t,l=!0):o||(o=this._windowIdGenerator(),l=!0);var h=0===r||!e||a?t:r,d=0===s?(new Date).getTime():s;return this._setWindowId(o),this._setSessionId(i,h,d),l&&this._sessionIdChangedHandlers.forEach((function(e){return e(i,o)})),{sessionId:i,windowId:o,sessionStartTimestamp:d}}}]),e}();!function(e){e.US="us",e.EU="eu",e.CUSTOM="custom"}(bR||(bR={}));var NR="i.posthog.com",PR=function(){function e(t){LE(this,e),jE(this,"_regionCache",{}),this.instance=t}return ME(e,[{key:"apiHost",get:function(){return this.instance.config.api_host.trim().replace(/\/$/,"")}},{key:"uiHost",get:function(){var e;return null===(e=this.instance.config.ui_host)||void 0===e?void 0:e.replace(/\/$/,"")}},{key:"region",get:function(){return this._regionCache[this.apiHost]||(/https:\/\/(app|us|us-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=bR.US:/https:\/\/(eu|eu-assets)(\.i)?\.posthog\.com/i.test(this.apiHost)?this._regionCache[this.apiHost]=bR.EU:this._regionCache[this.apiHost]=bR.CUSTOM),this._regionCache[this.apiHost]}},{key:"endpointFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t&&(t="/"===t[0]?t:"/".concat(t)),"ui"===e)return(this.uiHost||this.apiHost.replace(".".concat(NR),".posthog.com"))+t;if(this.region===bR.CUSTOM)return this.apiHost+t;var n=NR+t;switch(e){case"assets":return"https://".concat(this.region,"-assets.").concat(n);case"api":return"https://".concat(this.region,".").concat(n)}}}]),e}(),AR=ME((function e(t,n,r,i){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:["error"];LE(this,e),this.name="posthog-js",this.setupOnce=function(e){e((function(e){var o,a,l,c,u;if("*"!==s&&!s.includes(e.level)||!t.__loaded)return e;e.tags||(e.tags={});var h=t.requestRouter.endpointFor("ui","/project/".concat(t.config.token,"/person/").concat(t.get_distinct_id()));e.tags["PostHog Person URL"]=h,t.sessionRecordingStarted()&&(e.tags["PostHog Recording URL"]=t.get_session_replay_url({withTimestamp:!0}));var d=(null===(o=e.exception)||void 0===o?void 0:o.values)||[],f={$exception_message:(null===(a=d[0])||void 0===a?void 0:a.value)||e.message,$exception_type:null===(l=d[0])||void 0===l?void 0:l.type,$exception_personURL:h,$sentry_event_id:e.event_id,$sentry_exception:e.exception,$sentry_exception_message:(null===(c=d[0])||void 0===c?void 0:c.value)||e.message,$sentry_exception_type:null===(u=d[0])||void 0===u?void 0:u.type,$sentry_tags:e.tags,$level:e.level};return n&&r&&(f.$sentry_url=(i||"https://sentry.io/organizations/")+n+"/issues/?project="+r+"&query="+e.event_id),t.capture("$exception",f),e}))}}));var OR=function(){function e(t){LE(this,e),this._instance=t}return ME(e,[{key:"doPageView",value:function(){var e,t=this._previousScrollProperties();return this._currentPath=null!==(e=null==oC?void 0:oC.location.pathname)&&void 0!==e?e:"",this._instance.scrollManager.resetContext(),t}},{key:"doPageLeave",value:function(){return this._previousScrollProperties()}},{key:"_previousScrollProperties",value:function(){var e=this._currentPath,t=this._instance.scrollManager.getContext();if(!e||!t)return{};var n=t.maxScrollHeight,r=t.lastScrollY,i=t.maxScrollY,s=t.maxContentHeight,o=t.lastContentY,a=t.maxContentY;return ZE(n)||ZE(r)||ZE(i)||ZE(s)||ZE(o)||ZE(a)?{}:(n=Math.ceil(n),r=Math.ceil(r),i=Math.ceil(i),s=Math.ceil(s),o=Math.ceil(o),a=Math.ceil(a),{$prev_pageview_pathname:e,$prev_pageview_last_scroll:r,$prev_pageview_last_scroll_percentage:n<=1?1:DR(r/n,0,1),$prev_pageview_max_scroll:i,$prev_pageview_max_scroll_percentage:n<=1?1:DR(i/n,0,1),$prev_pageview_last_content:o,$prev_pageview_last_content_percentage:s<=1?1:DR(o/s,0,1),$prev_pageview_max_content:a,$prev_pageview_max_content_percentage:s<=1?1:DR(a/s,0,1)})}}]),e}();function DR(e,t,n){return Math.max(t,Math.min(e,n))}var LR={icontains:function(e){return!!oC&&oC.location.href.toLowerCase().indexOf(e.toLowerCase())>-1},regex:function(e){return!!oC&&function(e,t){return!!function(e){try{new RegExp(e)}catch(e){return!1}return!0}(t)&&new RegExp(t).test(e)}(oC.location.href,e)},exact:function(e){return(null==oC?void 0:oC.location.href)===e}},FR=function(){function e(t){LE(this,e),this.instance=t}return ME(e,[{key:"afterDecideResponse",value:function(e){this._decideServerResponse=!!e.surveys,this.loadIfEnabled()}},{key:"loadIfEnabled",value:function(){var e=this,t=null==yC?void 0:yC.extendPostHogWithSurveys;this.instance.config.disable_surveys||!this._decideServerResponse||t||DC(this.instance.requestRouter.endpointFor("assets","/static/surveys.js"),(function(t){if(t)return bC.error("Could not load surveys script",t);yC.extendPostHogWithSurveys(e.instance)}))}},{key:"getSurveys",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.instance.config.disable_surveys)return e([]);var r=this.instance.get_property(XC);if(r&&!n)return e(r);this.instance._send_request({url:this.instance.requestRouter.endpointFor("api","/api/surveys/?token=".concat(this.instance.config.token)),method:"GET",transport:"XHR",callback:function(n){var r;if(200!==n.statusCode||!n.json)return e([]);var i=n.json.surveys||[];return null===(r=t.instance.persistence)||void 0===r||r.register(jE({},XC,i)),e(i)}})}},{key:"getActiveMatchingSurveys",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.getSurveys((function(n){var r=n.filter((function(e){return!(!e.start_date||e.end_date)})).filter((function(e){var t,n,r,i;if(!e.conditions)return!0;var s=null===(t=e.conditions)||void 0===t||!t.url||LR[null!==(n=null===(r=e.conditions)||void 0===r?void 0:r.urlMatchType)&&void 0!==n?n:"icontains"](e.conditions.url),o=null===(i=e.conditions)||void 0===i||!i.selector||(null==dC?void 0:dC.querySelector(e.conditions.selector));return s&&o})).filter((function(e){if(!e.linked_flag_key&&!e.targeting_flag_key)return!0;var n=!e.linked_flag_key||t.instance.featureFlags.isFeatureEnabled(e.linked_flag_key),r=!e.targeting_flag_key||t.instance.featureFlags.isFeatureEnabled(e.targeting_flag_key);return n&&r}));return e(r)}),n)}}]),e}(),MR=function(){function e(t){var n,r,i=this;LE(this,e),jE(this,"serverLimits",{}),jE(this,"lastEventRateLimited",!1),jE(this,"checkForLimiting",(function(e){var t=e.text;if(t&&t.length)try{(JSON.parse(t).quota_limited||[]).forEach((function(e){bC.info("[RateLimiter] ".concat(e||"events"," is quota limited.")),i.serverLimits[e]=(new Date).getTime()+6e4}))}catch(e){return void bC.warn('[RateLimiter] could not rate limit - continuing. Error: "'.concat(null==e?void 0:e.message,'"'),{text:t})}})),this.instance=t,this.captureEventsPerSecond=(null===(n=t.config.rate_limiting)||void 0===n?void 0:n.events_per_second)||10,this.captureEventsBurstLimit=Math.max((null===(r=t.config.rate_limiting)||void 0===r?void 0:r.events_burst_limit)||10*this.captureEventsPerSecond,this.captureEventsPerSecond),this.lastEventRateLimited=this.clientRateLimitContext(!0).isRateLimited}return ME(e,[{key:"clientRateLimitContext",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=(new Date).getTime(),s=null!==(e=null===(t=this.instance.persistence)||void 0===t?void 0:t.get_property(nT))&&void 0!==e?e:{tokens:this.captureEventsBurstLimit,last:i};s.tokens+=(i-s.last)/1e3*this.captureEventsPerSecond,s.last=i,s.tokens>this.captureEventsBurstLimit&&(s.tokens=this.captureEventsBurstLimit);var o=s.tokens<1;return o||r||(s.tokens=Math.max(0,s.tokens-1)),!o||this.lastEventRateLimited||r||this.instance.capture("$$client_ingestion_warning",{$$client_ingestion_warning_message:"posthog-js client rate limited. Config is set to ".concat(this.captureEventsPerSecond," events per second and ").concat(this.captureEventsBurstLimit," events burst limit.")},{skip_client_rate_limiting:!0}),this.lastEventRateLimited=o,null===(n=this.instance.persistence)||void 0===n||n.set_property(nT,s),{isRateLimited:o,remainingTokens:s.tokens}}},{key:"isServerRateLimited",value:function(e){var t=this.serverLimits[e||"events"]||!1;return!1!==t&&(new Date).getTime()<t}}]),e}(),jR=function(){return OE({initialPathName:(null==fC?void 0:fC.pathname)||"",referringDomain:AI.referringDomain()},AI.campaignParams())},UR=function(){function e(t,n,r){var i=this;LE(this,e),jE(this,"_onSessionIdCallback",(function(e){var t=i._getStoredProps();if(!t||t.sessionId!==e){var n={sessionId:e,props:i._sessionSourceParamGenerator()};i._persistence.register(jE({},tT,n))}})),this._sessionIdManager=t,this._persistence=n,this._sessionSourceParamGenerator=r||jR,this._sessionIdManager.onSessionId(this._onSessionIdCallback)}return ME(e,[{key:"_getStoredProps",value:function(){return this._persistence.props[tT]}},{key:"getSessionProps",value:function(){var e,t=null===(e=this._getStoredProps())||void 0===e?void 0:e.props;return t?{$client_session_initial_referring_host:t.referringDomain,$client_session_initial_pathname:t.initialPathName,$client_session_initial_utm_source:t.utm_source,$client_session_initial_utm_campaign:t.utm_campaign,$client_session_initial_utm_medium:t.utm_medium,$client_session_initial_utm_content:t.utm_content,$client_session_initial_utm_term:t.utm_term}:{}}}]),e}(),qR=["ahrefsbot","ahrefssiteaudit","applebot","baiduspider","bingbot","bingpreview","bot.htm","bot.php","crawler","deepscan","duckduckbot","facebookexternal","facebookcatalog","gptbot","http://yandex.com/bots","hubspot","ia_archiver","linkedinbot","mj12bot","msnbot","nessus","petalbot","pinterest","prerender","rogerbot","screaming frog","semrushbot","sitebulb","slurp","turnitin","twitterbot","vercelbot","yahoo! slurp","yandexbot","adsbot-google","apis-google","duplexweb-google","feedfetcher-google","google favicon","google web preview","google-read-aloud","googlebot","googleweblight","mediapartners-google","storebot-google","Bytespider;"],VR=function(e,t){if(!e)return!1;var n=e.toLowerCase();return qR.concat(t||[]).some((function(e){var t=e.toLowerCase();return-1!==n.indexOf(t)}))},zR=function(){function e(){LE(this,e),this.clicks=[]}return ME(e,[{key:"isRageClick",value:function(e,t,n){var r=this.clicks[this.clicks.length-1];if(r&&Math.abs(e-r.x)+Math.abs(t-r.y)<30&&n-r.timestamp<1e3){if(this.clicks.push({x:e,y:t,timestamp:n}),3===this.clicks.length)return!0}else this.clicks=[{x:e,y:t,timestamp:n}];return!1}}]),e}(),BR="__POSTHOG_TOOLBAR__";function HR(e){var t;return e.id===BR||!(null===(t=e.closest)||void 0===t||!t.call(e,"#"+BR))}var WR=function(){function e(t){var n;LE(this,e),jE(this,"rageclicks",new zR),jE(this,"_enabledServerSide",!1),jE(this,"_initialized",!1),this.instance=t,this._enabledServerSide=!(null===(n=this.instance.persistence)||void 0===n||!n.props[UC])}return ME(e,[{key:"startIfEnabled",value:function(){this.isEnabled&&!this._initialized&&(bC.info("[heatmaps] Heatmaps enabled, starting..."),this._setupListeners())}},{key:"isEnabled",get:function(){return ZE(this.instance.config.enable_heatmaps)?this._enabledServerSide:this.instance.config.enable_heatmaps}},{key:"afterDecideResponse",value:function(e){var t=!!e.heatmaps;this.instance.persistence&&this.instance.persistence.register(jE({},UC,t)),this._enabledServerSide=t,this.startIfEnabled()}},{key:"getAndClearBuffer",value:function(){var e=this.buffer;return this.buffer=void 0,e}},{key:"_setupListeners",value:function(){var e=this;oC&&dC&&(OC(dC,"click",(function(t){return e._onClick(t||(null==oC?void 0:oC.event))}),!1,!0),OC(dC,"mousemove",(function(t){return e._onMouseMove(t||(null==oC?void 0:oC.event))}),!1,!0),this._initialized=!0)}},{key:"_getProperties",value:function(e,t){var n=this.instance.scrollManager.scrollY(),r=this.instance.scrollManager.scrollX(),i=this.instance.scrollManager.scrollElement(),s=function(e,t,n){for(var r=e;r&&!HI(r,"body");){if(r===n)return!1;if(TC(t,null==oC?void 0:oC.getComputedStyle(r).position))return!0;r=KI(r)}return!1}(e.target,["fixed","sticky"],i);return{x:e.clientX+(s?0:r),y:e.clientY+(s?0:n),target_fixed:s,type:t}}},{key:"_onClick",value:function(e){var t;if(!HR(e.target)){var n=this._getProperties(e,"click");null!==(t=this.rageclicks)&&void 0!==t&&t.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this._capture(OE(OE({},n),{},{type:"rageclick"})),this._capture(n)}}},{key:"_onMouseMove",value:function(e){var t=this;HR(e.target)||(clearTimeout(this._mouseMoveTimeout),this._mouseMoveTimeout=setTimeout((function(){t._capture(t._getProperties(e,"mousemove"))}),500))}},{key:"_capture",value:function(e){if(oC){var t=oC.location.href;this.buffer=this.buffer||{},this.buffer[t]||(this.buffer[t]=[]),this.buffer[t].push(e)}}}]),e}(),GR=function(){function e(t){var n=this;LE(this,e),jE(this,"_updateScrollData",(function(){var e,t,r,i;n.context||(n.context={});var s=n.scrollElement(),o=n.scrollY(),a=s?Math.max(0,s.scrollHeight-s.clientHeight):0,l=o+((null==s?void 0:s.clientHeight)||0),c=(null==s?void 0:s.scrollHeight)||0;n.context.lastScrollY=Math.ceil(o),n.context.maxScrollY=Math.max(o,null!==(e=n.context.maxScrollY)&&void 0!==e?e:0),n.context.maxScrollHeight=Math.max(a,null!==(t=n.context.maxScrollHeight)&&void 0!==t?t:0),n.context.lastContentY=l,n.context.maxContentY=Math.max(l,null!==(r=n.context.maxContentY)&&void 0!==r?r:0),n.context.maxContentHeight=Math.max(c,null!==(i=n.context.maxContentHeight)&&void 0!==i?i:0)})),this.instance=t}return ME(e,[{key:"getContext",value:function(){return this.context}},{key:"resetContext",value:function(){var e=this.context;return setTimeout(this._updateScrollData,0),e}},{key:"startMeasuringScrollPosition",value:function(){null==oC||oC.addEventListener("scroll",this._updateScrollData,!0),null==oC||oC.addEventListener("scrollend",this._updateScrollData,!0),null==oC||oC.addEventListener("resize",this._updateScrollData)}},{key:"scrollElement",value:function(){if(!this.instance.config.scroll_root_selector)return null==oC?void 0:oC.document.documentElement;var e,t=BE(QE(this.instance.config.scroll_root_selector)?this.instance.config.scroll_root_selector:[this.instance.config.scroll_root_selector]);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=null==oC?void 0:oC.document.querySelector(n);if(r)return r}}catch(e){t.e(e)}finally{t.f()}}},{key:"scrollY",value:function(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollTop||0}return oC&&(oC.scrollY||oC.pageYOffset||oC.document.documentElement.scrollTop)||0}},{key:"scrollX",value:function(){if(this.instance.config.scroll_root_selector){var e=this.scrollElement();return e&&e.scrollLeft||0}return oC&&(oC.scrollX||oC.pageXOffset||oC.document.documentElement.scrollLeft)||0}}]),e}(),$R=function(){function e(){LE(this,e),jE(this,"events",{}),this.events={}}return ME(e,[{key:"on",value:function(e,t){var n=this;return this.events[e]||(this.events[e]=[]),this.events[e].push(t),function(){n.events[e]=n.events[e].filter((function(e){return e!==t}))}}},{key:"emit",value:function(e,t){var n,r=BE(this.events[e]||[]);try{for(r.s();!(n=r.n()).done;)(0,n.value)(t)}catch(e){r.e(e)}finally{r.f()}var i,s=BE(this.events["*"]||[]);try{for(s.s();!(i=s.n()).done;)(0,i.value)(e,t)}catch(e){s.e(e)}finally{s.f()}}}]),e}(),KR="$copy_autocapture";function QR(e,t){return t.length>e?t.slice(0,e)+"...":t}var YR,JR,XR=function(){function e(t){LE(this,e),jE(this,"_initialized",!1),jE(this,"_isDisabledServerSide",null),jE(this,"rageclicks",new zR),jE(this,"_elementsChainAsString",!1),this.instance=t}return ME(e,[{key:"config",get:function(){var e,t=JE(this.instance.config.autocapture)?this.instance.config.autocapture:{};return t.url_allowlist=null===(e=t.url_allowlist)||void 0===e?void 0:e.map((function(e){return new RegExp(e)})),t}},{key:"_addDomEventHandlers",value:function(){var e=this;if(this.isBrowserSupported()){if(oC&&dC){var t=function(t){t=t||(null==oC?void 0:oC.event);try{e._captureEvent(t)}catch(e){bC.error("Failed to capture event",e)}},n=function(t){t=t||(null==oC?void 0:oC.event),e._captureEvent(t,KR)};OC(dC,"submit",t,!1,!0),OC(dC,"change",t,!1,!0),OC(dC,"click",t,!1,!0),this.config.capture_copied_text&&(OC(dC,"copy",n,!1,!0),OC(dC,"cut",n,!1,!0))}}else bC.info("Disabling Automatic Event Collection because this browser is not supported")}},{key:"startIfEnabled",value:function(){this.isEnabled&&!this._initialized&&(this._addDomEventHandlers(),this._initialized=!0)}},{key:"afterDecideResponse",value:function(e){e.elementsChainAsString&&(this._elementsChainAsString=e.elementsChainAsString),this.instance.persistence&&this.instance.persistence.register(jE({},jC,!!e.autocapture_opt_out)),this._isDisabledServerSide=!!e.autocapture_opt_out,this.startIfEnabled()}},{key:"isEnabled",get:function(){var e,t,n=null===(e=this.instance.persistence)||void 0===e?void 0:e.props[jC],r=this._isDisabledServerSide;if(tC(r)&&!iC(n)&&!this.instance.config.advanced_disable_decide)return!1;var i=null!==(t=this._isDisabledServerSide)&&void 0!==t?t:!!n;return!!this.instance.config.autocapture&&!i}},{key:"_previousElementSibling",value:function(e){if(e.previousElementSibling)return e.previousElementSibling;var t=e;do{t=t.previousSibling}while(t&&!BI(t));return t}},{key:"_getAugmentPropertiesFromElement",value:function(e){if(!YI(e))return{};var t={};return EC(e.attributes,(function(e){if(e.name&&0===e.name.indexOf("data-ph-capture-attribute")){var n=e.name.replace("data-ph-capture-attribute-",""),r=e.value;n&&r&&ix(r)&&(t[n]=r)}})),t}},{key:"_getPropertiesFromElement",value:function(e,t,n){var r,i=e.tagName.toLowerCase(),s={tag_name:i};$I.indexOf(i)>-1&&!n&&("a"===i.toLowerCase()||"button"===i.toLowerCase()?s.$el_text=QR(1024,sx(e)):s.$el_text=QR(1024,zI(e)));var o=qI(e);o.length>0&&(s.classes=o.filter((function(e){return""!==e})));var a=null===(r=this.config)||void 0===r?void 0:r.element_attribute_ignorelist;EC(e.attributes,(function(n){var r;if((!JI(e)||-1!==["name","id","class","aria-label"].indexOf(n.name))&&(null==a||!a.includes(n.name))&&!t&&ix(n.value)&&(r=n.name,!eC(r)||"_ngcontent"!==r.substring(0,10)&&"_nghost"!==r.substring(0,7))){var i=n.value;"class"===n.name&&(i=UI(i).join(" ")),s["attr__"+n.name]=QR(1024,i)}}));for(var l=1,c=1,u=e;u=this._previousElementSibling(u);)l++,u.tagName===e.tagName&&c++;return s.nth_child=l,s.nth_of_type=c,s}},{key:"_getDefaultProperties",value:function(e){return{$event_type:e,$ce_version:1}}},{key:"_getEventTarget",value:function(e){return ZE(e.target)?e.srcElement||null:null!==(t=e.target)&&void 0!==t&&t.shadowRoot?e.composedPath()[0]||null:e.target||null;var t}},{key:"_captureEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$autocapture";if(this.isEnabled){var r,i=this._getEventTarget(e);WI(i)&&(i=i.parentNode||null),"$autocapture"===n&&"click"===e.type&&e instanceof MouseEvent&&this.instance.config.rageclick&&null!==(r=this.rageclicks)&&void 0!==r&&r.isRageClick(e.clientX,e.clientY,(new Date).getTime())&&this._captureEvent(e,"$rageclick");var s=n===KR;if(i&&QI(i,e,this.config,s,s?["copy","cut"]:void 0)){for(var o,a,l=[i],c=i;c.parentNode&&!HI(c,"body");)GI(c.parentNode)?(l.push(c.parentNode.host),c=c.parentNode.host):(l.push(c.parentNode),c=c.parentNode);var u,h=[],d={},f=!1;if(EC(l,(function(e){var n=YI(e);"a"===e.tagName.toLowerCase()&&(u=e.getAttribute("href"),u=n&&ix(u)&&u),TC(qI(e),"ph-no-capture")&&(f=!0),h.push(t._getPropertiesFromElement(e,t.instance.config.mask_all_element_attributes,t.instance.config.mask_all_text));var r=t._getAugmentPropertiesFromElement(e);CC(d,r)})),this.instance.config.mask_all_text||("a"===i.tagName.toLowerCase()||"button"===i.tagName.toLowerCase()?h[0].$el_text=sx(i):h[0].$el_text=zI(i)),u&&(h[0].attr__href=u),f)return!1;var p=CC(this._getDefaultProperties(e.type),this._elementsChainAsString?{$elements_chain:ax(h)}:{$elements:h},null!==(o=h[0])&&void 0!==o&&o.$el_text?{$el_text:null===(a=h[0])||void 0===a?void 0:a.$el_text}:{},d);if(n===KR){var g,m=VI(null==oC||null===(g=oC.getSelection())||void 0===g?void 0:g.toString()),v=e.type||"clipboard";if(!m)return!1;p.$selected_content=m,p.$copy_type=v}return this.instance.capture(n,p),!0}}}},{key:"isBrowserSupported",value:function(){return YE(null==dC?void 0:dC.querySelectorAll)}}]),e}(),ZR={},eN=function(){},tN="posthog",nN=!wR&&-1===(null==vC?void 0:vC.indexOf("MSIE"))&&-1===(null==vC?void 0:vC.indexOf("Mozilla")),rN=function(){var e,t,n;return{api_host:"https://us.i.posthog.com",api_transport:"XHR",ui_host:null,token:"",autocapture:!0,rageclick:!0,cross_subdomain_cookie:(t=null==dC?void 0:dC.location,n=null==t?void 0:t.hostname,!!eC(n)&&"herokuapp.com"!==n.split(".").slice(-2).join(".")),persistence:"localStorage+cookie",persistence_name:"",loaded:eN,store_google:!0,custom_campaign_params:[],custom_blocked_useragents:[],save_referrer:!0,capture_pageview:!0,capture_pageleave:!0,debug:fC&&eC(null==fC?void 0:fC.search)&&-1!==fC.search.indexOf("__posthog_debug=true")||!1,verbose:!1,cookie_expiration:365,upgrade:!1,disable_session_recording:!1,disable_persistence:!1,disable_surveys:!1,enable_recording_console_log:void 0,secure_cookie:"https:"===(null==oC||null===(e=oC.location)||void 0===e?void 0:e.protocol),ip:!0,opt_out_capturing_by_default:!1,opt_out_persistence_by_default:!1,opt_out_useragent_filter:!1,opt_out_capturing_persistence_type:"localStorage",opt_out_capturing_cookie_prefix:null,opt_in_site_apps:!1,property_denylist:[],respect_dnt:!1,sanitize_properties:null,request_headers:{},inapp_protocol:"//",inapp_link_new_window:!1,request_batching:!0,properties_string_max_length:65535,session_recording:{},mask_all_element_attributes:!1,mask_all_text:!1,advanced_disable_decide:!1,advanced_disable_feature_flags:!1,advanced_disable_feature_flags_on_first_load:!1,advanced_disable_toolbar_metrics:!1,feature_flag_request_timeout_ms:3e3,on_request_error:function(e){var t="Bad HTTP status: "+e.statusCode+" "+e.text;bC.error(t)},get_device_id:function(e){return e},_onCapture:eN,capture_performance:void 0,name:"posthog",bootstrap:{},disable_compression:!1,session_idle_timeout_seconds:1800,person_profiles:"always"}},iN=function(e){var t={};ZE(e.process_person)||(t.person_profiles=e.process_person),ZE(e.xhr_headers)||(t.request_headers=e.xhr_headers),ZE(e.cookie_name)||(t.persistence_name=e.cookie_name),ZE(e.disable_cookie)||(t.disable_persistence=e.disable_cookie);var n=CC({},t,e);return QE(e.property_blacklist)&&(ZE(e.property_denylist)?n.property_denylist=e.property_blacklist:QE(e.property_denylist)?n.property_denylist=[].concat(qE(e.property_blacklist),qE(e.property_denylist)):bC.error("Invalid value for property_denylist config: "+e.property_denylist)),n},sN=function(){function e(){LE(this,e),jE(this,"__forceAllowLocalhost",!1)}return ME(e,[{key:"_forceAllowLocalhost",get:function(){return this.__forceAllowLocalhost},set:function(e){bC.error("WebPerformanceObserver is deprecated and has no impact on network capture. Use `_forceAllowLocalhostNetworkCapture` on `posthog.sessionRecording`"),this.__forceAllowLocalhost=e}}]),e}(),oN=function(){function e(){var t=this;LE(this,e),jE(this,"webPerformance",new sN),jE(this,"_debugEventEmitter",new $R),this.config=rN(),this.decideEndpointWasHit=!1,this.SentryIntegration=AR,this.__request_queue=[],this.__loaded=!1,this.analyticsDefaultEndpoint="/e/",this.featureFlags=new hT(this),this.toolbar=new jx(this),this.scrollManager=new GR(this),this.pageViewManager=new OR(this),this.surveys=new FR(this),this.rateLimiter=new MR(this),this.requestRouter=new PR(this),this.people={set:function(e,n,r){var i=eC(e)?jE({},e,n):e;t.setPersonProperties(i),null==r||r({})},set_once:function(e,n,r){var i=eC(e)?jE({},e,n):e;t.setPersonProperties(void 0,i),null==r||r({})}},this.on("eventCaptured",(function(e){return bC.info("send",e)}))}return ME(e,[{key:"init",value:function(t,n,r){if(r&&r!==tN){var i,s=null!==(i=ZR[r])&&void 0!==i?i:new e;return s._init(t,n,r),ZR[r]=s,ZR[tN][r]=s,s}return this._init(t,n,r)}},{key:"_init",value:function(e){var t,n,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2?arguments[2]:void 0;if(ZE(e)||function(e){return eC(e)&&0===e.trim().length}(e))return bC.critical("PostHog was initialized without a token. This likely indicates a misconfiguration. Please check the first argument passed to posthog.init()"),this;if(this.__loaded)return bC.warn("You have already initialized PostHog! Re-initializing is a no-op"),this;if(this.__loaded=!0,this.config={},this._triggered_notifs=[],this.set_config(CC({},rN(),iN(i),{name:s,token:e})),this.compression=i.disable_compression?void 0:AC.Base64,this.persistence=new DI(this.config),this.sessionPersistence="sessionStorage"===this.config.persistence?this.persistence:new DI(OE(OE({},this.config),{},{persistence:"sessionStorage"})),this._requestQueue=new Ux((function(e){return r._send_request(e)})),this._retryQueue=new IR(this),this.__request_queue=[],this.sessionManager=new RR(this.config,this.persistence),this.sessionPropsManager=new UR(this.sessionManager,this.persistence),this.sessionRecording=new Dx(this),this.sessionRecording.startIfEnabledOrStop(),this.config.disable_scroll_properties||this.scrollManager.startMeasuringScrollPosition(),this.autocapture=new XR(this),this.autocapture.startIfEnabled(),this.surveys.loadIfEnabled(),this.heatmaps=new WR(this),this.heatmaps.startIfEnabled(),HE.DEBUG=HE.DEBUG||this.config.debug,this._gdpr_init(),void 0!==(null===(t=i.bootstrap)||void 0===t?void 0:t.distinctID)){var o,a,l=this.config.get_device_id(yT()),c=null!==(o=i.bootstrap)&&void 0!==o&&o.isIdentifiedID?l:i.bootstrap.distinctID;this.persistence.set_property(eT,null!==(a=i.bootstrap)&&void 0!==a&&a.isIdentifiedID?"identified":"anonymous"),this.register({distinct_id:i.bootstrap.distinctID,$device_id:c})}if(this._hasBootstrappedFeatureFlags()){var u,h,d=Object.keys((null===(u=i.bootstrap)||void 0===u?void 0:u.featureFlags)||{}).filter((function(e){var t,n;return!(null===(t=i.bootstrap)||void 0===t||null===(n=t.featureFlags)||void 0===n||!n[e])})).reduce((function(e,t){var n,r;return e[t]=(null===(n=i.bootstrap)||void 0===n||null===(r=n.featureFlags)||void 0===r?void 0:r[t])||!1,e}),{}),f=Object.keys((null===(h=i.bootstrap)||void 0===h?void 0:h.featureFlagPayloads)||{}).filter((function(e){return d[e]})).reduce((function(e,t){var n,r,s,o;return null!==(n=i.bootstrap)&&void 0!==n&&null!==(r=n.featureFlagPayloads)&&void 0!==r&&r[t]&&(e[t]=null===(s=i.bootstrap)||void 0===s||null===(o=s.featureFlagPayloads)||void 0===o?void 0:o[t]),e}),{});this.featureFlags.receivedFeatureFlags({featureFlags:d,featureFlagPayloads:f})}if(!this.get_distinct_id()){var p=this.config.get_device_id(yT());this.register_once({distinct_id:p,$device_id:p},""),this.persistence.set_property(eT,"anonymous")}return null==oC||null===(n=oC.addEventListener)||void 0===n||n.call(oC,"onpagehide"in self?"pagehide":"unload",this._handle_unload.bind(this)),this.toolbar.maybeLoadToolbar(),i.segment?function(e,t){var n=e.config.segment;if(!n)return t();!function(e,t){var n=e.config.segment;if(!n)return t();var r=function(n){var r=function(){return n.anonymousId()||yT()};e.config.get_device_id=r,n.id()&&(e.register({distinct_id:n.id(),$device_id:r()}),e.persistence.set_property(eT,"identified")),t()},i=n.user();"then"in i&&YE(i.then)?i.then((function(e){return r(e)})):r(i)}(e,(function(){n.register(function(e){Promise&&Promise.resolve||bC.warn("This browser does not have Promise support, and can not use the segment integration");var t=function(t,n){var r;if(!n)return t;t.event.userId||t.event.anonymousId===e.get_distinct_id()||e.reset(),t.event.userId&&t.event.userId!==e.get_distinct_id()&&(e.register({distinct_id:t.event.userId}),e.reloadFeatureFlags());var i=e._calculate_event_properties(n,null!==(r=t.event.properties)&&void 0!==r?r:{});return t.event.properties=Object.assign({},i,t.event.properties),t};return{name:"PostHog JS",type:"enrichment",version:"1.0.0",isLoaded:function(){return!0},load:function(){return Promise.resolve()},track:function(e){return t(e,e.event.event)},page:function(e){return t(e,"$pageview")},identify:function(e){return t(e,"$identify")},screen:function(e){return t(e,"$screen")}}}(e)).then((function(){t()}))}))}(this,(function(){return r._loaded()})):this._loaded(),YE(this.config._onCapture)&&this.on("eventCaptured",(function(e){return r.config._onCapture(e.event,e)})),this}},{key:"_afterDecideResponse",value:function(e){var t,n,r,i,s;this.compression=void 0,e.supportedCompression&&!this.config.disable_compression&&(this.compression=TC(e.supportedCompression,AC.GZipJS)?AC.GZipJS:TC(e.supportedCompression,AC.Base64)?AC.Base64:void 0),null!==(t=e.analytics)&&void 0!==t&&t.endpoint&&(this.analyticsDefaultEndpoint=e.analytics.endpoint),null===(n=this.sessionRecording)||void 0===n||n.afterDecideResponse(e),null===(r=this.autocapture)||void 0===r||r.afterDecideResponse(e),null===(i=this.heatmaps)||void 0===i||i.afterDecideResponse(e),null===(s=this.surveys)||void 0===s||s.afterDecideResponse(e)}},{key:"_loaded",value:function(){var e=this,t=this.config.advanced_disable_decide;t||this.featureFlags.setReloadingPaused(!0);try{this.config.loaded(this)}catch(e){bC.critical("`loaded` function failed",e)}this._start_queue_if_opted_in(),this.config.capture_pageview&&setTimeout((function(){dC&&e.capture("$pageview",{title:dC.title},{send_instantly:!0})}),1),t||(new Lx(this).call(),this.featureFlags.resetRequestQueue())}},{key:"_start_queue_if_opted_in",value:function(){var e;this.has_opted_out_capturing()||this.config.request_batching&&(null===(e=this._requestQueue)||void 0===e||e.enable())}},{key:"_dom_loaded",value:function(){var e=this;this.has_opted_out_capturing()||SC(this.__request_queue,(function(t){return e._send_retriable_request(t)})),this.__request_queue=[],this._start_queue_if_opted_in()}},{key:"_handle_unload",value:function(){var e,t;this.config.request_batching?(this.config.capture_pageview&&this.config.capture_pageleave&&this.capture("$pageleave"),null===(e=this._requestQueue)||void 0===e||e.unload(),null===(t=this._retryQueue)||void 0===t||t.unload()):this.config.capture_pageview&&this.config.capture_pageleave&&this.capture("$pageleave",null,{transport:"sendBeacon"})}},{key:"_send_request",value:function(e){var t=this;this.__loaded&&(nN?this.__request_queue.push(e):this.rateLimiter.isServerRateLimited(e.batchKey)||(e.transport=e.transport||this.config.api_transport,e.url=SR(e.url,{ip:this.config.ip?1:0}),e.headers=this.config.request_headers,e.compression="best-available"===e.compression?this.compression:e.compression,function(e){var t=OE({},e);t.timeout=t.timeout||6e4,t.url=SR(t.url,{_:(new Date).getTime().toString(),ver:HE.LIB_VERSION,compression:t.compression}),"sendBeacon"===t.transport&&null!=hC&&hC.sendBeacon?function(e){var t=SR(e.url,{beacon:"1"});try{var n,r=null!==(n=CR(e))&&void 0!==n?n:{},i=r.contentType,s=r.body,o="string"==typeof s?new Blob([s],{type:i}):s;hC.sendBeacon(t,o)}catch(e){}}(t):"fetch"===t.transport&&pC?function(e){var t,n,r=null!==(t=CR(e))&&void 0!==t?t:{},i=r.contentType,s=r.body,o=new Headers;EC(o,(function(e,t){o.append(t,e)})),i&&o.append("Content-Type",i);var a=e.url,l=null;if(mC){var c=new mC;l={signal:c.signal,timeout:setTimeout((function(){return c.abort()}),e.timeout)}}pC(a,{method:(null==e?void 0:e.method)||"GET",headers:o,keepalive:"POST"===e.method,body:s,signal:null===(n=l)||void 0===n?void 0:n.signal}).then((function(t){return t.text().then((function(n){var r,i={statusCode:t.status,text:n};if(200===t.status)try{i.json=JSON.parse(n)}catch(e){bC.error(e)}null===(r=e.callback)||void 0===r||r.call(e,i)}))})).catch((function(t){var n;bC.error(t),null===(n=e.callback)||void 0===n||n.call(e,{statusCode:0,text:t})})).finally((function(){return l?clearTimeout(l.timeout):null}))}(t):gC||!dC?function(e){var t,n=new gC;n.open(e.method||"GET",e.url,!0);var r=null!==(t=CR(e))&&void 0!==t?t:{},i=r.contentType,s=r.body;EC(e.headers,(function(e,t){n.setRequestHeader(t,e)})),i&&n.setRequestHeader("Content-Type",i),e.timeout&&(n.timeout=e.timeout),n.withCredentials=!0,n.onreadystatechange=function(){if(4===n.readyState){var t,r={statusCode:n.status,text:n.responseText};if(200===n.status)try{r.json=JSON.parse(n.responseText)}catch(e){}null===(t=e.callback)||void 0===t||t.call(e,r)}},n.send(s)}(t):function(e){var t;if(dC){var n=dC.createElement("script");n.type="text/javascript",n.async=!0,n.defer=!0,n.src=e.url;var r=dC.getElementsByTagName("script")[0];null===(t=r.parentNode)||void 0===t||t.insertBefore(n,r)}}(t)}(OE(OE({},e),{},{callback:function(n){var r,i,s;t.rateLimiter.checkForLimiting(n),n.statusCode>=400&&(null===(i=(s=t.config).on_request_error)||void 0===i||i.call(s,n)),null===(r=e.callback)||void 0===r||r.call(e,n)}}))))}},{key:"_send_retriable_request",value:function(e){this._retryQueue?this._retryQueue.retriableRequest(e):this._send_request(e)}},{key:"_execute_array",value:function(e){var t,n=this,r=[],i=[],s=[];SC(e,(function(e){e&&(t=e[0],QE(t)?s.push(e):YE(e)?e.call(n):QE(e)&&"alias"===t?r.push(e):QE(e)&&-1!==t.indexOf("capture")&&YE(n[t])?s.push(e):i.push(e))}));var o=function(e,t){SC(e,(function(e){if(QE(e[0])){var n=t;EC(e,(function(e){n=n[e[0]].apply(n,e.slice(1))}))}else this[e[0]].apply(this,e.slice(1))}),t)};o(r,this),o(i,this),o(s,this)}},{key:"_hasBootstrappedFeatureFlags",value:function(){var e,t;return(null===(e=this.config.bootstrap)||void 0===e?void 0:e.featureFlags)&&Object.keys(null===(t=this.config.bootstrap)||void 0===t?void 0:t.featureFlags).length>0||!1}},{key:"push",value:function(e){this._execute_array([e])}},{key:"capture",value:function(e,t,n){var r;if(!(this.__loaded&&this.persistence&&this.sessionPersistence&&this._requestQueue))return bC.uninitializedWarning("posthog.capture");if(!Ix(this))if(!ZE(e)&&eC(e)){if(!vC||this.config.opt_out_useragent_filter||!VR(vC,this.config.custom_blocked_useragents)){var i=null!=n&&n.skip_client_rate_limiting?void 0:this.rateLimiter.clientRateLimitContext();if(null==i||!i.isRateLimited){this.sessionPersistence.update_search_keyword(),this.config.store_google&&(this.sessionPersistence.update_campaign_params(),this.persistence.set_initial_campaign_params()),this.config.save_referrer&&(this.sessionPersistence.update_referrer_info(),this.persistence.set_initial_referrer_info());var s={uuid:yT(),event:e,properties:this._calculate_event_properties(e,t||{})};if(null==n||!n._noHeatmaps){var o,a=null===(o=this.heatmaps)||void 0===o?void 0:o.getAndClearBuffer();a&&(s.properties.$heatmap_data=a)}i&&(s.properties.$lib_rate_limit_remaining_tokens=i.remainingTokens),(null==n?void 0:n.$set)&&(s.$set=null==n?void 0:n.$set);var l=this._calculate_set_once_properties(null==n?void 0:n.$set_once);l&&(s.$set_once=l),(s=function(e,t){return n=e,r=function(e){return eC(e)&&!tC(t)?e.slice(0,t):e},i=new Set,function e(t,n){return t!==Object(t)?r?r(t):t:i.has(t)?void 0:(i.add(t),QE(t)?(s=[],SC(t,(function(t){s.push(e(t))}))):(s={},EC(t,(function(t,n){i.has(t)||(s[n]=e(t,n))}))),s);var s}(n);var n,r,i}(s,null!=n&&n._noTruncate?null:this.config.properties_string_max_length)).timestamp=(null==n?void 0:n.timestamp)||new Date,ZE(null==n?void 0:n.timestamp)||(s.properties.$event_time_override_provided=!0,s.properties.$event_time_override_system_time=new Date);var c=OE(OE({},s.properties.$set),s.$set);XE(c)||this.setPersonPropertiesForFlags(c),this._debugEventEmitter.emit("eventCaptured",s);var u={method:"POST",url:null!==(r=null==n?void 0:n._url)&&void 0!==r?r:this.requestRouter.endpointFor("api",this.analyticsDefaultEndpoint),data:s,compression:"best-available",batchKey:null==n?void 0:n._batchKey};return!this.config.request_batching||n&&(null==n||!n._batchKey)||null!=n&&n.send_instantly?this._send_retriable_request(u):this._requestQueue.enqueue(u),s}bC.critical("This capture call is ignored due to client rate limiting.")}}else bC.error("No event name provided to posthog.capture")}},{key:"_addCaptureHook",value:function(e){this.on("eventCaptured",(function(t){return e(t.event)}))}},{key:"_calculate_event_properties",value:function(e,t){if(!this.persistence||!this.sessionPersistence)return t;var n=this.persistence.remove_event_timer(e),r=OE({},t);if(r.token=this.config.token,"$snapshot"===e){var i=OE(OE({},this.persistence.properties()),this.sessionPersistence.properties());return r.distinct_id=i.distinct_id,r}var s=AI.properties();if(this.sessionManager){var o=this.sessionManager.checkAndGetSessionAndWindowId(),a=o.sessionId,l=o.windowId;r.$session_id=a,r.$window_id=l}if(this.requestRouter.region===bR.CUSTOM&&(r.$lib_custom_api_host=this.config.api_host),this.sessionPropsManager&&this.config.__preview_send_client_session_params&&("$pageview"===e||"$pageleave"===e||"$autocapture"===e)){var c=this.sessionPropsManager.getSessionProps();r=CC(r,c)}if(!this.config.disable_scroll_properties){var u={};"$pageview"===e?u=this.pageViewManager.doPageView():"$pageleave"===e&&(u=this.pageViewManager.doPageLeave()),r=CC(r,u)}if("$pageview"===e&&dC&&(r.title=dC.title),!ZE(n)){var h=(new Date).getTime()-n;r.$duration=parseFloat((h/1e3).toFixed(3))}vC&&this.config.opt_out_useragent_filter&&(r.$browser_type=VR(vC,this.config.custom_blocked_useragents)?"bot":"browser"),(r=CC({},s,this.persistence.properties(),this.sessionPersistence.properties(),r)).$is_identified=this._isIdentified(),QE(this.config.property_denylist)?EC(this.config.property_denylist,(function(e){delete r[e]})):bC.error("Invalid value for property_denylist config: "+this.config.property_denylist+" or property_blacklist config: "+this.config.property_blacklist);var d=this.config.sanitize_properties;return d&&(r=d(r,e)),r.$process_person_profile=this._hasPersonProcessing(),r}},{key:"_calculate_set_once_properties",value:function(e){if(!this.persistence||!this._hasPersonProcessing())return e;var t=CC({},this.persistence.get_initial_props(),e||{});return XE(t)?void 0:t}},{key:"register",value:function(e,t){var n;null===(n=this.persistence)||void 0===n||n.register(e,t)}},{key:"register_once",value:function(e,t,n){var r;null===(r=this.persistence)||void 0===r||r.register_once(e,t,n)}},{key:"register_for_session",value:function(e){var t;null===(t=this.sessionPersistence)||void 0===t||t.register(e)}},{key:"unregister",value:function(e){var t;null===(t=this.persistence)||void 0===t||t.unregister(e)}},{key:"unregister_for_session",value:function(e){var t;null===(t=this.sessionPersistence)||void 0===t||t.unregister(e)}},{key:"_register_single",value:function(e,t){this.register(jE({},e,t))}},{key:"getFeatureFlag",value:function(e,t){return this.featureFlags.getFeatureFlag(e,t)}},{key:"getFeatureFlagPayload",value:function(e){var t=this.featureFlags.getFeatureFlagPayload(e);try{return JSON.parse(t)}catch(e){return t}}},{key:"isFeatureEnabled",value:function(e,t){return this.featureFlags.isFeatureEnabled(e,t)}},{key:"reloadFeatureFlags",value:function(){this.featureFlags.reloadFeatureFlags()}},{key:"updateEarlyAccessFeatureEnrollment",value:function(e,t){this.featureFlags.updateEarlyAccessFeatureEnrollment(e,t)}},{key:"getEarlyAccessFeatures",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.featureFlags.getEarlyAccessFeatures(e,t)}},{key:"on",value:function(e,t){return this._debugEventEmitter.on(e,t)}},{key:"onFeatureFlags",value:function(e){return this.featureFlags.onFeatureFlags(e)}},{key:"onSessionId",value:function(e){var t,n;return null!==(t=null===(n=this.sessionManager)||void 0===n?void 0:n.onSessionId(e))&&void 0!==t?t:function(){}}},{key:"getSurveys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getSurveys(e,t)}},{key:"getActiveMatchingSurveys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.surveys.getActiveMatchingSurveys(e,t)}},{key:"identify",value:function(e,t,n){if(!this.__loaded||!this.persistence)return bC.uninitializedWarning("posthog.identify");if(rC(e)&&(e=e.toString(),bC.warn("The first argument to posthog.identify was a number, but it should be a string. It has been converted to a string.")),e){if(["distinct_id","distinctid"].includes(e.toLowerCase()))bC.critical('The string "'.concat(e,'" was set in posthog.identify which indicates an error. This ID should be unique to the user and not a hardcoded string.'));else if(this._requirePersonProcessing("posthog.identify")){var r=this.get_distinct_id();if(this.register({$user_id:e}),!this.get_property("$device_id")){var i=r;this.register_once({$had_persisted_distinct_id:!0,$device_id:i},"")}e!==r&&e!==this.get_property(FC)&&(this.unregister(FC),this.register({distinct_id:e}));var s="anonymous"===(this.persistence.get_property(eT)||"anonymous");e!==r&&s?(this.persistence.set_property(eT,"identified"),this.setPersonPropertiesForFlags(t||{},!1),this.capture("$identify",{distinct_id:e,$anon_distinct_id:r},{$set:t||{},$set_once:n||{}}),this.featureFlags.setAnonymousDistinctId(r)):(t||n)&&this.setPersonProperties(t,n),e!==r&&(this.reloadFeatureFlags(),this.unregister(ZC))}}else bC.error("Unique user id has not been set in posthog.identify")}},{key:"setPersonProperties",value:function(e,t){(e||t)&&this._requirePersonProcessing("posthog.setPersonProperties")&&(this.setPersonPropertiesForFlags(e||{}),this.capture("$set",{$set:e||{},$set_once:t||{}}))}},{key:"group",value:function(e,t,n){if(e&&t){if(this._requirePersonProcessing("posthog.group")){var r=this.getGroups();r[e]!==t&&this.resetGroupPropertiesForFlags(e),this.register({$groups:OE(OE({},r),{},jE({},e,t))}),n&&(this.capture("$groupidentify",{$group_type:e,$group_key:t,$group_set:n}),this.setGroupPropertiesForFlags(jE({},e,n))),r[e]===t||n||this.reloadFeatureFlags()}}else bC.error("posthog.group requires a group type and group key")}},{key:"resetGroups",value:function(){this.register({$groups:{}}),this.resetGroupPropertiesForFlags(),this.reloadFeatureFlags()}},{key:"setPersonPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._requirePersonProcessing("posthog.setPersonPropertiesForFlags")&&this.featureFlags.setPersonPropertiesForFlags(e,t)}},{key:"resetPersonPropertiesForFlags",value:function(){this.featureFlags.resetPersonPropertiesForFlags()}},{key:"setGroupPropertiesForFlags",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._requirePersonProcessing("posthog.setGroupPropertiesForFlags")&&this.featureFlags.setGroupPropertiesForFlags(e,t)}},{key:"resetGroupPropertiesForFlags",value:function(e){this.featureFlags.resetGroupPropertiesForFlags(e)}},{key:"reset",value:function(e){var t,n,r,i;if(!this.__loaded)return bC.uninitializedWarning("posthog.reset");var s=this.get_property("$device_id");null===(t=this.persistence)||void 0===t||t.clear(),null===(n=this.sessionPersistence)||void 0===n||n.clear(),null===(r=this.persistence)||void 0===r||r.set_property(eT,"anonymous"),null===(i=this.sessionManager)||void 0===i||i.resetSessionId();var o=this.config.get_device_id(yT());this.register_once({distinct_id:o,$device_id:e?o:s},"")}},{key:"get_distinct_id",value:function(){return this.get_property("distinct_id")}},{key:"getGroups",value:function(){return this.get_property("$groups")||{}}},{key:"get_session_id",value:function(){var e,t;return null!==(e=null===(t=this.sessionManager)||void 0===t?void 0:t.checkAndGetSessionAndWindowId(!0).sessionId)&&void 0!==e?e:""}},{key:"get_session_replay_url",value:function(e){if(!this.sessionManager)return"";var t=this.sessionManager.checkAndGetSessionAndWindowId(!0),n=t.sessionId,r=t.sessionStartTimestamp,i=this.requestRouter.endpointFor("ui","/project/".concat(this.config.token,"/replay/").concat(n));if(null!=e&&e.withTimestamp&&r){var s,o=null!==(s=e.timestampLookBack)&&void 0!==s?s:10;if(!r)return i;var a=Math.max(Math.floor(((new Date).getTime()-r)/1e3)-o,0);i+="?t=".concat(a)}return i}},{key:"alias",value:function(e,t){return e===this.get_property(LC)?(bC.critical("Attempting to create alias for existing People user - aborting."),-2):this._requirePersonProcessing("posthog.alias")?(ZE(t)&&(t=this.get_distinct_id()),e!==t?(this._register_single(FC,e),this.capture("$create_alias",{alias:e,distinct_id:t})):(bC.warn("alias matches current distinct_id - skipping api call."),this.identify(e),-1)):void 0}},{key:"set_config",value:function(e){var t,n,r,i,s=OE({},this.config);JE(e)&&(CC(this.config,iN(e)),null===(t=this.persistence)||void 0===t||t.update_config(this.config,s),this.sessionPersistence="sessionStorage"===this.config.persistence?this.persistence:new DI(OE(OE({},this.config),{},{persistence:"sessionStorage"})),CT.is_supported()&&"true"===CT.get("ph_debug")&&(this.config.debug=!0),this.config.debug&&(HE.DEBUG=!0),null===(n=this.sessionRecording)||void 0===n||n.startIfEnabledOrStop(),null===(r=this.autocapture)||void 0===r||r.startIfEnabled(),null===(i=this.heatmaps)||void 0===i||i.startIfEnabled(),this.surveys.loadIfEnabled())}},{key:"startSessionRecording",value:function(e){if(null!=e&&e.sampling){var t,n,r=null===(t=this.sessionManager)||void 0===t?void 0:t.checkAndGetSessionAndWindowId();null===(n=this.persistence)||void 0===n||n.register(jE({},$C,!0)),bC.info("Session recording started with sampling override for session: ",null==r?void 0:r.sessionId)}this.set_config({disable_session_recording:!1})}},{key:"stopSessionRecording",value:function(){this.set_config({disable_session_recording:!0})}},{key:"sessionRecordingStarted",value:function(){var e;return!(null===(e=this.sessionRecording)||void 0===e||!e.started)}},{key:"loadToolbar",value:function(e){return this.toolbar.loadToolbar(e)}},{key:"get_property",value:function(e){var t;return null===(t=this.persistence)||void 0===t?void 0:t.props[e]}},{key:"getSessionProperty",value:function(e){var t;return null===(t=this.sessionPersistence)||void 0===t?void 0:t.props[e]}},{key:"toString",value:function(){var e,t=null!==(e=this.config.name)&&void 0!==e?e:tN;return t!==tN&&(t=tN+"."+t),t}},{key:"_isIdentified",value:function(){var e,t;return"identified"===(null===(e=this.persistence)||void 0===e?void 0:e.get_property(eT))||"identified"===(null===(t=this.sessionPersistence)||void 0===t?void 0:t.get_property(eT))}},{key:"_hasPersonProcessing",value:function(){var e,t,n,r;return!("never"===this.config.person_profiles||"identified_only"===this.config.person_profiles&&!this._isIdentified()&&XE(this.getGroups())&&(null===(e=this.persistence)||void 0===e||null===(t=e.props)||void 0===t||!t[FC])&&(null===(n=this.persistence)||void 0===n||null===(r=n.props)||void 0===r||!r[sT]))}},{key:"_requirePersonProcessing",value:function(e){return"never"===this.config.person_profiles?(bC.error(e+' was called, but process_person is set to "never". This call will be ignored.'),!1):(this._register_single(sT,!0),!0)}},{key:"_gdpr_init",value:function(){"localStorage"===this.config.opt_out_capturing_persistence_type&&CT.is_supported()&&(!this.has_opted_in_capturing()&&this.has_opted_in_capturing({persistence_type:"cookie"})&&this.opt_in_capturing({enable_persistence:!1}),!this.has_opted_out_capturing()&&this.has_opted_out_capturing({persistence_type:"cookie"})&&this.opt_out_capturing({clear_persistence:!1}),this.clear_opt_in_out_capturing({persistence_type:"cookie",enable_persistence:!1})),this.has_opted_out_capturing()?this._gdpr_update_persistence({clear_persistence:!0}):this.has_opted_in_capturing()||!this.config.opt_out_capturing_by_default&&!ST.get("ph_optout")||(ST.remove("ph_optout"),this.opt_out_capturing({clear_persistence:this.config.opt_out_persistence_by_default}))}},{key:"_gdpr_update_persistence",value:function(e){var t,n,r,i,s;if(e&&e.clear_persistence)r=!0;else{if(!e||!e.enable_persistence)return;r=!1}this.config.disable_persistence||(null===(t=this.persistence)||void 0===t?void 0:t.disabled)===r||null===(i=this.persistence)||void 0===i||i.set_disabled(r),this.config.disable_persistence||(null===(n=this.sessionPersistence)||void 0===n?void 0:n.disabled)===r||null===(s=this.sessionPersistence)||void 0===s||s.set_disabled(r)}},{key:"_gdpr_call_func",value:function(e,t){return t=CC({capture:this.capture.bind(this),persistence_type:this.config.opt_out_capturing_persistence_type,cookie_prefix:this.config.opt_out_capturing_cookie_prefix,cookie_expiration:this.config.cookie_expiration,cross_subdomain_cookie:this.config.cross_subdomain_cookie,secure_cookie:this.config.secure_cookie},t||{}),CT.is_supported()||"localStorage"!==t.persistence_type||(t.persistence_type="cookie"),e(this.config.token,{capture:t.capture,captureEventName:t.capture_event_name,captureProperties:t.capture_properties,persistenceType:t.persistence_type,persistencePrefix:t.cookie_prefix,cookieExpiration:t.cookie_expiration,crossSubdomainCookie:t.cross_subdomain_cookie,secureCookie:t.secure_cookie})}},{key:"opt_in_capturing",value:function(e){e=CC({enable_persistence:!0},e||{}),this._gdpr_call_func(yx,e),this._gdpr_update_persistence(e)}},{key:"opt_out_capturing",value:function(e){var t=CC({clear_persistence:!0},e||{});this._gdpr_call_func(_x,t),this._gdpr_update_persistence(t)}},{key:"has_opted_in_capturing",value:function(e){return this._gdpr_call_func(bx,e)}},{key:"has_opted_out_capturing",value:function(e){return this._gdpr_call_func(wx,e)}},{key:"clear_opt_in_out_capturing",value:function(e){var t=CC({enable_persistence:!0},null!=e?e:{});this._gdpr_call_func(kx,t),this._gdpr_update_persistence(t)}},{key:"debug",value:function(e){!1===e?(null==oC||oC.console.log("You've disabled debug mode."),localStorage&&localStorage.removeItem("ph_debug"),this.set_config({debug:!1})):(null==oC||oC.console.log("You're now in debug mode. All calls to PostHog will be logged in your console.\nYou can disable this with `posthog.debug(false)`."),localStorage&&localStorage.setItem("ph_debug","true"),this.set_config({debug:!0}))}}]),e}();!function(e,t){for(var n=0;n<t.length;n++)e.prototype[t[n]]=NC(e.prototype[t[n]])}(oN,["identify"]),function(e){e.Popover="popover",e.API="api",e.Widget="widget"}(YR||(YR={})),function(e){e.Open="open",e.MultipleChoice="multiple_choice",e.SingleChoice="single_choice",e.Rating="rating",e.Link="link"}(JR||(JR={}));var aN,lN=(aN=ZR[tN]=new oN,function(){function e(){e.done||(e.done=!0,nN=!1,EC(ZR,(function(e){e._dom_loaded()})))}null!=dC&&dC.addEventListener&&("complete"===dC.readyState?e():dC.addEventListener("DOMContentLoaded",e,!1)),oC&&OC(oC,"load",e,!0)}(),aN);"localhost"!==window.location.hostname&&lN.init("phc_pYiz1K4qlGNQD0HUMYzAwTQy2H67FhJvNJj3j4JtGw5",{api_host:"https://us.i.posthog.com"});const cN=function(){const[e,n]=(0,t.useState)(null);return(0,t.useEffect)((()=>{Xy()}),[]),(0,t.useEffect)((()=>{const e=Qy.onAuthStateChanged((e=>{n(e||null)}));return()=>e()}),[]),(0,e_.jsx)(c_,{children:(0,e_.jsx)(__,{children:(0,e_.jsx)(g_,{children:(0,e_.jsx)(ke,{children:(0,e_.jsxs)(me,{children:[(0,e_.jsx)(pe,{path:"/",element:(0,e_.jsxs)("div",{className:"content-container homePageContainer",children:[(0,e_.jsxs)("div",{className:"title",children:[(0,e_.jsxs)("h1",{children:[(0,e_.jsx)("img",{src:"/logo.png",className:"logo",alt:"A logo of a leaf inside a drop"})," Skincremental"]}),(0,e_.jsx)("h4",{children:"Experience Skincare Made Exclusively for You"})]}),(0,e_.jsx)(Ce,{to:"/summary",children:(0,e_.jsx)("button",{className:"startbutton",children:"Start Your Personalized Skincare Journey"})}),(0,e_.jsxs)("div",{className:"homepageText",children:[(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Personalized Skincare, Evolving With You:"})," Custom-crafted skincare that adapts to your unique needs, environment, and the seasons. Because your skin deserves nothing less."]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Discover Your Perfect Match:"})," Try two custom formulas, choose your favorite, and let our smart algorithm enhance it for next time. Skincare that learns and grows with you."]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Pure Ingredients, Transparent Choices:"})," Only pure, nourishing ingredients your skin will love\u2014no unnecessary fillers or confusing preservatives. Understand exactly what's in your skincare."]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Empower Your Skincare Journey:"})," Customize your formulation with clear guidance on each ingredient's purpose. Crafting your perfect skincare is now within your reach."]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Conscious & Sustainable:"})," We're committed to a healthier planet. Our packaging is recycled, sterilized, and reused. We source locally whenever possible. Return your jars for recycling, and we'll donate to charity on your behalf."]}),(0,e_.jsxs)("p",{children:[(0,e_.jsx)("strong",{children:"Join the Skincare Revolution:"})," Skincare is more than a routine\u2014it's your personal journey. Join a community embracing sustainability, personalization, and innovation."]})]}),(0,e_.jsx)(Ce,{to:"/product",children:(0,e_.jsx)("button",{className:"bottomstartbutton",children:"Begin Your Skincare Journey"})}),(0,e_.jsx)(Ce,{to:"/contact",className:"modern-link",children:(0,e_.jsx)("span",{children:"Contact us"})}),(0,e_.jsx)(cE,{})]})}),(0,e_.jsx)(pe,{path:"/goals",element:(0,e_.jsx)(v_,{})}),(0,e_.jsx)(pe,{path:"/product",element:(0,e_.jsx)(a_,{})}),(0,e_.jsx)(pe,{path:"/summary",element:(0,e_.jsx)(w_,{})}),(0,e_.jsx)(pe,{path:"/saved-recipe",element:(0,e_.jsx)(k_,{})}),(0,e_.jsx)(pe,{path:"/order-formulation",element:(0,e_.jsx)(lE,{})}),(0,e_.jsx)(pe,{path:"/order-success",element:(0,e_.jsx)(uE,{})}),(0,e_.jsx)(pe,{path:"/contact",element:(0,e_.jsx)(hE,{})}),(0,e_.jsx)(pe,{path:"/order-pricing",element:(0,e_.jsx)(dE,{})}),(0,e_.jsx)(pe,{path:"/order-survey",element:(0,e_.jsx)(pE,{})}),(0,e_.jsx)(pe,{path:"/ingredients-table",element:(0,e_.jsx)(vE,{})}),(0,e_.jsx)(pe,{path:"/phase-choices",element:(0,e_.jsx)(SE,{})}),(0,e_.jsx)(pe,{path:"/confirm-recipe",element:(0,e_.jsx)(EE,{})}),(0,e_.jsx)(pe,{path:"/variation-request",element:(0,e_.jsx)(TE,{})}),(0,e_.jsx)(pe,{path:"/admin",element:(0,e_.jsx)(IE,{})}),(0,e_.jsx)(pe,{path:"/admin/order/:orderId",element:(0,e_.jsx)(xE,{})}),(0,e_.jsx)(pe,{path:"/dashboard",element:(0,e_.jsx)(NE,{})}),(0,e_.jsx)(pe,{path:"/admin/recipe-copier",element:(0,e_.jsx)(PE,{})})]})})})})})},uN=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))};i.createRoot(document.getElementById("root")).render((0,e_.jsx)(t.StrictMode,{children:(0,e_.jsx)(cN,{})})),uN()})()})();
//# sourceMappingURL=main.0e51d682.js.map